GU.prototype.xra=ga(222,function(a){this.O=Qb(arguments,0)});function t9b(a,b,c,d,e){return Xkb(a,y(function(){return this.C.calculateArrayFormulaResultPreview(b,c,d,e,!1,this.J,!0)},a))}function TV(a){aj(this,a,0,-1,null)}z(TV,$i);function u9b(a,b){var c=b.width;b=b.height;for(var d=a.width<=c?1:Math.floor(a.width/c),e=a.height<=b?1:Math.floor(a.height/b),g=[],h=0;h<d;h++)for(var k=a.left+h*c,l=0;l<e;l++){var m=a.top+l*b;g.push(new th(m,k,m+b,k+c))}return g}var v9b=[2];
function w9b(a){return nc(J8b,function(b){return b.match(a)}).getName()}function x9b(a,b){var c=a.type;if(u(c))switch(c.toLowerCase()){case "checkbox":case "radio":a.checked=b;break;case "select-one":a.selectedIndex=-1;if(ya(b))for(var d=0;c=a.options[d];d++)if(c.value==b){c.selected=!0;break}break;case "select-multiple":ya(b)&&(b=[b]);for(d=0;c=a.options[d];d++)if(c.selected=!1,b)for(var e,g=0;e=b[g];g++)c.value==e&&(c.selected=!0);break;default:a.value=null!=b?b:""}}
function y9b(a){var b=a.type;if(!u(b))return null;switch(b.toLowerCase()){case "checkbox":case "radio":return a.checked?a.value:null;case "select-one":return b=a.selectedIndex,0<=b?a.options[b].value:null;case "select-multiple":for(var b=[],c,d=0;c=a.options[d];d++)c.selected&&b.push(c.value);return b.length?b:null;default:return u(a.value)?a.value:null}}function z9b(a){aj(this,a,0,-1,null)}z(z9b,$i);var A9b={pnc:0,cza:1,Dza:2};function B9b(a){aj(this,a,0,-1,v9b)}z(B9b,$i);
function C9b(a,b,c){function d(){g=la.setTimeout(e,b);a.apply(null,k)}function e(){g=null;h&&(h=!1,d())}c&&(a=y(a,c));var g=null,h=!1,k=[];return function(a){k=arguments;g?h=!0:d()}}function D9b(a){for(var b=Math.random,c=a.length-1;0<c;c--){var d=Math.floor(b()*(c+1)),e=a[c];a[c]=a[d];a[d]=e}}function UV(a,b,c,d,e,g){K.call(this,a,b);this.C=b;this.Na=c;this.Pa=d||null;this.xb=e||null;this.F=g||null}z(UV,K);UV.prototype.Ej=f("Na");UV.prototype.Ve=f("Pa");
function E9b(a,b,c,d,e,g){UV.call(this,"assistant-sidepane-insert-chart",null,d,e,g);this.Y=a;this.$=b;this.fc=c}z(E9b,UV);E9b.prototype.Se=f("fc");function F9b(a){a=""+('<div class="waffle-assistant-feature-section"><div class="waffle-assistant-section-header"><div class="waffle-assistant-section-title">'+U(a.title)+"</div>"+U(wt({Oe:"waffle-assistant-section-more-button",content:ps("More"),style:4}))+'</div><div class="waffle-assistant-section-content"></div><div class="waffle-assistant-section-card-holder"></div></div>');return V(a)};function VV(a,b,c){a&&(u(b)||(b=a.hasAttribute("title")?a.getAttribute("title"):""),b=Wa(b),vt(a,b,void 0),v5b(a),a.setAttribute("data-tooltip-delay",500),w5b(a,u(c)?c:1))};function G9b(a){return V('<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" x="0" y="0" height="'+W(a.iconSize)+'px" width="'+W(a.iconSize)+'px" viewBox="0 0 24 24" preserveAspectRatio="none"><path fill="'+W(a.color)+'" d="M19,2 L5,2 C3.9,2 3,2.9 3,4 L3,18 C3,19.1 3.9,20 5,20 L9,20 L12,23 L15,20 L19,20 C20.1,20 21,19.1 21,18 L21,4 C21,2.9 20.1,2 19,2 L19,2 Z M13.88,12.88 L12,17 L10.12,12.88 L6,11 L10.12,9.12 L12,5 L13.88,9.12 L18,11 L13.88,12.88 L13.88,12.88 Z"/></svg>')}
;function H9b(a,b,c){c=c||{};a=V;b='<div class="waffle-assistant-scroll-pane" style="'+(c.cb?"/*"+c.cb+"*/":"")+'display: none;"><div class="waffle-assistant-spinner-container"></div><div class="waffle-assistant-panel-pane">';c=c||{};c=""+('<div class="waffle-assistant-empty-list" style="'+(c.cb?"/*"+c.cb+"*/":"")+'display: none"><div class="waffle-assistant-empty-list-content">'+U(G9b({color:"rgb(46%, 46%, 46%)",iconSize:"40"}))+'<div aria-live="polite"><div class="waffle-assistant-empty-list-title">Nothing interesting here right now</div><div class="waffle-assistant-empty-list-body">Try selecting different data. Information with numbers works best.</div></div><div class="waffle-assistant-empty-list-learn-more waffle-assistant-empty-list-link"><span>Learn more</span></div><div class="waffle-assistant-empty-list-link"><a href="https://docs.google.com/spreadsheets/d/1Hh2grfB6rp9OQ2yAIu3S5YF_CCFJGwyqPGveABlOZKg/copy" target="_blank">Try an example</a></div></div></div>');
c=V(c);return a(b+c+'<div class="waffle-assistant-panel-content-container"><div class="waffle-assistant-panel-card-holder"></div></div></div></div>')}function I9b(a){return V('<div class="waffle-assistant-panel-title-bar">'+U(wt({Oe:"waffle-assistant-panel-back-button",content:ps(""+U(Uu({icon:"docs-icon-img-container docs-explore-img docs-explore-back-white"}))),style:4}))+'<div class="waffle-assistant-title-text" role="heading">'+U(a.title)+"</div></div>")};function WV(a){Bq.call(this,a);this.Bd=new MV(!1,"#4285f4");this.Ma(this.Bd);this.O=new Bq(this.oa);this.Ma(this.O);this.D=[];this.Hg=this.Wc=!1;this.Ke=this.Nd=this.Ua=this.$=null;this.Gb=new xt("",a,4);xr(this.Gb,2);this.Ma(this.Gb)}z(WV,Bq);var J9b={defaultHelpArticleId:"6280499"};q=WV.prototype;q.Sa=function(){WV.Z.Sa.call(this);this.Ba=Tr(H9b);this.Nd=T(this,"waffle-assistant-panel-content-container");this.Ke=T(this,"waffle-assistant-empty-list")};
q.Ga=function(){WV.Z.Ga.call(this);var a=T(this,"waffle-assistant-spinner-container");this.Bd.render(a);this.O.Va(T(this,"waffle-assistant-panel-card-holder"));this.Gb.Va(T(this,"waffle-assistant-empty-list-learn-more"));this.getHandler().V(this.Gb,"action",this.pWb).V(this.Ba,"scroll",C9b(this.PVa,10,this))};q.setVisible=function(a){R(this.Ba,a);A(this.D,function(a){if(!a.rc()){var b=this.O.qd();a.Y=b;this.O.Ma(a,!0);a.HO()}},this);this.Wc=a};
q.Lqa=function(a,b){var c=this.oa;this.$&&this.q5();this.$=new Bq;this.Ma(this.$);a=Rr(a,I9b,{title:b});this.Ua=new xt("",this.oa);this.$.Ma(this.Ua);this.Ua.Va(Dn(c,"waffle-assistant-panel-back-button",a));VV(this.Ua.Ba,"Back");this.$.getHandler().V(this.Ua,"action",this.Aib)};q.q5=function(){this.$.dispose();this.$=null};function K9b(a,b){a.Bd.setActive(b);R(T(a,"waffle-assistant-panel-pane"),!b)}q.wL=function(a){R(this.Ke,a);R(this.Nd,!a)};
function L9b(a,b){Jb(a.D,b);a.O.removeChild(b);a.O.xi(b,0);a.D.push(b)}q.eL=function(a){Jb(this.D,a);-1!=Kq(this.O,a)&&this.O.removeChild(a,!0)};q.A4=function(){this.O.Rd(!0);Kc(this.D);this.D=[]};q.PVa=function(){for(var a=this.Ba,a=a.scrollTop+hq(a).height,b=0,c=0;c<this.D.length;c++){var d=this.D[c];b<a?(XV(d,!0),b+=hq(d.Ba).height):XV(d,!1)}};function M9b(a,b){a.Hg=b;A(a.D,function(a){a.WG(b)})}q.Id=f("Hg");q.pWb=function(){Q.$l.Ub(J9b)};q.Aib=function(){this.dispatchEvent("assistant-sidepane-back-button-clicked")};function YV(a,b,c,d){Bq.call(this,d);this.R=a;this.Xa=b;this.X=new xt("",this.oa);this.Ma(this.X);this.J=new Bq(this.oa);this.Ma(this.J);this.D=null;this.Ua=[];this.Na=this.La=!1;this.O=c}z(YV,Bq);q=YV.prototype;q.VLa=Kf;q.$ra=Lf;q.Sa=function(){YV.Z.Sa.call(this);this.Ba=Tr(F9b,{title:this.ZT()})};
q.Ga=function(){YV.Z.Ga.call(this);this.J.Va(T(this,"waffle-assistant-section-card-holder"));this.X.Va(T(this,"waffle-assistant-section-more-button"));this.getHandler().V(this.X,"action",this.Qsb);this.D=this.cCa();H(this,this.D);R(N9b(this),this.VLa());this.setVisible(!1)};q.setVisible=function(a){if(this.rc()&&this.Ta()!=a&&(R(this.Ba,a),a)){R(this.X.Ba,this.eTa());a=new z9b;var b=this.cda();P(a,4,b);b=new no;gj(b,58,a);this.O.Pb(2774,new Zo(10,b))}};q.Ta=function(){return this.rc()&&kq(this.Ba)};
q.eTa=function(){return this.Ua.length>this.R};q.ZT=v;q.HW=v;q.cCa=function(){return new WV(this.oa)};q.I1=function(a){this.Na=a;A(O9b(this),function(b){b.WG(a)});M9b(this.D,a)};q.Id=f("Na");q.qh=oa;q.r4=v;q.cda=v;q.cua=function(a){this.Ua=a;for(var b=0;b<a.length;b++){Gc(a[b],1);if(this.J.qd()<this.R){var c=this.HW(a[b]);c.WG(this.Na);var d=this.J.qd();c.Y=d;this.J.Ma(c,!0)}if(this.$ra()&&(this.D.wL(!1),c=this.D,d=this.HW(a[b]),c.D.push(d),c.Wc)){K9b(c,!1);var e=c.O.qd();d.Y=e;c.O.Ma(d,!0);d.HO()}}};
function O9b(a){var b=[];a.J.xg(function(a){b.push(a)});return b}function N9b(a){return T(a,"waffle-assistant-section-content")}q.ena=function(){return Fua(this.J)};q.G1=function(){this.Ua=[];Kc(this.J.Rd(!0));this.setVisible(!1);this.$ra()&&(this.D.A4(),this.D.wL(!0))};function P9b(a){a.J.xg(function(a,c){c<this.R&&a.HO()},a)}
q.eua=function(a){var b=0;if(this.La)this.D.PVa();else if(this.ena()){this.setVisible(!0);for(var b=hq(T(this,"waffle-assistant-section-header")).height+hq(N9b(this)).height,c=O9b(this),d=0;d<c.length;d++)b<a&&d<this.R?(this.YIa(c[d]),XV(c[d],!0),b+=hq(c[d].Ba).height):XV(c[d],!1)}else this.setVisible(!1);return a-b};q.YIa=oa;q.setActive=function(a){(this.La=a)||this.D.q5()};q.Ob=f("La");function Q9b(a,b){a.D.Lqa(b,a.ZT())}q.Qsb=function(){this.setActive(!0);this.dispatchEvent("assistant-sidepane-set-active-panel")};var R9b={UNKNOWN_ERROR:0,Fnc:1,Dgc:2,n5b:3},S9b={wnc:0,sC:1,Jgc:2,mgc:3,zic:4},T9b={tnc:0,Fgc:1,NH:2,qec:3},U9b={nnc:0,Zmc:1,U8b:2,omc:3,nmc:4};function ZV(){B.call(this)}z(ZV,B);var V9b=null;ZV.prototype.yl=function(){return D(this,1)};function $V(){B.call(this)}z($V,B);var W9b=null;$V.prototype.getText=function(){return D(this,1)};$V.prototype.yq=function(){return Ac(this,1)};function aW(){B.call(this)}z(aW,B);var X9b=null;aW.prototype.getStatus=function(){return D(this,1)};aW.prototype.hasFormula=function(){return Ac(this,2)};aW.prototype.getError=function(){return D(this,9)};function bW(){B.call(this)}z(bW,B);var Y9b=null;q=bW.prototype;
q.s9=function(){return Ac(this,1)};q.hasFormula=function(){return Ac(this,2)};q.getType=function(){return D(this,3)};q.Ed=function(a){F(this,3,a)};q.mf=function(){return Ac(this,3)};ZV.prototype.Ca=function(){var a=V9b;a||(V9b=a=Hc(ZV,{0:{name:"Error",gb:"ritz.assistant.Error"},1:{name:"message",Aa:9,type:String},2:{name:"code",Aa:14,defaultValue:0,type:R9b}}));return a};ZV.Ca=ZV.prototype.Ca;
$V.prototype.Ca=function(){var a=W9b;a||(W9b=a=Hc($V,{0:{name:"AnswerQueryPhrase",gb:"ritz.assistant.AnswerQueryPhrase"},1:{name:"text",Aa:9,type:String},2:{name:"start_byte",Aa:5,type:Number},3:{name:"num_bytes",Aa:5,type:Number}}));return a};$V.Ca=$V.prototype.Ca;
aW.prototype.Ca=function(){var a=X9b;a||(X9b=a=Hc(aW,{0:{name:"AnswerResponse",gb:"ritz.assistant.AnswerResponse"},1:{name:"status",Aa:5,type:Number},10:{name:"parse_status",Aa:14,defaultValue:0,type:S9b},11:{name:"answer_status",Aa:14,defaultValue:0,type:T9b},2:{name:"formula",Aa:9,type:String},3:{name:"debug_parse_response",Aa:9,type:String},4:{name:"interpretation",Aa:9,type:String},5:{name:"debug_interpretation_response",Aa:9,type:String},6:{name:"unused_phrase",td:!0,Aa:11,type:$V},7:{name:"used_entity_phrase",
td:!0,Aa:11,type:$V},8:{name:"unused_entity_phrase",td:!0,Aa:11,type:$V},9:{name:"error",Aa:11,type:ZV},12:{name:"alternate_suggestion",td:!0,Aa:11,type:bW}}));return a};aW.Ca=aW.prototype.Ca;bW.prototype.Ca=function(){var a=Y9b;a||(Y9b=a=Hc(bW,{0:{name:"QuerySuggestion",gb:"ritz.assistant.QuerySuggestion"},1:{name:"query",Aa:9,type:String},2:{name:"formula",Aa:9,type:String},3:{name:"type",Aa:14,defaultValue:0,type:U9b}}));return a};bW.Ca=bW.prototype.Ca;function cW(){B.call(this)}z(cW,B);var Z9b=null;cW.prototype.getChartType=function(){return D(this,1)};
cW.prototype.Ca=function(){var a=Z9b;a||(Z9b=a=Hc(cW,{0:{name:"AutovisRecommendationProto",gb:"ritz.assistant.AutovisRecommendationProto"},1:{name:"chart_type",Aa:9,type:String},2:{name:"chart_title",Aa:9,type:String},3:{name:"horizontal_axis_title",Aa:9,type:String},4:{name:"horizontal_axis_min",Aa:1,type:Number},5:{name:"horizontal_axis_max",Aa:1,type:Number},6:{name:"left_vertical_axis_title",Aa:9,type:String},7:{name:"left_vertical_axis_min",Aa:1,type:Number},8:{name:"left_vertical_axis_max",
Aa:1,type:Number},9:{name:"right_vertical_axis_title",Aa:9,type:String},10:{name:"right_vertical_axis_min",Aa:1,type:Number},11:{name:"right_vertical_axis_max",Aa:1,type:Number},12:{name:"columns_to_group_by",td:!0,Aa:5,type:Number},13:{name:"column_aggregation_types",td:!0,Aa:9,type:String},14:{name:"is_transposed",Aa:8,type:Boolean},15:{name:"use_first_column_as_domain",Aa:8,type:Boolean},16:{name:"first_data_row_index",Aa:5,type:Number},17:{name:"is_stacked",Aa:8,type:Boolean},18:{name:"autovis_range",
Aa:11,type:Rd},19:{name:"text_analysis_words",td:!0,Aa:9,type:String},20:{name:"text_analysis_word_counts",td:!0,Aa:5,type:Number},21:{name:"mapped_column_label",td:!0,Aa:9,type:String},22:{name:"best_facet_column",Aa:5,type:Number},23:{name:"best_facet_labels",td:!0,Aa:9,type:String},24:{name:"needs_data_transformation",Aa:8,type:Boolean},25:{name:"data_transformation",Aa:11,type:ff}}));return a};cW.Ca=cW.prototype.Ca;var $9b={Mea:0,Bda:1,W1:2,d3:3};function dW(){B.call(this)}z(dW,B);var a$b=null;q=dW.prototype;q.getName=function(){return D(this,1)};q.vh=function(a){F(this,1,a)};q.getType=function(){return D(this,4)};q.Ed=function(a){F(this,4,a)};q.mf=function(){return Ac(this,4)};function eW(){B.call(this)}z(eW,B);var b$b=null;eW.prototype.getName=function(){return D(this,1)};eW.prototype.vh=function(a){F(this,1,a)};function fW(){B.call(this)}z(fW,B);var c$b=null;fW.prototype.$d=function(a){return D(this,2,a)};
fW.prototype.Uo=function(){return Ac(this,2)};dW.prototype.Ca=function(){var a=a$b;a||(a$b=a=Hc(dW,{0:{name:"Dimension",gb:"ritz.assistant.Dimension"},1:{name:"name",Aa:9,type:String},2:{name:"filter",td:!0,Aa:9,type:String},3:{name:"non_unique_filter",td:!0,Aa:13,type:Number},4:{name:"type",Aa:14,defaultValue:0,type:$9b},5:{name:"year_only_dates",Aa:8,type:Boolean},6:{name:"density",Aa:1,type:Number},7:{name:"alt_name",td:!0,Aa:9,type:String}}));return a};dW.Ca=dW.prototype.Ca;
eW.prototype.Ca=function(){var a=b$b;a||(b$b=a=Hc(eW,{0:{name:"Metric",gb:"ritz.assistant.Metric"},1:{name:"name",Aa:9,type:String},2:{name:"alt_name",td:!0,Aa:9,type:String}}));return a};eW.Ca=eW.prototype.Ca;fW.prototype.Ca=function(){var a=c$b;a||(c$b=a=Hc(fW,{0:{name:"EntityListTable",gb:"ritz.assistant.EntityListTable"},1:{name:"metric",td:!0,Aa:11,type:eW},2:{name:"dimension",td:!0,Aa:11,type:dW},3:{name:"non_unique_dimension",td:!0,Aa:13,type:Number}}));return a};fW.Ca=fW.prototype.Ca;var d$b={MZb:0,zH:1,x0b:2,lZb:3,HWa:4};function gW(){B.call(this)}z(gW,B);var e$b=null;function hW(){B.call(this)}z(hW,B);var f$b=null;hW.prototype.Qf=function(a){return D(this,4,a)};function iW(){B.call(this)}z(iW,B);var g$b=null;q=iW.prototype;q.TS=function(){return D(this,2)};q.eh=function(){return D(this,3)};q.wJ=function(){return D(this,4,0)};q.getPivotTableDef=function(){return D(this,5)};q.Ufa=function(){return Fc(this,7)};q.getAutovisRecommendation=function(){return D(this,8)};
function jW(){B.call(this)}z(jW,B);var h$b=null;gW.prototype.Ca=function(){var a=e$b;a||(e$b=a=Hc(gW,{0:{name:"AssistantResponseProto",gb:"ritz.assistant.AssistantResponseProto"},1:{name:"recommendation",td:!0,Aa:11,type:iW},2:{name:"selection_recommendation",td:!0,Aa:11,type:iW}}));return a};gW.Ca=gW.prototype.Ca;
hW.prototype.Ca=function(){var a=f$b;a||(f$b=a=Hc(hW,{0:{name:"AssistantRequestProto",gb:"ritz.assistant.AssistantRequestProto"},1:{name:"table_range",Aa:11,type:Rd},2:{name:"selected_row",td:!0,Aa:5,type:Number},3:{name:"selected_column",td:!0,Aa:5,type:Number},4:{name:"color",td:!0,Aa:11,type:sd},5:{name:"color_frequency",td:!0,Aa:5,type:Number}}));return a};hW.Ca=hW.prototype.Ca;
iW.prototype.Ca=function(){var a=g$b;a||(g$b=a=Hc(iW,{0:{name:"RecommendationProto",gb:"ritz.assistant.RecommendationProto"},1:{name:"recommendation_type",Aa:14,defaultValue:0,type:d$b},2:{name:"confidence",Aa:1,type:Number},3:{name:"description",Aa:9,type:String},4:{name:"grid_ranges",td:!0,Aa:11,type:Rd},5:{name:"pivot_table_def",Aa:11,type:Oe},6:{name:"conditional_format_rules",td:!0,Aa:11,type:Ve},7:{name:"banding_protos",td:!0,Aa:11,type:Fd},8:{name:"autovis_recommendation",Aa:11,type:cW},9:{name:"entity_list_table",
Aa:11,type:fW}}));return a};iW.Ca=iW.prototype.Ca;
jW.prototype.Ca=function(){var a=h$b;a||(h$b=a=Hc(jW,{0:{name:"AssistantFlagsProto",gb:"ritz.assistant.AssistantFlagsProto"},2:{name:"include_word_clouds",Aa:8,type:Boolean},3:{name:"include_conditional_formats",Aa:8,type:Boolean},4:{name:"include_forms_integration",Aa:8,type:Boolean},5:{name:"include_answers",Aa:8,type:Boolean},6:{name:"include_autovis_faceting",Aa:8,type:Boolean},7:{name:"include_banding",Aa:8,type:Boolean},9:{name:"include_autovis_sum",Aa:8,type:Boolean},10:{name:"include_already_applied_formatting_recommendations",
Aa:8,type:Boolean}}));return a};jW.Ca=jW.prototype.Ca;function i$b(){return V('<div class="waffle-assistant-card" tabindex="0" role="region">'+(km?'<div class="waffle-assistant-card-feedback-container waffle-assistant-feedback-card-hidden"></div>':"")+'<div class="waffle-assistant-card-spinner-container"></div><div class="waffle-assistant-card-inner"><div class="waffle-assistant-button-holder waffle-assistant-card-options"></div><div class="waffle-assistant-card-content-container"></div>'+(km?'<div class="waffle-assistant-thumbs-container"></div>':"")+
"</div></div>")};function kW(){}z(kW,II);pa(kW);kW.prototype.tc=n("waffle-assistant-link-button");function j$b(){return V('<div class="waffle-assistant-feedback-card waffle-assistant-feedback-card-hidden"><div class="waffle-assistant-feedback-card-content"><div class="waffle-assistant-feedback-card-text">Tell us what could be improved.</div><div class="waffle-assistant-feedback-card-link">Send feedback</div></div></div>')};function k$b(a,b){Bq.call(this,b);this.D=a;this.C=new qt("",new kW,this.oa);this.Ma(this.C)}z(k$b,Bq);q=k$b.prototype;q.Sa=function(){this.Ba=Tr(j$b)};q.Ga=function(){k$b.Z.Ga.call(this);var a=T(this,"waffle-assistant-feedback-card-link");this.C.Va(a);this.getHandler().V(this.Ba,"mousedown",this.oWb).V(this.C,"action",this.Ynb);this.show(!1)};q.oWb=function(a){a.stopPropagation()};
q.show=function(a){var b=this.Ba,c=T(this,"waffle-assistant-feedback-card-link");Mp(b,"waffle-assistant-feedback-card-hidden",!a);un(c,a)};q.Ynb=function(){Q.hx.Ub({source:this.D});this.show(!1);this.dispatchEvent(new K("feedback-dialog-opened"))};function lW(){}z(lW,ot);pa(lW);lW.prototype.tc=n("waffle-assistant-button");function l$b(){var a;a=""+('<div class="waffle-assistant-thumbs"><div class="waffle-assistant-thumbs-text">Was this useful?</div><div class="waffle-assistant-thumbs-button-holder"><div class="waffle-assistant-thumbs-up-button">'+U(Uu({icon:"docs-icon-img docs-icon-thumb-up"}))+'</div><div class="waffle-assistant-thumbs-down-button">'+U(Uu({icon:"docs-icon-img docs-icon-thumb-down"}))+"</div></div></div>");return V(a)};function mW(a){Bq.call(this,a);this.C=new qt("",new lW,this.oa);this.Ma(this.C);this.D=new qt("",new lW,this.oa);this.Ma(this.D)}z(mW,Bq);mW.prototype.Sa=function(){this.Ba=Tr(l$b)};mW.prototype.Ga=function(){mW.Z.Ga.call(this);var a=T(this,"waffle-assistant-thumbs-down-button");this.C.Va(a);VV(a,"Not useful");a=T(this,"waffle-assistant-thumbs-up-button");this.D.Va(a);VV(a,"Useful");this.getHandler().V(this.C,"action",this.F).V(this.D,"action",this.J)};
function m$b(a,b){a.oa.Nf(T(a,"waffle-assistant-thumbs-text"),b)}mW.prototype.F=function(){this.dispatchEvent(new K("thumbs-down"));R(this.Ba,!1)};mW.prototype.J=function(){this.dispatchEvent(new K("thumbs-up"));R(this.Ba,!1)};function nW(a,b){Bq.call(this,b);this.D=a;this.X=this.F=this.Y=null;this.Xa=new MV(!0,"#4285f4");this.Ma(this.Xa);this.bb=this.qc=this.Nd=!1;this.$=null;this.Df=this.Qb=!1}z(nW,Bq);q=nW.prototype;q.mz=v;q.cz=v;q.oNa=Kf;q.XT=Kf;q.t9=Lf;q.Wx=v;q.pE=Mf;q.oE=Mf;q.O7=Mf;q.Aka=Mf;q.zka=Mf;q.WG=ea("Df");q.Id=f("Df");q.T8=oa;q.Sa=function(){this.Ba=Tr(i$b)};
q.Ga=function(){nW.Z.Ga.call(this);var a=T(this,"waffle-assistant-card-spinner-container");this.Xa.render(a);Pp(T(this,"waffle-assistant-card-inner"),"visibility","hidden");if(this.XT()){var a=this.Ba,b=new Aq(a);H(this,b);this.getHandler().V(b,"focusin",this.gjb).V(b,"focusout",this.fjb).V(a,"mouseenter",this.Ima).V(a,"mouseleave",this.Z8)}n$b(this,!1);km&&(this.X=new k$b(this.Wx(),this.oa),this.X.render(T(this,"waffle-assistant-card-feedback-container")),this.getHandler().V(this.X,"feedback-dialog-opened",
this.Znb).V(this,"trigger_feedback",this.sQb),this.t9()?(this.F=new mW(this.oa),this.F.render(T(this,"waffle-assistant-thumbs-container")),o$b(this,!0),a=Sa(this.O7()),Qa(a)||m$b(this.F,a),a=Sa(this.Aka()),Qa(a)||VV(T(this.F,"waffle-assistant-thumbs-up-button"),a),a=Sa(this.zka()),Qa(a)||VV(T(this.F,"waffle-assistant-thumbs-down-button"),a),this.getHandler().V(this.F,"thumbs-down",this.mWb).V(this.F,"thumbs-up",this.nWb)):o$b(this,!1));this.cz()};
function oW(a){return T(a,"waffle-assistant-card-content-container")}function p$b(a){a.XT();return T(a,"waffle-assistant-card-options")}function o$b(a,b){km&&R(T(a,"waffle-assistant-thumbs-container"),a.t9()&&b)}q.HO=function(){this.isDisposed()||(this.Nd=!0,q$b(this))};function XV(a,b){!a.qc&&b&&(a.qc=!0,q$b(a))}function q$b(a){if(a.Nd&&a.qc){var b=y(a.lWb,a);a.mz(b)}}q.Ima=function(){this.bb||(n$b(this,!0),this.bb=!0,hl(this.$),this.$=gl(this.lBa,100,this))};
q.lBa=function(){this.isDisposed()||(hl(this.$),this.$=null,this.Ba.parentNode.querySelector(":hover")==this.Ba?this.$=gl(this.lBa,100,this):this.Z8())};q.Z8=function(){n$b(this,!1);this.bb=!1};q.gjb=function(){n$b(this,!0)};q.fjb=function(){gl(function(){this.isDisposed()||pn(this.Ba,document.activeElement)||this.Ba.parentNode.querySelector(":hover")==this.Ba||n$b(this,!1)},0,this)};
q.mWb=function(){r$b(this,!0);o$b(this,!1);var a=this.oE();this.dispatchEvent(new UV("assistant-sidepane-thumbs",this,a))};q.nWb=function(){o$b(this,!1);var a=this.pE();this.dispatchEvent(new UV("assistant-sidepane-thumbs",this,a))};q.Znb=function(){r$b(this,!1)};q.sQb=function(){r$b(this,!0)};function n$b(a,b){var c=T(a,"waffle-assistant-card-options");a=a.XT();R(c,a&&b)}q.lWb=function(){this.Xa.setActive(!1);R(this.Xa.Ba,!1);Pp(T(this,"waffle-assistant-card-inner"),"visibility","visible");this.dispatchEvent(new K("content-rendered"))};
function r$b(a,b){Mp(T(a,"waffle-assistant-card-feedback-container"),"waffle-assistant-feedback-card-hidden",!b);a.X.show(b)};function s$b(){return V('<div class="waffle-assistant-padded-card"><div class="waffle-assistant-before-chart-preview" tabindex="0"></div><div class="waffle-assistant-chart-preview"></div><div class="waffle-assistant-after-chart-preview"  tabindex="0"></div><div class="waffle-assistant-chart-highlights"></div></div>')}
function t$b(){return V(U(wt({Oe:"waffle-assistant-insert-chart-button waffle-assistant-readonly-hidden",content:ps(""+U(Uu({icon:"docs-icon-img docs-icon-insert-autovis-chart"}))),style:4}))+'<div class="waffle-assistant-button-separator waffle-assistant-readonly-hidden"></div>'+U(wt({Oe:"waffle-assistant-zoom-button",content:ps(""+U(Uu({icon:"docs-icon-img docs-icon-zoom-in"}))),style:4})))};function u$b(a){var b="",c='By <span class="waffle-assistant-facet-title">'+(U(a.M3a)+"</span>"),d=0==a.qFa.length,b=b+('<div class="waffle-assistant-facet-section"><div class="waffle-assistant-facet-header"><div class="waffle-assistant-pie-icon"></div><div class="waffle-assistant-facet-top-text">'+c+'</div><div class="waffle-assistant-facet-toggle" tabindex="0"></div></div>');if(d)c=V('<div class="waffle-assistant-facet-by-color-container"><div class="waffle-assistant-faceted-chart waffle-assistant-facet-by-color"></div></div>');
else{c='<div class="waffle-assistant-facet-charts-container">\x3c!-- Create chart containers with two in each row. --\x3e';a=a.qFa;for(var e=a.length,g=0;g<e;g++)var h=a[g],c=c+((0==g%2?'<div class="waffle-assistant-facet-chart-row">':"")+'<div class="waffle-assistant-single-facet"><div class="waffle-assistant-single-facet-title">'),c=h?c+U(h):c+"(empty)",c=c+('</div><div class="waffle-assistant-faceted-chart"></div></div>'+(1==g%2||g==e-1?"</div>":""));c=V(c+"</div>")}b+='<div class="waffle-assistant-facet-content-wrapper'+
(d?" waffle-assistant-facet-white-section":"")+'">'+c+(km?'<div class="waffle-assistant-facet-feedback-container"></div><div class="waffle-assistant-facet-thumbs-container"></div>':"")+"</div></div>";return V(b)};function v$b(a,b,c,d,e,g,h){Bq.call(this,h);this.F=a;this.D=b;this.L=e;this.J=g;this.C=this.fc=null;this.Fc=ap(new $o,10).Fa()}z(v$b,Bq);q=v$b.prototype;q.Ga=function(){v$b.Z.Ga.call(this);(new oV(UH,this.D.Sg)).send(y(this.slb,this,this.D))};q.T8=function(a,b){a=new E9b(this.F.clone(),this.L,this.fc,2746,a,b);this.dispatchEvent(a)};q.slb=function(a,b){b&&(b.$h()?tH.Lz(this.Ba,b):(b=b.Se(),a.Ff(b),CV(a,b),uH(a,"ready",y(this.eWb,this,a)),JV(a,this.Ba,um),this.fc=b))};
q.eWb=function(a){a.Tl()&&(uH(a.Tl(),"onmouseover",y(this.cWb,this)),uH(a.Tl(),"onmouseout",y(this.dWb,this)))};q.cWb=function(){this.C=Ha()};q.dWb=function(){Ba(this.C)&&500<Ha()-this.C&&this.J.Pb(2750,this.Fc);this.C=null};function w$b(a,b,c,d,e){Bq.call(this,e);this.J=a;this.La=b;this.O=c;this.R=d;this.L=Fc(this.J,23);this.Da=D(this.J,22);this.D=Fc(this.J,21)[this.Da];this.ea=[];this.Na=new Li;this.X=this.F=this.C=null;this.Y=!1;this.$=new xt("",this.oa);this.Ma(this.$);this.Fc=ap(new $o,10).Fa()}z(w$b,Bq);q=w$b.prototype;q.Sa=function(){w$b.Z.Sa.call(this);this.Ba=Tr(u$b,{M3a:this.D,qFa:this.L});this.Ba.style.visibility="hidden"};
q.Ga=function(){w$b.Z.Ga.call(this);var a=T(this,"waffle-assistant-facet-toggle");this.$.Va(a);this.getHandler().V(this.Ba,"mousedown",this.$Vb).V(this.$,"action",this.sAb);km&&(this.X=new k$b("assistantAutovisFacetFeedback",this.oa),this.X.render(T(this,"waffle-assistant-facet-feedback-container")),this.C=new mW(this.oa),this.Ma(this.C),this.C.render(T(this,"waffle-assistant-facet-thumbs-container")),m$b(this.C,this.L.length?"Were these charts useful?":"Was this chart useful?"),this.getHandler().V(this.C,
"thumbs-up",this.bWb).V(this.C,"thumbs-down",this.aWb));x$b(this,Aoa)};q.Id=f("Y");q.$Vb=function(a){a.stopPropagation()};q.sAb=function(){var a=Hp(T(this,"waffle-assistant-facet-content-wrapper"),"waffle-assistant-facet-charts-wrapper-hidden");x$b(this,a);this.O.Pb(a?2647:2646,this.Fc)};
function x$b(a,b){var c=T(a,"waffle-assistant-facet-toggle");sn(c,b?"HIDE":"SHOW");Mp(T(a,"waffle-assistant-facet-content-wrapper"),"waffle-assistant-facet-charts-wrapper-hidden",!b);A(Dq(a,"waffle-assistant-faceted-chart"),function(a){un(a,b)});a.C&&R(a.C.Ba,b);var d='Show chart broken down by "'+(a.D+'"');a='Hide chart broken down by "'+(a.D+'"');VV(c,b?a:d)}
function y$b(a){a.setOption("legend","top");a.setOption("titleTextStyle.fontSize",10);a.setOption("allowAsync",!0);a.setOption("applyAggregateData",void 0);a.setOption("pieSliceTextStyle.fontSize",11);a.setOption("tooltip.textStyle.fontSize",11);"BarChart"==a.getChartType()&&a.setOption("isStacked",!0)}function z$b(a){"BarChart"==a.getChartType()&&a.setOption("isStacked",!0);a.setOption("applyAggregateData",void 0)}
function A$b(a){a.R&&!a.Y&&A(a.ea,y(function(a){var b=a.Ba;if(!this.R.contains(b)){var d=this.R;a=new B$b(b,a);cib(d,a)}},a))}q.bWb=function(){this.O.Pb(2649,this.Fc)};q.aWb=function(){this.O.Pb(2648,this.Fc);this.X.show(!0)};function pW(a,b,c,d,e,g){nW.call(this,a,g);this.C=a.getAutovisRecommendation();this.$e=b;this.Ke=c;this.R=d;this.Ua=e;this.O=new xt("",this.oa);this.Ma(this.O);this.Za=new xt("",this.oa);this.Ma(this.Za);this.Le=new Li;this.Bd=null;this.La=!1;this.Wc=[];this.Qc=[];this.Gb=[];this.Na=this.Da=this.J=this.L=this.ea=null;this.Fc=ap(new $o,10).Fa()}z(pW,nW);
var C$b={options:{hAxis:{titleTextStyle:{color:"#757575",italic:!1},useFormatFromData:!0},vAxes:[{titleTextStyle:{color:"#757575",italic:!1},useFormatFromData:!0},{titleTextStyle:{color:"#757575",italic:!1},useFormatFromData:!0}],fontName:"Roboto",legacyContinuousAxisRemoved:!0,booleanRole:"certainty",theme:"material",width:null,height:null}},D$b=["BarChart","ColumnChart"],qW={pWa:"waffle-assistant-after-chart-preview",KWa:"waffle-assistant-before-chart-preview",XWa:"waffle-assistant-card-draggable",
L2:"waffle-assistant-chart-highlights",hZa:"waffle-assistant-insert-chart-button",vea:"waffle-assistant-chart-preview",T_a:"waffle-assistant-button-separator",o0a:"waffle-assistant-styled-border",p0a:"waffle-assistant-styled-rect",n1a:"waffle-assistant-zoom-button"};q=pW.prototype;q.mz=function(a){this.Bd=a;E$b(this)};q.cz=function(){F$b(this,y(function(a){a=L8b(this.$e,a);Fp(this.Ba,a)},this),!1)};q.oNa=Lf;q.XT=Lf;q.Wx=n("autovisFeedback");q.pE=n(2208);q.oE=n(2207);q.O7=n("Was this chart useful?");
q.Sa=function(){pW.Z.Sa.call(this);oW(this).appendChild(Tr(s$b));p$b(this).appendChild(Tr(t$b));if(Ac(this.C,22)){this.J=new w$b(this.C,this.Y,this.R,this.Ua,this.oa);this.Ma(this.J,!0);var a=this.J,b=this.Id();a.Y=b;A$b(a)}};
q.Ga=function(){pW.Z.Ga.call(this);Ip(this.Ba,qW.XWa);var a=T(this,qW.hZa);this.O.Va(a);VV(a,"Insert chart");a=T(this,qW.n1a);this.Za.Va(a);VV(a,"View full size");var a=T(this,qW.KWa),b=T(this,qW.vea),c=T(this,qW.pWa);this.getHandler().V(this.Ba,"keydown",this.XVb).V(b,"click",this.Mjb).V(a,"focus",this.Iib).V(c,"focus",this.Dhb).V(this.O,"action",this.sqb).V(this.O.Ba,"mousedown",this.aua).V(this.Za,"action",this.gCb).V(this.Za.Ba,"mousedown",this.aua).V(T(this,qW.L2),"mousedown",this.aua).V(zw(this.$e),
"Ib",this.YVb);G$b(this);this.R.Pb(2790,this.Fc);this.J&&this.R.Pb(2791,this.Fc)};q.WG=function(a){pW.Z.WG.call(this,a);G$b(this);this.rc()&&H$b(this)};function G$b(a){if(a.rc()){var b=a.Id();a.O.setVisible(!b);a=Dn(a.oa,qW.T_a,p$b(a));R(a,!b)}}q.XVb=function(a){13==a.keyCode&&a.target==this.Ba&&(a.preventDefault(),a.stopPropagation(),I$b(this,2255))};
function J$b(a){for(var b=a.getChartType(),c=!!D(a.C,14),d=D(a.C,16),e=!!D(a.C,15),g="Histogram"==b,h="PieChart"==b,k=K$b(a),l=1<k.length,m=[],b=0;b<k.length;b++){var p=L$b(k[b].rect,c!=h);Pb(m,p)}var b=kA(a.Ke).ud(),r=vb(hc(Yg),b.E1,b),c=vb(m,function(a){return vb(r,Fa(xh,a))});g&&e&&(c=Qb(c,1));a.Gb=M$b(c.length,h&&0<d||!g&&!h&&e,h&&l);d=kA(a.Ke);for(b=0;b<c.length;b++)for(e=a.Gb[b],g=0;g<c[b].length;g++)c[b][g]&&Jh(c[b][g])&&(h=QT(d,c[b][g],qW.p0a),H(a,h),EF(xI(d),h,!0),Pp(h.Ba,"background-color",
e),h.setVisible(!0),a.Wc.push(h),h=WH(d,c[b][g],qW.o0a,1,0),H(a,h),ZXa(h,e),h.setVisible(!0),a.Qc.push(h))}function N$b(a){Kc(a.Wc);Kc(a.Qc);a.Wc=[];a.Qc=[];a.Gb=[]}q.YVb=function(){this.La&&(N$b(this),J$b(this))};q.Ima=function(){pW.Z.Ima.call(this);this.Da=Ha();this.La||(J$b(this),this.La=!0)};q.Z8=function(){pW.Z.Z8.call(this);Ba(this.Da)&&500<Ha()-this.Da&&this.R.Pb(2789,this.Fc);this.Da=null;N$b(this);this.La=!1};q.Mjb=function(){this.Ba.focus()};
q.Iib=function(){var a=T(this,qW.L2);if(kq(a))a.focus();else{if(a=this.F)a=T(this.F,"waffle-assistant-thumbs-up-button"),kq(a)?(a.focus(),a=!0):a=!1;a||this.O.Ba.focus()}};q.Dhb=function(){var a;if(a=this.X)a=this.X,T(a,"waffle-assistant-feedback-card-hidden")?a=!1:(T(a,"waffle-assistant-feedback-card-link").focus(),a=!0);a||this.Ba.focus()};q.sqb=function(){this.R.Pb(2255,this.Fc);I$b(this,2255)};q.aua=function(a){a.stopPropagation()};q.gCb=function(){X.V1.Ub(this)};
q.T8=function(a,b){I$b(this,2257,a,b)};function I$b(a,b,c,d){F$b(a,y(function(a){a=new E9b(a,this.Y,this.L&&this.L.Se(),b,c,d);this.dispatchEvent(a)},a),!1)}
q.ZVb=function(a,b){if(b){var c=T(this,qW.vea);if(b.$h())tH.Lz(c,b);else{a.Ff(b.Se());CV(a,a.Se());hU(a,"ready",y(this.WVb,this,a));b=[];try{var d=new ef;d.setContext(a.toJSON());var e=!!D(this.C,14);F(d,3,e);var g=D(this.C,16);F(d,4,g);F(d,5,"ROWS"==(e?"ROWS":"COLS"));F(d,8,0);var h;if(D(this.C,24)){h=[NT(D(this.C,18))];var k=D(this.C,25);F(d,9,k)}else h=K$b(this);for(e=0;e<h.length;e++)d.addRange(Ph(h[e].rect,h[e].vd));var l=this.Le.serialize(d);b=vb(T8b(Fa(ritz.getVerbalHighlightsForProto,l),a).call(),
Q8b)}catch(m){b=[]}d=T(this,qW.L2);R(d,0<b.length);0<b.length&&(d.appendChild(b[0]),un(d,!0));this.L=a;JV(a,c,um)}}};q.WVb=function(a){null!==this.ea&&(CJ(AJ.getInstance(),this.ea),this.ea=null);this.isDisposed()||(a.Tl()&&(uH(a.Tl(),"onmouseover",y(this.UVb,this)),uH(a.Tl(),"onmouseout",y(this.VVb,this))),this.Bd(),H$b(this))};q.UVb=function(){this.Na=Ha()};q.VVb=function(){Ba(this.Na)&&500<Ha()-this.Na&&this.R.Pb(2795,this.Fc);this.Na=null};
function H$b(a){if(a.Ua&&!a.Id()){var b=T(a,qW.vea);if(!a.Ua.contains(b)){var c=a.Ua;a=new B$b(b,a);cib(c,a)}}}
function O$b(a){a.Qb&&(a.ea=BJ(AJ.getInstance(),nj.Gua),a.Qb=!1);var b=new FH(uc(C$b)),c=a.C.getChartType(),d=D(a.C,16);"PieChart"==c?(b.setOption("pieSliceText","none"),b.setOption("legend.position","labeled")):0>=d&&b.setOption("legend.position","none");b.setOption("title",D(a.C,2));b.setOption("hAxis.title",D(a.C,3));Ac(a.C,4)&&b.setOption("hAxis.viewWindow.min",D(a.C,4));Ac(a.C,5)&&b.setOption("hAxis.viewWindow.max",D(a.C,5));b.setOption("vAxes.0.title",D(a.C,6));Ac(a.C,7)&&b.setOption("vAxes.0.viewWindow.min",
D(a.C,7));Ac(a.C,8)&&b.setOption("vAxes.0.viewWindow.max",D(a.C,8));b.setOption("vAxes.1.title",D(a.C,9));Ac(a.C,10)&&b.setOption("vAxes.1.viewWindow.min",D(a.C,10));Ac(a.C,11)&&b.setOption("vAxes.1.viewWindow.max",D(a.C,11));b.setOption("useFirstColumnAsDomain",D(a.C,15));b.setOption("isStacked",D(a.C,17));b.setOption("treatLabelsAsText",Bb(D$b,c));b.Bh(c);d=Fc(a.C,12);if(!D(a.C,24)&&d&&d.length)if(b.setOption("applyAggregateData",0),d=Fc(a.C,13),"PieChart"===c)b.setOption("aggregateFunction",d[0]);
else for(c=0;c<d.length;c++)b.setOption("series."+c+".aggregateFunction",d[c]);b.wba(UH);var c=K$b(a),d=!!D(a.C,14),e=D(a.C,16)||0,d=Jl(s3a("/gviz/tq"),"").ib("transpose",d?"1":"0").ib("headers",e.toString()).ib("hds",0).ib("merge",d?"ROWS":"COLS").ib("authkey",Bm("authKey"));D(a.C,24)&&(c=[NT(D(a.C,18))],d.ib("dt",encodeURIComponent(JSON.stringify(a.Le.serialize(D(a.C,25))))));x3a(d,c);b.Ii(d.toString());a.J&&(c=d.clone(),a.J.F=c);return b}
function E$b(a){var b=O$b(a);b.setOption("legend.position","none");b.setOption("hAxis.slantedText",0);b.setOption("hAxis.textStyle.fontSize",11);b.setOption("vAxes.0.textStyle.fontSize",11);b.setOption("vAxes.1.textStyle.fontSize",11);b.setOption("fontStyle.size",10);b.setOption("fontStyle.italic",!1);b.setOption("titleTextStyle.bold",!1);b.setOption("titleTextStyle.fontSize",12);b.setOption("async",40);!1!==b.Vb("useFirstColumnAsDomain")&&b.Se()&&"number"===b.Se().$c(0)&&b.setOption("hAxis.gridlines.count",
-1);var c=15;if(!1!==b.Vb("useFirstColumnAsDomain")&&b.Se()&&"string"===b.Se().$c(0)){var c=0,d=an("span");d.style.fontSize="11px";d.style.fontFamily="Roboto,Arial";T(a,"waffle-assistant-card-inner").appendChild(d);for(var e=0;e<b.Se().getNumberOfRows();e++)sn(d,b.Se().zf(e,0)),c=Math.max(c,oq(d).width);hn(d);c=Math.min(27,Math.max(15,10+100*c/271))}b.setOption("chartArea.top","15%");d=b.Vb("hAxis.title");b.setOption("chartArea.height",Qa(Sa(d))?"80%":"65%");b.setOption("chartArea.left",c+"%");b.setOption("chartArea.width",
95-c+"%");"PieChart"==b.getChartType()&&(b.setOption("chartArea.top",Qa(Sa(b.Vb("title")))?"12%":"15%"),b.setOption("chartArea.height","70%"),b.setOption("chartArea.left","0%"),b.setOption("chartArea.width","100%"),b.setOption("pieSliceText","none"),b.setOption("legend.position","labeled"),b.setOption("legend.textStyle.fontSize",10));(new oV(UH,b.Sg)).send(y(a.ZVb,a,b));a.J&&F$b(a,y(function(a){var c=this.J,d=b;a=new FH(a.toJSON());var d=new FH(d.toJSON()),e=Dq(c,"waffle-assistant-faceted-chart");
if(1<e.length){z$b(a);var g=d;y$b(g);g.setOption("pieSliceText","percentage");g.setOption("axisFontSize",0);g.setOption("hAxis.title",null);g.setOption("hAxis.textPosition","none");g.setOption("vAxes.0.title",null);g.setOption("vAxes.0.textPosition","none");g.setOption("vAxes.1.title",null);g.setOption("vAxes.1.textPosition","none");g.setOption("chartArea",{left:"5%",top:"5%",width:"90%",height:"90%"});g.setOption("legend","none");g.setOption("titleTextStyle.fontSize",0)}else g=a,z$b(g),g.setOption("applyAggregateData",
void 0),g.setOption("legend","right"),y$b(d);g=NT(D(c.J,18));x3a(c.F,[g]);for(var g=D(c.J,25),p=0;p<e.length;p++){var r=ya(c.L[p])?c.L[p]:null,t=g.clone(),w=t,x=c.Da,C=r,E=new kf;F(E,1,x);ya(C)&&E.Wa(C);F(w,7,E);c.F.ib("dt",encodeURIComponent(JSON.stringify(c.Na.serialize(t))));t=new FH(a.toJSON());t.Ii(c.F.toString());w=d.clone();w.Ii(c.F.toString());var C=c,I=t,x=r;(E=I.Vb("title"))||(E=w9b(I));I=E+(' when "'+(C.D+('" is "'+(x+'"'))));C=E+(' by "'+(C.D+'"'));x=x?I:C;t.setOption("title",x);w.setOption("title",
x);w=new v$b(t,w,0,0,c.La,c.O,c.oa);c.Ma(w);x=e[p];w.Va(x);c.ea.push(w);w=c;C=w9b(t);t=C+(' broken down by "'+(w.D+('" for "'+(r+'"'))));w=C+(' broken down by "'+(w.D+'"'));Fp(x,r?t:w)}A$b(c);c.Ba.style.visibility="visible"},a),!1)}function F$b(a,b,c){var d=O$b(a);(new oV(UH,d.Sg)).send(function(a){a?(a=a.Se(),c&&d.Ff(a),CV(d,a),b(d)):b(null)})}function K$b(a){a=Fc(a.D,4);for(var b=[],c=0;c<a.length;c++)b.push(NT(a[c]));return b}q.getChartType=function(){return this.C.getChartType()};
function M$b(a,b,c){var d=b?["#666"]:[];c&&(a/=2);b&&--a;b=Z6b("material").colors;for(var e=0;e<a;e++)d.push(b[e%b.length].color);c&&Pb(d,d);return d}function L$b(a,b){return b?u9b(a,new kh(a.width,1)):u9b(a,new kh(1,a.height))};function P$b(){xL.call(this);this.Ka.push(this);this.va=this.ea=!0;this.Na="waffle-assistant-dragged-card"}z(P$b,bib);P$b.prototype.contains=function(a){return!!A(this.J,function(b){if(b.element==a)return!0})};P$b.prototype.Uka=function(a){var b=P$b.Z.Uka.call(this,a);if(F5b()||um){a=a.querySelectorAll("CANVAS");for(var c=b.querySelectorAll("CANVAS"),d=0;d<a.length;d++)c[d].getContext("2d").drawImage(a[d],0,0)}else a=vb(b.querySelectorAll("clippath"),function(a){return a.id}),Q$b(b,a);return b};
function Q$b(a,b){for(var c=a.getAttribute&&a.getAttribute("clip-path"),d=0;d<b.length;d++){var e=b[d];ya(c)&&cb(c,e)&&a.setAttribute("clip-path",c.replace(e,e+"-clone"));e==a.id&&(a.id=e+"-clone")}a=kn(a);for(d=0;d<a.length;d++)Q$b(a[d],b)}function B$b(a,b){zL.call(this,a,b)}z(B$b,zL);B$b.prototype.Wka=f("element");function R$b(){return V('<div class="waffle-assistant-word-cloud-card"><div class="waffle-assistant-word-cloud-title"></div><div class="waffle-assistant-word-cloud-words-container"></div></div>')};function rW(a,b){nW.call(this,a,b);this.C=a.getAutovisRecommendation()}z(rW,nW);q=rW.prototype;q.cz=oa;q.Wx=n("assistantWordCloudFeedback");q.pE=n(2634);q.oE=n(2633);q.Sa=function(){rW.Z.Sa.call(this);oW(this).appendChild(Tr(R$b));Ip(oW(this),"waffle-assistant-word-cloud-content-container")};
q.mz=function(a){for(var b=Fc(this.C,19),c=Fc(this.C,20),d=T(this,"waffle-assistant-word-cloud-words-container"),e=0;e<b.length;e++)if(this.Lk(b,c,e),120<d.clientHeight){this.Lk(b,c,e-1);break}b=this.oa;c=D(this.C,2);c=Gn(b,c);d=T(this,"waffle-assistant-word-cloud-title");b.appendChild(d,c);a()};
q.Lk=function(a,b,c){for(var d=T(this,"waffle-assistant-word-cloud-words-container"),e=this.oa;d.firstChild;)d.removeChild(d.firstChild);for(var g=b[c],h=b[0],k=0;k<=c;k++){0!=k&&d.appendChild(Gn(e," "));var l=e.createElement("SPAN");e.appendChild(l,Gn(e,a[k]));e.appendChild(d,l);Ip(l,"waffle-assistant-word-cloud-word");var m=b[k];l.style.color=0==k%2?"#00695C":"#61443C";l.style.fontSize=(m-g)/(h-g)*15+9+"px"}};function sW(a,b,c,d,e){YV.call(this,20,d,c,e);this.ea=a;this.$=b;this.C=new P$b;H(this,this.C);this.F=null;this.Y=0}z(sW,YV);q=sW.prototype;q.Ga=function(){sW.Z.Ga.call(this);this.C.We();this.getHandler().V(this.C,"drag",this.TVb).V(this.C,"dragend",this.SVb)};q.ZT=n("Analysis");q.r4=function(a){return 0==a};q.HW=function(a){return"WordCloud"==a.getAutovisRecommendation().getChartType()?new rW(a,this.oa):new pW(a,this.ea,this.$,this.O,this.C,this.oa)};q.I1=function(a){sW.Z.I1.call(this,a);a&&Khb(this.C)};
q.YIa=function(a){Gf(this.getHandler(),a,"content-rendered",this.RVb);this.Y++};q.RVb=function(){0==--this.Y&&this.dispatchEvent("assistant-done-rendering")};q.TVb=function(){this.F=dq(this.C.Xc.target)};q.SVb=function(a){var b=this.F,c=kA(this.$).C;if(ph(xE(c,"page",!1,!1)).contains(b)){var d=vE(c,b.x,b.y,"page"),c=zE(c,vh(d),"page"),b=new N(b.x-c.left,b.y-c.top);a.C.getData().T8(d,b)}this.F=null};q.cda=n(2);function S$b(a){for(var b=0;b<T$b.length;++b)if(-1!=Ab(T$b[b].tj,function(b){return Ma(a,b)}))return b;return-1};function tW(a,b,c,d){this.C=a;this.xfa=b;this.Pn=(this.F=c)?D(c,2):null;this.L=c?Fc(c,6):[];this.O=c?Fc(c,7):[];this.J=c?Fc(c,8):[];this.error=d||1;this.interpretation=ooa&&c&&Ac(c,4)?D(c,4):null;this.D=poa&&c?Fc(c,12):[]}function U$b(a){return{JS:V$b(a),interpretation:a.interpretation,xfa:a.xfa,Pn:a.Pn}}function W$b(a){return{JS:V$b(a),error:X$b(a)}}
function X$b(a){switch(a.error){case 2:return"Looks like you are offline. Try again when you reconnect.";case 3:return"There was a problem getting your answer. Please try again.";case 4:return"Sorry, couldn't understand your question.";case 5:return"Answers lets you ask question and learn more about you data.";case 6:return a.F.getError().yl()||"";case 7:return a=S$b(a.C),-1!=a?T$b[a].zg:""}return""}
function V$b(a){var b=[];if(noa&&1==a.error&&null!=a.Pn){var c=[];A(Lb(a.L,a.J),function(a){c.push(Y$b(a,"waffle-assistant-answercard-question-unused-phrase"))},a);A(a.O,function(a){c.push(Y$b(a,"waffle-assistant-answercard-question-used-entity"))},a);Ub(c,function(a,b){return a.ZB>b.ZB?1:-1});var d=0;A(c,function(a){a.ZB>d&&b.push({text:this.C.substring(d,a.ZB),className:null});d=a.ZB+a.length;b.push({text:this.C.substring(a.ZB,d),className:a.wk})},a);d<a.C.length&&b.push({text:a.C.substring(d),
className:null})}else b.push({text:a.C,className:null});return b}function Y$b(a,b){return{ZB:D(a,2),length:D(a,3),wk:b}};function uW(a,b,c,d){L.call(this);this.X=a;this.Y=b;this.$=c;this.Ka=d;this.qa=new M(this);H(this,this.qa);this.C=new GU;H(this,this.C);this.R="";this.O=[];this.F=this.D=this.L=null;this.J=!1;c6b(this.C,this.X);this.C.X=10;this.C.ea=!0;this.C.L=!1;this.C.xra("waffle-assistant-visible");this.C.R=Wa("waffle-assistant-dragged-formula").split(" ");this.C.We();this.qa.V(this.C,"beforedragstart",this.ea).V(this.C,"dragmove",this.Ha).V(this.C,"beforedragend",this.va)}z(uW,L);
uW.prototype.ea=function(a){a=sb(this.X.childNodes,a.C);this.R=this.O[a]};
uW.prototype.Ha=function(a){var b=a.event instanceof zq?a.event.C:a.event;this.J?(a.Y.ow(b,!0),a.preventDefault()):(Vp(a.F,a.event.clientX,a.event.clientY),a=Wp(a.F),b=kA(this.Y).C,ph(xE(b,"page",!1,!1)).contains(a)?(a=vE(b,a.x,a.y,"page"),(b=ix(Bw(this.$),a.y,a.x))?a=new N(b.bc(),b.hc()):b=vh(a),this.L=a,this.D&&this.D.Ac().equals(b)||(a=kA(this.Y),J(this.D),this.D=QT(a,b,"waffle-assistant-formula-insertion-rect"),H(this,this.D),EF(xI(a),this.D),J(this.F),this.F=WH(a,b,"waffle-assistant-formula-insertion-border",
2,0),H(this,this.F),ZXa(this.F,"#000"),this.F.setVisible(!0))):Z$b(this))};uW.prototype.va=function(a){if(this.L){var b=this.L,c=Bw(this.$),b=new PE(c,b,this.R);this.Ka.C(b);this.dispatchEvent(new K("formula_inserted"))}a.Y.ow(null,!0);a.preventDefault();this.R="";Z$b(this)};function Z$b(a){a.L=null;J(a.D);a.D=null;J(a.F);a.F=null};function $$b(a){var b=V,c='<div class="waffle-assistant-padded-card"><div class="waffle-assistant-answercard-content">'+aac({JS:a.Z3.JS}),d;d=a.Z3.xfa;var e=a.Z3.Pn;a=a.Z3.interpretation;null==d||ta(d);a=""+('<div class="waffle-assistant-answercard-answer-container"><div class="waffle-assistant-answercard-answer-header" role="heading" aria-label="'+ss("Answer")+'"><span aria-hidden="true">Answer</span></div>'+(a?'<div class="waffle-assistant-answercard-interpret-content"><div class="waffle-assistant-answercard-interpret">'+
U(a)+"</div></div>":"")+'<div class="waffle-assistant-answercard-answer-content">');if(d){a+='<div class="waffle-assistant-answercard-answer">';for(var g=d.length,h=0;h<g;h++){var k=d[h],l=1<k.length;if(0==h&&l){a+='<div class="waffle-assistant-answercard-answer-rowheader">';for(var l=k.length,m=0;m<l;m++)a+='<span class="waffle-assistant-answercard-answer-col">'+U(k[m])+"</span>"}else for(l="waffle-assistant-answercard-answer-row"+(l?" waffle-assistant-answercard-answer-list-row":""),l=os(l),a+=
'<div class="'+W(l)+'">',l=k.length,m=0;m<l;m++){var p=k[m];a=p?a+('<span class="waffle-assistant-answercard-answer-col">'+U(p)+"</span>"):a+('<span class="'+W("waffle-assistant-answercard-answer-col waffle-assistant-answercard-answer-empty")+'">N/A</span>')}a+="</div>"}a+="</div>"}a+='<div class="waffle-assistant-answercard-formula-holder"><div class="waffle-assistant-answercard-see-formula-link">See formula</div><div class="waffle-assistant-answercard-hide-formula-link">Hide formula</div><div class="waffle-assistant-answercard-formula"><div class="waffle-assistant-answercard-formula-icon">'+
U(Uu({icon:"docs-icon-img docs-icon-insert-formula"}))+'</div><div class="waffle-assistant-answercard-formula-text-container"><div class="waffle-assistant-answercard-formula-text" tabindex="0">'+U(e)+"</div></div></div></div></div></div>";d=V(a);return b(c+d+"</div></div>")}
function aac(a){a=a.JS;var b;b=""+('<div class="waffle-assistant-answercard-question-container"><div class="waffle-assistant-answercard-question-header" role="heading" aria-label="'+ss("Question")+'"><span aria-hidden="true">Question</span></div><div class="waffle-assistant-answercard-question-content"><div class="waffle-assistant-answercard-question">');for(var c=a.length,d=0;d<c;d++){var e=a[d];b+=e.className?'<span class="'+W(e.className)+'">'+U(e.text)+"</span>":U(e.text)}return V(b+"</div></div></div>")}
function bac(){return V(U(V('<div class="waffle-assistant-answers-card-remove">'+U(Uu({icon:"docs-icon-img docs-icon-trash"}))+"</div>")))};var cac="help;how can;how do i;how do you;how do u;how to;what can;what does;what is this".split(";"),T$b=[{tj:["Thank you"],zg:"No problem"},{tj:["you are amazing","This is great","omg"],zg:"Happy to help"},{tj:["I love you"],zg:"Must be in the air"},{tj:["How do you know"],zg:"It's all in the data"},{tj:["Are you sure"],zg:"Send feedback if this doesn't seem correct to help improve accuracy"},{tj:["How are you"],zg:"Pretty good, thanks"},{tj:["Hi","Hello","Hey"],zg:"Hi, there. Try asking a question about your data."},
{tj:["You are stupid","This is dumb","You are wrong"],zg:"Help improve this experience by sending feedback"},{tj:["How smart are you"],zg:"Pretty smart"}];function dac(a,b,c,d){K.call(this,"sqc");this.F=a;this.C=d||"";this.Y=c}z(dac,K);function vW(a,b,c,d,e,g,h,k){nW.call(this,new iW,k);this.L=a;this.Da=b;this.Ua=c;this.Na=d;this.Za=g;this.ea=e;this.La=h;this.Fc=ap(new $o,10).Fa();this.R=new qt("",new lW,this.oa);this.Ma(this.R);this.C=null;this.J=new qt("",new kW,this.oa);this.Ma(this.J);this.O=new qt("",new kW,this.oa);this.Ma(this.O)}z(vW,nW);q=vW.prototype;q.Cja=f("La");q.Sa=function(){vW.Z.Sa.call(this);p$b(this).appendChild(Tr(bac))};
q.Ga=function(){vW.Z.Ga.call(this);var a=T(this,"waffle-assistant-answers-card-remove");this.R.Va(a);VV(a,"Remove card",0);Gf(this.getHandler(),this.R,"action",this.gWb).V(this.J,"action",this.Txb).V(this.O,"action",this.xpb)};
q.mz=function(a){oW(this).appendChild(Tr($$b,{Z3:U$b(this.L)}));this.J.Va(T(this,"waffle-assistant-answercard-see-formula-link"));this.O.Va(T(this,"waffle-assistant-answercard-hide-formula-link"));this.C=new uW(T(this,"waffle-assistant-answercard-formula-text-container"),this.Da,this.Ua,this.Na);var b=this.Id();this.C.J=b;this.C.O=[this.L.Pn];H(this,this.C);b=T(this,"waffle-assistant-answercard-formula-text");Fp(b,"Formula: "+(this.L.Pn+". Click/Press ENTER to copy or drag to insert on to sheet."));
If(this.getHandler().V(this.C,"formula_inserted",this.fWb),T(this,"waffle-assistant-answercard-formula-text"),nd,this.Pob);eac(this,!1);a()};q.cz=function(){Fp(this.Ba,"Answer Card for question: "+this.L.C)};q.XT=Lf;q.Wx=n("assistantAnswersFeedback");q.pE=n(2628);q.oE=n(2627);q.O7=n("Was this answer correct?");q.Aka=n("Correct");q.zka=n("Incorrect");q.P6=f("L");q.WG=function(a){vW.Z.WG.call(this,a);this.C&&(this.C.J=a)};
function eac(a,b){a.J.setVisible(!b);a.O.setVisible(b);R(T(a,"waffle-assistant-answercard-formula"),b);b?T(a,"waffle-assistant-answercard-formula-text").focus():(a.J.Ba.focus(),a.J.Oq(!0))}q.gWb=function(){var a=new TV;P(a,3,!0);var b=new TT;gj(b,4,a);a=new no;gj(a,46,b);this.ea.Pb(2753,new Zo(10,a));this.dispatchEvent(new K("rc"))};q.Txb=function(){eac(this,!0)};q.xpb=function(){eac(this,!1)};q.fWb=function(){this.ea.Pb(2709,this.Fc)};
q.Pob=function(){var a=this.oa.yb(),b=a.createElement("textarea");b.textContent=this.L.Pn;b.style.position="fixed";a.body.appendChild(b);b.select();var c=!1;try{c=a.execCommand("copy")}catch(d){}finally{a.body.removeChild(b)}c&&fac(this.Za,"Formula copied to clipboard",this.oa)};function gac(a,b,c){c=c||{};a=os("Ask a question about your data");a='<div class="waffle-assistant-answers-input"><form class="waffle-assistant-answers-query-box"><div class="waffle-assistant-answers-input-container">'+('<input type="text" class="waffle-assistant-answers-input-box" placeholder="'+W(a)+'" aria-label="'+W(a)+'"/></div><div class="waffle-assistant-answers-input-controls"><div class="waffle-assistant-answers-button-container">');a+='<div class="'+W("waffle-assistant-answers-query-box-button waffle-assistant-answers-clear-query-button")+
'">'+U(Uu({icon:"docs-icon-img docs-icon-cancel"}))+'</div></div><div class="waffle-assistant-answers-spinner-container" style="'+(c.cb?"/*"+c.cb+"*/":"")+'display:none"></div></div></form></div>';return V(a)};function hac(a){var b=V,c='<div class="waffle-assistant-padded-card"><div class="waffle-assistant-answercard-content">'+U(aac({JS:a.dFa.JS})),d;d=a.dFa.error;var e=!!a.showHelp;a='<div class="waffle-assistant-answercard-error-container"><div class="waffle-assistant-answercard-error-image">'+U(Uu({icon:"docs-icon-img docs-icon-unsupported-black"}))+'</div><div class="waffle-assistant-errorcard-content">';e?(d=U(d)+' Look in <div class="waffle-assistant-answers-helpcenter-link">Sheets help</div> instead?',
a+='<div class="waffle-assistant-errorcard-text">'+d+"</div>"):a+='<div class="waffle-assistant-errorcard-text">'+U(d)+"</div>";d=V(a+"</div></div>");return b(c+d+"</div></div>")}function iac(){return V('<div class="waffle-assistant-answercard-feedback-container"><div class="waffle-assistant-answercard-feedback-link">Send feedback</div></div>')};function wW(a,b,c,d,e){nW.call(this,new iW,e);this.O=a;this.ea=b;this.L=d;this.Da=c;this.R=new qt("",new lW,this.oa);this.Ma(this.R);this.J=new qt("",new kW,this.oa);this.Ma(this.J);this.C=new qt("",new kW,this.oa);this.Ma(this.C)}z(wW,nW);q=wW.prototype;q.cz=function(){Fp(this.Ba,"Error Card for question: "+this.O.C)};q.Wx=n("assistantAnswersFeedback");q.XT=Lf;q.t9=Kf;q.Sa=function(){wW.Z.Sa.call(this);p$b(this).appendChild(Tr(bac))};
q.Ga=function(){wW.Z.Ga.call(this);var a=T(this,"waffle-assistant-answers-card-remove");this.R.Va(a);this.C.setVisible(this.L);VV(a,"Remove card",0);Gf(Gf(this.getHandler(),this.R,"action",this.kWb),this.J,"action",this.fyb).V(this.C,"action",this.tpb)};
q.mz=function(a){oW(this).appendChild(Tr(hac,{dFa:W$b(this.O),showHelp:this.L}));if(km){var b=Tr(iac);this.oa.appendChild(this.Ba,b);this.J.Va(T(this,"waffle-assistant-answercard-feedback-link"))}this.L&&this.C.Va(T(this,"waffle-assistant-answers-helpcenter-link"));a()};q.Cja=f("ea");q.P6=f("O");q.fyb=function(){this.J.setVisible(!1);R(T(this,"waffle-assistant-answercard-feedback-container"),!1);this.dispatchEvent(new K("trigger_feedback"))};
q.kWb=function(){var a=new TV;P(a,3,!1);var b=new TT;gj(b,4,a);a=new no;gj(a,46,b);this.Da.Pb(2753,new Zo(10,a));this.dispatchEvent(new K("rc"))};q.tpb=function(){Q.$l.Ub()};function jac(a){nW.call(this,new iW,a);this.C=this.oa.createElement("div");sn(this.C,"Previous")}z(jac,nW);q=jac.prototype;q.cz=function(){Fp(this.Ba,"Previous questions below")};q.Sa=function(){jac.Z.Sa.call(this);Kp(this.Ba,"waffle-assistant-card");Ip(this.Ba,"waffle-assistant-answers-previousheadercard")};q.mz=function(a){0<this.oa.Ah(oW(this)).length||oW(this).appendChild(this.C);a()};q.t9=Kf;q.Wx=n("assistantAnswersFeedback");function kac(a){var b;b=""+(a.title?'<div class="waffle-assistant-suggestionscard-header">'+U(a.title)+"</div>":"");var c;c=os("Suggested question");b+='<div class="waffle-assistant-suggested-questions">';a=a.DPb;for(var d=a.length,e=0;e<d;e++){var g=a[e];b+='<div class="waffle-assistant-answercard-question-container" tabindex="0"><div class="waffle-assistant-answercard-question-header" role="heading" aria-label="'+W(c)+'">'+U(Uu({icon:"docs-icon-img docs-icon-help"}))+'</div><div class="waffle-assistant-answercard-question-content"><div class="waffle-assistant-answercard-question">'+
U(g)+"</div></div></div>"}return V(b+"</div>")};function xW(a,b,c,d,e){nW.call(this,a,e);this.J=c;this.C=d;this.L=b}z(xW,nW);q=xW.prototype;q.pE=function(){return Bb([lac,mac],this.C)?2799:Bb([nac,oac],this.C)?2801:null};q.oE=function(){return Bb([lac,mac],this.C)?2798:Bb([nac,oac],this.C)?2800:null};q.O7=n("Were these interesting?");q.Aka=n("Interesting");q.zka=n("Not interesting");q.Wx=n("assistantAnswersFeedback");q.cz=function(){var a=this.C.title;a&&this.J?Fp(this.Ba,a+(" for question : "+this.J)):Fp(this.Ba,"Suggested questions")};
q.mz=function(a){this.L.then(function(b){if(0==b.length)R(this.Ba,!1);else{var c=this.oa,d=oW(this);if(0==c.Ah(d).length){var e=Tr(kac,{title:this.C.title,DPb:vb(b,function(a){return a.query})});d.appendChild(e);d=Dq(this,"waffle-assistant-answercard-question-container");A(d,function(a,d){var e=new qt("",new lW,c);this.Ma(e);e.Va(a);this.getHandler().V(e,"action",y(this.Kzb,this,b[d]))},this)}}a()},null,this)};q.Kzb=function(a){this.dispatchEvent(new dac(this.C.T0,0,a.Pn||null,a.query))};
var pac={title:"",T0:null},lac={title:"",T0:1},mac={title:"Suggested questions",T0:1},oac={title:"Did you mean?",T0:4},nac={title:"Related questions",T0:4};function yW(a,b){var c=[],d={};if(a>b*b)for(var e=0;e<b;e++){var g;do g=Math.floor(Math.random()*a);while(d[g]);d[g]=1;c.push(g)}else{for(e=0;e<a;e++)c.push(e);for(e=0;e<b;e++)d=Math.floor(Math.random()*(a-e)+e),g=c[e],c[e]=c[d],c[d]=g}return c.slice(0,b)};function qac(a){this.J=[];this.D={};this.L=a;this.C=new zP}function rac(a,b,c,d){function e(a){return a.toLowerCase()}Rb(b,void 0,e);Rb(c,void 0,e);Rb(d,void 0,e);A(b,a.F,a);A(c,a.F,a);A(d,a.F,a)}qac.prototype.F=function(a){var b=a.toLocaleLowerCase(),c=0;if(100>b.length)for(var d=0;d<b.length&&3>c;++d)if(0==d||/[^a-zA-Z0-9]/.test(b[d-1])&&!/[^a-zA-Z0-9]/.test(b[d])){++c;var e=a,g=b.substr(d),h=this.C.get(g);h||(h=[],this.C.add(g,h));h.push(e)}};
qac.prototype.dG=function(a,b,c){var d;if(Wa(a||"")){d=this.L.Pl();d=sac(this,a.substring(0,d));var e=tac(this,b-d.length,a);d=Lb(d,e)}else d=tac(this,b);d.length>b&&(d=Qb(d,0,b));c(a,d)};function tac(a,b,c){var d=c||"";c=cc(a.D,function(a){return Ma(a,d)});var e=uac(hc(c),d?1:2,1);a=ub(a.J,function(a){return Ma(a.query,d)&&!e[a.query.toLowerCase()]});b=uac(a,b-gc(e),2);return Lb(hc(b),hc(e))}
function sac(a,b){for(var c=[],d=3,e={},g=b.toLowerCase(),h=0;h<g.length&&0<d;++h)if(0==h||" "==g[h-1]&&" "!=g[h]){var k={},l=0,m=g.substr(h),p=a.C.xe(m);A(p,function(a){var b=a.length-m.length;l=Math.max(b,l);a=this.C.get(a);k[b]||(k[b]=[]);Pb(k[b],a)},a);for(p=0;p<=l&&0<d;++p){var r=k[p];if(r)for(var t=0;t<r.length&&0<d;++t){var w=r[t];cb(b.toLowerCase(),w.toLowerCase())||e[w]||(--d,c.push({text:w,Pn:"",Xy:0,fBa:g.length-h}),e[w]=!0)}}}return c}
function uac(a,b,c){b=yW(a.length,Math.min(a.length,b));var d={};A(b,function(b){b=a[b];var e=ya(b)?b:b.query;d[e.toLowerCase()]={text:e,Pn:ya(b)?"":b.Pn,Xy:c,fBa:0}});return d};function zW(){tF.call(this,"",null,!1)}z(zW,tF);zW.prototype.FB=function(a,b){if(2==a.Xy||1==a.Xy)return zW.Z.FB.call(this,a.text,b);var c=this.Ia(),d=this.Pl(),e=" "==c[d];void 0==c[d]&&(c=c.trim(),d>c.length&&(d=c.length));var g=c.substring(0,d-a.fBa)+a.text;e||(g+=" ");a=zW.Z.FB.call(this,{toString:function(){return g+c.substring(d)}},b);this.r0(g.length);b=this.Bj;b.blur();b.focus();return a};
zW.prototype.Ig=function(a){var b=zW.Z.Ig.call(this,a);b||39!=a.keyCode||a.ctrlKey||a.shiftKey||(b=this.C,IWa(b)&&b.FE()&&a.preventDefault(),b=!0);return b};function vac(){return V('<div class="waffle-assistant-answers-ac-suggestion"><div class="waffle-assistant-answers-ac-suggestion-icon-container"><div class="waffle-assistant-answers-ac-suggested-query-icon">'+U(Uu({icon:"docs-icon-img docs-icon-help"}))+'</div><div class="waffle-assistant-answers-ac-session-query-icon">'+U(Uu({icon:"docs-icon-img docs-icon-clock"}))+'</div><div class="waffle-assistant-answers-ac-entity-icon">'+U(Uu({icon:"docs-icon-img docs-icon-arrow-tilted"}))+'</div></div><span class="waffle-assistant-answers-ac-suggestion-text"></span></div>')}
;function wac(a){this.C=a||Om()}
wac.prototype.fL=function(a,b,c){b=Tr(vac);var d=Dn(this.C,"waffle-assistant-answers-ac-suggestion-text",b);a=a.data;this.C.Nf(d,a.text);var d=Dn(this.C,"waffle-assistant-answers-ac-entity-icon",b),e=Dn(this.C,"waffle-assistant-answers-ac-suggested-query-icon",b),g=Dn(this.C,"waffle-assistant-answers-ac-session-query-icon",b);R(d,0==a.Xy);R(e,2==a.Xy);R(g,1==a.Xy);d="";switch(a.Xy){case 0:d="waffle-assistant-answers-ac-row-entity";break;case 1:d="waffle-assistant-answers-ac-row-session-query";break;
case 2:d="waffle-assistant-answers-ac-row-suggested-query"}d&&Ip(c,d);this.C.appendChild(c,b)};function AW(a,b,c,d,e,g,h,k,l){WV.call(this,l);this.Le=c;this.Fj=d;this.Ei=e;this.Df=a;this.mb=h;this.Da=this.R=this.J=this.bb=null;this.ea=new zW;this.ea.TFa=!0;this.ea.ea=!0;this.La=new qac(this.ea);a=new rF(null,new wac(l));this.F=new mF(this.La,a,this.ea);H(this,this.F);this.L=g;this.Y=null;this.dh=k;this.Xa=!1;this.Fc=ap(new $o,10).Fa();this.Si=new Li;this.Na={};this.X=this.C=this.Qb=null;this.Qc=[];this.qc=[];this.$e=AJ.getInstance();this.Za=""}z(AW,WV);q=AW.prototype;
q.Sa=function(){AW.Z.Sa.call(this);var a=this.F.Re();a.className="waffle-assistant-answers-ac-renderer";a.ri="waffle-assistant-answers-ac-row";a.vt="waffle-assistant-answers-ac-active";a.ZH="waffle-assistant-answers-ac-highlighted"};q.Ga=function(){AW.Z.Ga.call(this);this.ea.C=this.F;this.F.j4=!1;this.F.F$=6;this.getHandler().V(this.F,"update",this.mib);this.wL(null==this.Y)};
q.Lqa=function(a,b){AW.Z.Lqa.call(this,a,b);b=this.oa;var c=this.$;b.appendChild(a,Tr(gac));this.X=Dn(b,"waffle-assistant-answers-query-box",a);this.J=new qt("",new lW,this.oa);c.Ma(this.J);this.J.Va(Dn(b,"waffle-assistant-answers-clear-query-button",this.X));this.Da=new MV(!1,"#4285f4");c.Ma(this.Da);this.Qb=Dn(b,"waffle-assistant-answers-spinner-container",this.X);this.Da.render(this.Qb);this.C=Dn(b,"waffle-assistant-answers-input-box",this.X);XWa(this.ea,this.C);VV(this.J.getElement(),"Clear query");
c.getHandler().V(this.X,"submit",y(this.Gzb,this)).V(this.X,"focus",y(this.ZEa,this,!0),!0).V(this.X,"blur",y(this.ZEa,this,!1),!0).V(this.J,"action",y(this.E3a,this)).V(this.C,"input",y(this.JQb,this)).V(this.C,"focus",y(this.sMb,this));this.J.setVisible(!1)};q.q5=function(){ZWa(this.ea,this.C);this.J.setVisible(!1);this.Da.dispose();this.Da=null;AW.Z.q5.call(this)};q.wL=function(a){AW.Z.wL.call(this,a);this.C&&(a?this.C.setAttribute("disabled",!0):this.C.removeAttribute("disabled"))};q.qh=ea("bb");
function xac(a,b,c){var d=vb(Fc(c,1),function(a){return a.getName()}),e=[],g=[];A(Fc(c,2),function(a){e.push(a.getName());g=g.concat(Fc(a,2))});rac(a.La,d,e,g);yac(a.Df).then(function(a){this.La.J=a},null,a);a.Y=b;a.wL(null==b)}q.reset=function(){pU(this.Na);pU(this.La.D);this.R=null};
function zac(a){if(a.rc()&&(Aac(a),null!=a.Y))for(var b=kA(a.Le),c=b.ud(),c=vb(hc(Yg),c.E1,c),c=vb(c,Fa(xh,a.Y.rect)),d=0;d<c.length;d++)if(c[d]&&Jh(c[d])){var e=QT(b,c[d],"waffle-assistant-answers-styled-rect");H(a,e);EF(xI(b),e,!0);e.setVisible(!0);a.Qc.push(e);e=WH(b,c[d],"waffle-assistant-answers-styled-border",1,0);H(a,e);e.setVisible(!0);a.qc.push(e)}}function Aac(a){Kc(a.Qc);Kc(a.qc);a.Qc=[];a.qc=[]}
q.mib=function(a){a.row&&(a=a.row,2==a.Xy?(Bac(this,1,a.Pn),this.L.Pb(2652,this.Fc)):0==a.Xy?(this.Xa=!0,this.L.Pb(2651,this.Fc)):1==a.Xy&&Bac(this,3))};q.ZEa=function(a){Mp(this.X,"waffle-assistant-answers-query-box-focused",a);oF(this.F)&&!a&&this.F.vj()};q.JQb=function(){this.J.setVisible(!!y9b(this.C))};q.sMb=function(){this.F.tv(this.C);var a=Sa(y9b(this.C));this.ea.r0(a.length);FWa(this.F,a||"  ");this.F.update(!0)};
function Bac(a,b,c){var d=Wa(y9b(a.C));if(!a.bb||3<=a.bb.getStatus().getState().C)d=new tW(d,null,null,2),Cac(a,d,!1);else{if(d&&a.Y)if(a.Na[d])a.L.Pb(2681,a.Fc),c=a.Na[d],c!=rb(a.D)&&(1<a.D.length&&(Dac(a),Eac(a)),Fac(a,c.P6()),L9b(a,c));else{var e=Gac(),g=ej(ej(e,TT,46),TV,4);P(g,2,a.Xa);a.L.Pb(2635,new Zo(10,e));a.Xa=!1;e=Sw(a.Y.rect);b=bl(uj(cl(wj(xj(a.bb.Cf("/answers/parse").Gf("q",d,"qt",b,"gid",a.Y.vd,"range",e),y(a.Sj,a,d,b)),y(a.hWb,a,d,b)),"POST"),2));c&&b.Gf("sgfml",c);b.Te();a.Za=BJ(a.$e,
nj.Cua);Hac(a,!0)}else x9b(a.C,"");a.C.blur();a.J.setVisible(!!d);oF(a.F)&&a.F.vj()}}q.Gzb=function(a){a.stopPropagation();a.preventDefault();Bac(this,2)};q.E3a=function(){x9b(this.C,"");this.J.setVisible(!1)};q.hWb=function(a,b){var c=Gac(),d=ej(ej(c,TT,46),TV,4);P(d,1,1==b||4==b?A9b.cza:A9b.Dza);this.L.Pb(2640,new Zo(10,c));Iac(this,a)};function Iac(a,b){Hac(a,!1);b=new tW(b,null,null,3);Cac(a,b,!1);Jac(a)}
q.Sj=function(a,b,c){var d=null,e=null,g=!1,h=Gac(),k=ej(ej(h,TT,46),TV,4);P(k,1,1==b||4==b?A9b.cza:A9b.Dza);b=new Zo(10,h);if(c.bl()){e=this.Si.od(aW.Ca(),c.Mf());if(g=e.getStatus()){var l;switch(g){case 1:l=2639;break;case 2:l=2643;break;case 3:l=2644;break;case 4:l=2638;break;case 5:l=2707;break;case 6:l=2706}l&&this.L.Pb(l,b)}if(1==g){Iac(this,a);return}if(2==g){e=-1!=Kac(a);d=-1!=S$b(a);g=4;e?g=5:d&&(g=7);a=new tW(a,null,null,g);e?(e=new wW(a,!0,this.L,!0,this.oa),Lac(this,a,e)):Cac(this,a,!0);
Hac(this,!1);Jac(this);return}l=e.hasFormula()?D(e,2):null;c=Ac(e,9)?e.getError().yl():null;g=!0;l?((d=Mac(this.dh,l,this.Y))||this.L.Pb(2645,b),d=new tW(a,d,e,null)):c&&(d=new tW(a,null,e||null,6))}else this.L.Pb(2640,b);d||(d=new tW(a,null,e||null,4));Hac(this,!1);1==d.error&&null!=d.Pn?Nac(this,d,g):Cac(this,d,g);Jac(this)};function Jac(a){""!=a.Za&&(CJ(a.$e,a.Za),a.Za="")}
function Oac(a){if(null!=a.Pn)return nac;switch(a.error){case 4:return 0<a.D.length?oac:mac;case 5:return mac;case 6:return oac}return pac}function Gac(){var a=new TV,b=new TT;gj(b,4,a);a=new no;gj(a,46,b);return a}function Kac(a){return Ab(cac,function(b){return Ma(a,b)})}function Pac(a){var b=[];a=a.D;0<a.length&&(a=Qb(a,0,3),b=vb(a,function(a){return{query:D(a,1),Pn:D(a,2),type:a.getType()}}));return Hj(b)}function Nac(a,b,c){c=new vW(b,a.Le,a.Fj,a.Ei,a.L,a.mb,c,a.oa);Lac(a,b,c)}
function Cac(a,b,c){c=new wW(b,c,a.L,!1,a.oa);Lac(a,b,c)}function Lac(a,b,c){Dac(a);Eac(a);Fac(a,b);Qac(a,c);for(var d=a.D;5<d.length;)a.eL(d[0]);if(1==b.error&&null!=b.Pn){var d=a.La,e=b.C;d.D[e.toLowerCase()]||(d.D[e.toLowerCase()]=e)}c.Cja()&&(a.Na[b.C]=c);a.getHandler().V(c,"rc",a.Cwb)}function Eac(a){0!=a.D.length&&(a.R?L9b(a,a.R):(a.R=new jac(a.oa),Qac(a,a.R)))}function Dac(a){A(a.D,function(a){a instanceof vW||a instanceof wW||a==this.R||this.eL(a)},a)}
function Fac(a,b){var c=Oac(b),d=null;c==nac||c==oac?0<b.D.length&&(d=Pac(b)):c==mac&&(d=Rac(a.Df));d&&(c=new xW(new iW,d,b.C,c,a.oa),Qac(a,c),a.L.Pb(2769,a.Fc),a.getHandler().V(c,"sqc",y(a.Jzb,a,b)))}q.Jzb=function(a,b){x9b(this.C,b.C);this.C.focus();Bac(this,b.F,b.Y);this.L.Pb(2762,this.Fc)};function Hac(a,b){R(a.Qb,b);R(Dn(a.oa,"waffle-assistant-answers-button-container",a.X),!b);a.Da&&a.Da.setActive(b)}function Qac(a,b){b.WG(a.Id());a.D.push(b);a.Wc&&(a.O.xi(b,0,!0),b.HO());XV(b,!0)}
q.A4=function(){AW.Z.A4.call(this);this.reset()};q.Cwb=function(a){var b=this.oa;a=a.target;a instanceof vW?(this.eL(a),fac(this.mb,"Answer removed",b,y(this.Dwb,this,a))):a instanceof wW&&(this.eL(a),fac(this.mb,"Card removed",b));b=this.D;!this.R||b[0]!=this.R&&b[b.length-1]!=this.R||(this.eL(this.R),this.R=null)};q.Dwb=function(a){Nac(this,a.P6(),a.Cja());fac(this.mb,"Remove answer undone",this.oa)};
q.eL=function(a){if(a.rc()){if(a instanceof vW||a instanceof wW)delete this.Na[a.P6().C],a==rb(this.D)&&Dac(this);AW.Z.eL.call(this,a)}J(a)};function Sac(){var a;a=""+(V('<div class="waffle-assistant-answers-logging-message-container"><div class="waffle-assistant-answers-logging-message"><span class="waffle-assistant-answers-logging-text">We\'re logging your queries and data to improve the feature.</span><div class="waffle-assistant-answers-learn-more">Learn More</div><div class="waffle-assistant-answers-logging-opt-out">Opt-out for this file</div></div></div>')+'<div class="waffle-assistant-answers-input"><form class="waffle-assistant-answers-query-box"><div class="waffle-assistant-answers-input-container"><div class="waffle-assistant-answers-search-icon">'+
U(Uu({icon:"docs-icon-img docs-icon-search-this-document"}))+'</div><input class="waffle-assistant-answers-input-box" placeholder="'+ss("Ask a question about your data")+'" /></div></form></div>');return V(a)};function Tac(a,b){this.C=a;this.D=b}function Mac(a,b,c){var d=vw(a.D),d=null!=d?d.toString():"0",e=0,g=0;ritz.getActiveFilterId(d)&&(c=c.rect,ritz.getNumberOfRows(d)>c.Uc()+1?e=c.Uc()+1:ritz.getNumberOfColumns(d)>c.bd()+1&&(g=c.bd()+1));return t9b(a.C,b,d,e,g)};function Uac(a){var b=[];if(Ac(a,25)&&(a=D(a,25)))for(var c=0;c<Bc(a,1);c++){var d=D(a,1,c);if(Ac(d,2)){var e=D(d,2);e&&b.push(Vac(e,Wac(d)))}}return b}function Wac(a){return(a=Ac(a,4)?D(a,4):0)?a:0}function Vac(a,b){return{name:a,Xza:b}};function Xac(a,b,c){this.F=a;this.J=b;this.C=[];this.D=[];a=new rg;b=new rg;for(var d=0;d<c.length;d++){var e,g=c[d];e=Uac(g);Ac(g,6)&&(g=D(g,6))&&e.push(Vac(g,0));for(g=0;g<e.length;g++){var h=e[g].name.toLowerCase();lg(this.F,h)&&a.add(this.F.get(h));lg(this.J,h)&&b.add(this.J.get(h))}}this.C=a.Fd();this.D=b.Fd();Ub(this.C);Ub(this.D)};function Yac(a,b){this.C=a;for(var c=new jg,d=0;d<Bc(a,2);d++)c.set(a.$d(d).getName().toLowerCase(),d);this.L=c;c=new jg;for(d=0;d<Bc(a,1);d++)c.set(D(a,1,d).getName().toLowerCase(),d);this.Y=c;c=[];for(d=0;d<Bc(a,2);d++)BW(a.$d(d).getName())&&c.push(d);this.D=c;c=[];for(d=0;d<Bc(a,1);d++)BW(D(a,1,d).getName())&&c.push(d);this.J=c;c=[];for(d=0;d<Bc(a,1);d++){for(var e=D(a,1,d).getName(),g=!0,h=0;h<Zac.length;h++)if(-1!=e.search(new RegExp("(\\b|_)"+Zac[h]+"(\\b|_)","i"))){g=!1;break}g&&c.push(d)}this.ea=
c;this.X=$ac(a,0);this.O=$ac(a,1);c=[];for(d=0;d<Bc(a,2);d++).8<=D(a.$d(d),6)&&c.push(d);this.R=c;this.$=abc(Bc(a,2));this.va=abc(Bc(a,1));this.F=new Xac(this.L,this.Y,b)}function abc(a){for(var b=[],c=0;c<a;c++)b.push(c);return b}function $ac(a,b){for(var c=[],d=0;d<Bc(a,2);d++)a.$d(d).getType()==b&&c.push(d);return c}
function bbc(a,b){if(0==a.length&&0==b.length)return-1;for(var c=0<a.length?a[0]:b[0],d=1;d<a.length;d++)c=cbc(c,a[d]);for(d=0;d<b.length;d++)c=dbc(c,b[d]);return 0<c.length?c[yW(c.length,1)[0]]:-1}function ebc(a,b,c){var d=[a.D,a.F.C],e=[a.$];b&&e.push(a.X);c&&e.push(a.R);return bbc(e,d)}function CW(a,b){var c=[a.J,a.F.D],d=[a.va];b&&d.push(a.ea);return bbc(d,c)}function fbc(a){var b=[a.D,a.F.C],c=[Fc(a.C,3)];c.push(a.X);c.push(a.R);return bbc(c,b)}
function gbc(a,b){for(var c=5;;){var d=a.C.$d(b),e=yW(Bc(d,2),1)[0];c--;if(BW(D(d,2,e))||0==c)return e}}function DW(a,b){b=a.C.$d(b);a=b.getName();BW(a)||(b=hbc(Fc(b,7)),a=null==b?a:b);return a}function EW(a,b){b=D(a.C,1,b);a=b.getName();BW(a)||(b=hbc(Fc(b,2)),a=null==b?a:b);return a}function hbc(a){for(var b=0;b<a.length;b++)if(BW(a[b]))return a[b];return null}function BW(a){return null==a?!1:50>=a.length}function ibc(a){for(var b=yW(a.length,2),c=[],d=0;d<b.length;d++)c.push(a[b[d]]);return c}
function cbc(a,b){for(var c=[],d=0,e=0;d<a.length&&e<b.length;)a[d]==b[e]?(c.push(a[d]),d++,e++):a[d]<b[e]?d++:e++;return c}function dbc(a,b){b=cbc(a,b);return 0<b.length?b:a}var Zac=["average","total","sum","mean","median"];function jbc(a){this.C=[];this.F=[];this.J=this.L=this.D=null;this.R=new rg;this.O=new rg;this.X=a}jbc.prototype.reset=function(){this.C=[];this.F=[];this.D&&(this.D.cancel(),this.D=null);this.O=new rg;this.R=new rg};jbc.prototype.qh=ea("J");function yac(a,b){if(qoa)return a.D.then(function(){var a=this.F.slice();b||D9b(a);return a},null,a);a=a.C.slice();b||D9b(a);return Hj(a)}
function kbc(a){if(!a.C)throw Error("Suggestions not generated. Must call generate() at the top level");return 0<a.C.length?a.C[0].query:""}function FW(a,b,c,d){a.O.contains(c)||(b.push({query:c,Pn:void 0,type:d}),a.R.add(d),a.O.add(c))}function GW(a,b){return!a.R.contains(b)}function Rac(a){return yac(a,roa).then(function(a){return 3>=a.length?a:Qb(a,0,3)},null,a)}function lbc(a,b){var c=[];b=Uac(b);for(var d=0;d<b.length&&-1!=a.Y.get(b[d].name.toLowerCase(),-1);d++)c.push(b[d]);return c}
function mbc(a){switch(a){case 6:return"Sum";case 1:return"Average";case 4:return"Count"}return null}function HW(a){return a[yW(a.length,1)[0]]}
function nbc(a){var b=null;a.D=new Fj(function(a){if(!this.J||3<=this.J.getStatus().getState().C)this.F=this.C,a();var c=Sw(this.L.rect),e=vb(this.C,function(a){return a.query});b=cl(bl(uj(wj(xj(this.J.Cf("/answers/parsesuggestions").Gf("gid",this.L.vd,"range",c),y(function(b){var c=[];if(b.bl()){b=b.Mf();for(var d=0;d<b.length;d++){var e;if(e=b[d])a:{if(e=Mac(this.X,b[d],this.L))for(var g=1<e.length?1:0;g<e.length;g++){for(var p=!1,r=e[g],t=0;t<r.length;t++)if(!r[t]){p=!0;break}if(!p){e=!0;break a}}e=
!1}e&&(this.C[d].Pn=b[d],c.push(this.C[d]))}}this.F=c;a()},this)),y(function(){this.F=this.C;a()},this)).setContent(["queries",Xi(e)]).setTimeout(2E3),1)),"POST").Te()},a);Mj(a.D,function(){b&&b.dispose()})}var obc="Minimum Maximum Most Least Highest Lowest".split(" "),pbc=["Average","Total","Sum"],qbc=["before","after"];function IW(a,b,c,d,e,g,h){YV.call(this,1,g,e,h);this.Za=c;this.ea=null;this.Y=new qt("",new kW,this.oa);this.Ma(this.Y);this.$=new qt("",new kW,this.oa);this.Ma(this.$);a=new Vkb(a,!0,!0);a=new Tac(a,c);this.L=new jbc(a);this.C=new AW(this.L,0,b,c,d,e,this.Xa,a,h);this.F=this.Da=null;this.Fc=ap(new $o,10).Fa()}z(IW,YV);
var rbc={fZa:"waffle-assistant-answers-input-box",t_a:"waffle-assistant-answers-query-box",Vic:"waffle-assistant-answers-query-box-focused",pZa:"waffle-assistant-answers-learn-more",$ec:"waffle-assistant-answers-logging-message-container",WZa:"waffle-assistant-answers-logging-opt-out"};q=IW.prototype;q.Sa=function(){IW.Z.Sa.call(this);var a=Tr(Sac);this.oa.appendChild(N9b(this),a)};
q.Ga=function(){IW.Z.Ga.call(this);var a=T(this,rbc.t_a),b=T(this,rbc.fZa);this.$.Va(T(this,rbc.WZa));this.Y.Va(T(this,rbc.pZa));this.getHandler().V(a,"focus",this.Qvb,!0).V(a,"blur",this.Ovb,!0).V(a,"mouseover",this.Svb).V(a,"mouseout",this.Rvb).V(a,"click",this.Pvb).V(b,"input",this.iWb).V(this.$,"action",this.oub).V(this.Y,"action",this.frb).V(zw(this.Za),"Ib",C9b(this.jWb,25,this));this.setVisible(null!=this.Da);sbc(this,moa&&soa&&Bm("showAnswersLoggingOptOut"))};q.eTa=Kf;q.VLa=Lf;q.$ra=Kf;
q.ZT=n("Answers");q.cda=n(1);q.r4=function(a){return 3==a||0==a};q.cua=function(a,b){Ub(a,function(a,b){return b.TS()-a.TS()});for(var c=[],d=null,e=0;e<a.length;e++){var g=Gc(a[e],1);3==g?d=a[e]:0==g&&c.push(a[e].getAutovisRecommendation())}d&&d.TS()?(e=b||null,0<Bc(d,4)?tbc(this,NT(d.wJ()),D(d,9),c):tbc(this,e,D(d,9),c),this.F||(IW.Z.cua.call(this,a,b),this.getHandler().V(this.F,"sqc",this.Izb))):this.G1(!0)};q.HW=function(a){if(!this.F){var b=Rac(this.L);this.F=new xW(a,b,"",lac,this.oa)}return this.F};
q.cCa=f("C");q.ena=function(){return this.Ta()};q.G1=function(a,b,c){this.L.reset();(a||b)&&this.F&&(IW.Z.G1.call(this,a,b,c),this.F.dispose(),this.F=null);if(a||u(b)&&!b)this.F&&(IW.Z.G1.call(this,a,b,c),this.F.dispose(),this.F=null),this.rc()&&(this.L.reset(),this.Da=null,a=this.C,a.rc()&&(b=a.La,b.J=[],b.C.clear(),a.C&&x9b(a.C),a.A4(),a.Y=null,a.wL(!0),a.J&&!a.J.isDisposed()&&a.J.setVisible(!1),a.Xa=!1),this.setVisible(!1),this.Ob()&&Aac(this.C));c&&this.C.reset()};
q.qh=function(a){this.ea=a;this.C.qh(a);this.L.qh(a)};q.setActive=function(a){IW.Z.setActive.call(this,a);a?zac(this.C):Aac(this.C)};function sbc(a,b){R(T(a,"waffle-assistant-answers-logging-message-container"),b)}function ubc(a,b){a=T(a,"waffle-assistant-answers-query-box");Mp(a,"waffle-assistant-answers-query-box-focused",b)}q.jWb=function(){this.Ob()&&zac(this.C)};q.Qvb=function(){ubc(this,!0);zac(this.C)};q.Ovb=function(){ubc(this,!1);this.Ob()||Aac(this.C)};q.Svb=function(){zac(this.C)};
q.Rvb=function(){this.Ob()||Aac(this.C)};q.Pvb=function(){vbc(this,"")};q.iWb=function(){var a=T(this,"waffle-assistant-answers-input-box");vbc(this,a.value);a.value=""};q.Izb=function(a){vbc(this,a.C);gl(function(){Bac(this.C,1)},150,this);this.O.Pb(2652,this.Fc)};function vbc(a,b){a.setActive(!0);a.dispatchEvent("assistant-sidepane-set-active-panel");gl(function(){var a=this.C;x9b(a.C,b);a.C.focus()},150,a)}
function tbc(a,b,c,d){c=c||new fW;a.Da=b;var e=a.L,g=d;e.reset();g=roa?g:[];d=[];var h=new Yac(c,g);if(roa)for(var k=0;k<g.length;k++){var l=g[k];switch(l.getChartType()){case "BarChart":var m=e,p=h,r=l,l=d;if(GW(m,12)||GW(m,1)){var t=D(r,6);if(t&&-1!=p.L.get(t.toLowerCase(),-1)){p=lbc(p,r);if(0<p.length){var r=HW(p),w=mbc(r.Xza);w&&GW(m,12)&&FW(m,l,w+" of "+r.name+" by "+t,12)}1<p.length&&GW(m,1)&&FW(m,l,"Correlation between "+p[0].name+" and "+p[1].name,1)}}break;case "ScatterChart":m=e;t=h;p=l;
l=d;GW(m,1)&&(t=lbc(t,p),1<t.length&&FW(m,l,"Correlation between "+t[0].name+" and "+t[1].name,1));break;case "PieChart":if(m=e,t=h,r=l,l=d,GW(m,13)){p=[];r=Uac(r);for(w=0;w<r.length&&-1!=t.L.get(r[w].name.toLowerCase(),-1);w++)p.push(r[w]);t=p;1==t.length&&4==t[0].Xza&&FW(m,l,"Distribution of "+t[0].name,13)}}}GW(e,0)&&(k=h.C,g=ebc(h,!0,!0),0<Bc(k,1)&&-1!=g&&(k=CW(h),g=DW(h,g),k=EW(h,k),g!=k&&FW(e,d,"Top "+g+" by "+k,0)));GW(e,1)&&1<Bc(h.C,1)&&(2<=h.J.length?(g=dbc(h.J,h.F.D),k=ibc(2<=g.length?g:
h.J)):k=yW(Bc(h.C,1),2),g=EW(h,k[0]),k=EW(h,k[1]),g!=k&&FW(e,d,"Correlation between "+g+" and "+k,1));GW(e,2)&&(g=CW(h,!0),-1!=g&&FW(e,d,HW(pbc)+" of "+EW(h,g),2));if(GW(e,4)&&(m=h.C,g=CW(h,!0),0<Bc(m,3)&&-1!=g&&(g=EW(h,g),k=fbc(h),-1!=k&&(m=m.$d(k),l=DW(h,k),0<Bc(m,3)&&l!=g)))){a:for(t=5;;)if(p=h.C.$d(k),r=yW(Bc(p,3),1)[0],w=D(p,3,r),t--,BW(D(p,2,r))||0==t){k=w;break a}FW(e,d,HW(pbc)+" of "+g+" when "+l+" is "+D(m,2,k),4)}GW(e,8)&&(k=h.C,g=ebc(h,!0,!0),0<Bc(k,1)&&-1!=g&&(k=EW(h,CW(h)),g=DW(h,g),
g!=k&&FW(e,d,g+" with "+HW(obc)+" "+k,8)));GW(e,9)&&0<Bc(h.C,1)&&(g=EW(h,CW(h)),FW(e,d,HW(obc)+" "+g,9));GW(e,10)&&(g=h.C,0<Bc(g,3)&&(k=fbc(h),-1!=k&&(m=DW(h,k),0<Bc(g.$d(k),3)&&FW(e,d,"Most frequent "+m,10))));if(GW(e,11)){g=h.C;m=CW(h,!0);a:{if(1==h.O.length&&(k=h.O[0],!D(h.C.$d(k),5)))break a;k=-1}-1!=k&&-1!=m&&(m=EW(h,m),g=g.$d(k),0<Bc(g,2)&&(k=gbc(h,k),FW(e,d,HW(pbc)+" of "+m+" "+HW(qbc)+" "+D(g,2,k),11)))}((g=3>d.length)||0==yW(5,1)[0])&&GW(e,6)&&(m=h.C,0<Bc(m,1)&&0<Bc(m,2)&&(t=CW(h),k=ebc(h),
m=m.$d(k),l=DW(h,k),t=EW(h,t),0<Bc(m,2)&&l!=t&&(k=gbc(h,k),FW(e,d,"Show "+t+" for "+l+" "+D(m,2,k),6))));(g||0==yW(5,1)[0])&&GW(e,7)&&(m=h.C,g=ebc(h,!0,!0),1<Bc(m,2)&&-1!=g&&(2<=h.D.length?(k=dbc(h.D,h.F.C),k=ibc(2<=k.length?k:h.D)):k=yW(Bc(h.C,2),2),k=k[0]==g?k[1]:k[0],m=m.$d(k),l=DW(h,k),g=DW(h,g),0<Bc(m,2)&&l!=g&&(h=gbc(h,k),FW(e,d,"What is "+g+" where "+l+" is "+D(m,2,h),7))));e.C=d;e.L=b;qoa&&nbc(e);a.setVisible(null!=b);xac(a.C,b,c);a.Ob()&&zac(a.C)}
q.oub=function(a){a.stopPropagation();a.preventDefault();this.ea&&(cl(wj(xj(this.ea.Cf("/answers/logoptout"),y(this.Qrb,this)),y(this.Prb,this)),"POST").Te(),this.O.Pb(2663,this.Fc))};q.frb=function(a){a.stopPropagation();a.preventDefault();cp("https://docs.google.com/document/d/1VxpmAx5RTnwmeXyj3IuPPYIXg9DYzTS8nz8pi1E_ZJk/preview",{target:"_blank"})};q.Qrb=function(a){a.bl()&&sbc(this,!1)};q.Prb=da();function wbc(){var a;a=""+('<div class="waffle-assistant-banding-recommendation"><div class="waffle-assistant-banding-color-picker-container"></div><div class="waffle-assistant-banding-range-wrapper">Alternating colors for <span class="waffle-assistant-banding-range"></span></div>'+xbc()+"</div>");return V(a)}
function ybc(){return V('<div class="waffle-assistant-conditionalformat-rule-group"><div class="waffle-assistant-conditionalformat-rule-holder" tabindex="0"></div><div class="waffle-assistant-conditionalformat-description"></div>'+xbc()+"</div>")}function xbc(){var a;a=""+U(wt({Oe:"waffle-assistant-formatting-edit-button",content:os("Edit"),style:4}));return V(a)};function JW(a,b,c){nW.call(this,a,c);a=vb(this.D.Ufa(),U5b);this.C=new CU(!1,a,7);this.Ma(this.C);this.O=new xt("",this.oa);this.Ma(this.O);this.R=b;this.L=!1;this.J=-1}z(JW,nW);var zbc={vda:"waffle-assistant-banding-color-picker-container",Gda:"waffle-assistant-formatting-edit-button",AH:"waffle-assistant-banding-range"};q=JW.prototype;q.Sa=function(){JW.Z.Sa.call(this);oW(this).appendChild(Tr(wbc))};
q.Ga=function(){JW.Z.Ga.call(this);this.getHandler().V(this.O,"action",this.nnb).V(this.C,"banding-scheme-changed",this.Dib);this.R.Pb(2768,void 0)};q.mz=function(a){var b=T(this,zbc.vda);this.C.render(b);$5b(this.C);var b=T(this,zbc.AH),c=this.D.wJ(),d=Rh(c);sn(b,Sw(d));Abc(this,c);b=T(this,zbc.Gda);this.O.Va(b);a()};q.cz=function(){Fp(this.Ba,"Suggested alternating background colors");sr(this.C,"Choose a color scheme")};q.Wx=n("assistantBandingFeedback");q.pE=n(2672);q.oE=n(2671);
q.nnb=function(a){Yn.dispatchEvent({type:"show-banding-pane-recommendation",fRa:this.D,B4a:a6b(this.C)});a.stopPropagation()};q.Dib=function(a){if(!this.L&&DU(this.C)){var b=this.J;this.J=this.C.Wh();this.J==b?this.dispatchEvent(new UV("assistant-sidepane-remove-banding",this,2797)):this.dispatchEvent(new UV("assistant-sidepane-apply-banding",this,2673));a.stopPropagation()}};
function Abc(a,b){a.L=!0;var c;c=b.fb();b=Rh(b);c=ritz.getWorkbookRangeIntersectingIds(c,b.hc(),b.bc(),b.Uc(),b.bd(),7,!1);c.length?(c=ritz.getBandedRangeByWorkbookRangeId(c[0]),c=(new Li).od(Fd.Ca(),c),c=U5b(c)):c=null;c?(c=b6b(a.C,c),mL(a.C,c?c.getElement():null)):mL(a.C,null);a.J=a.C.Wh();a.L=!1};function KW(a,b){nW.call(this,a,b);this.C=new xt("",this.oa);this.Ma(this.C);this.mb=Fc(a,6)}z(KW,nW);var LW={Gda:"waffle-assistant-formatting-edit-button",JYa:"waffle-assistant-conditionalformat-format-preview",O_a:"waffle-assistant-conditionalformat-rule-holder",g2:"waffle-assistant-conditionalformat-description",TZa:"one-rule",L0a:"two-rules",A0a:"three-rules",m_a:"waffle-assistant-conditionalformat-format-preview-label"};q=KW.prototype;q.Sa=function(){KW.Z.Sa.call(this);oW(this).appendChild(Tr(ybc))};
q.Ga=function(){KW.Z.Ga.call(this);var a=T(this,LW.Gda);this.C.Va(a);VV(a,"Apply and edit conditional format rules");this.getHandler().V(this.C,"action",this.bib)};q.mz=function(a){sn(T(this,LW.g2),Gc(this.D,3));var b=T(this,LW.O_a),c=new Bbc(this,this.oa);this.Ma(c);c.Va(b);VV(b,"Apply conditional format rules");a()};q.cz=oa;q.Wx=n("assistantConditionalFormatFeedback");q.pE=n(2630);q.oE=n(2629);
q.bib=function(){Cbc(this);this.dispatchEvent(new UV("assistant-sidepane-change-selection",this,2670,void 0,void 0,Rh(D(this.mb[0],1,0))));bo()};function Cbc(a){a.dispatchEvent(new UV("assistant-sidepane-apply-conditional-format-rules",a,2563))}function Bbc(a,b){pr.call(this,void 0,void 0,b);this.C=a}z(Bbc,pr);
Bbc.prototype.Ge=function(a){Bbc.Z.Ge.call(this,a);var b=this.C.mb,c;switch(b.length){case 0:break;case 1:c=LW.TZa;break;case 2:case 4:c=LW.L0a;break;default:c=LW.A0a}for(var d=0;d<b.length;d++){var e=b[d],g=Zm("DIV");Jp(g,[LW.JYa,c]);var h=Zm("DIV");Ip(h,LW.m_a);g.appendChild(h);sn(h,"123");if(Ac(e,2)){var k=D(D(e,2),1);switch(D(D(k,1),1)){case 9:case 13:var k=Fc(D(k,1),2)[0],l=Fc(e,1)[0];sn(h,lF(k,Gc(l,1),Gc(l,2),Gc(l,4)))}}m5b(e,g);a.appendChild(g)}};Bbc.prototype.gj=function(){Cbc(this.C);return!0};function Dbc(a,b,c){YV.call(this,2,b,a,c)}z(Dbc,YV);q=Dbc.prototype;q.ZT=n("Formatting");q.r4=function(a){return 2==a||4==a};q.HW=function(a){var b=D(a,1);switch(b){case 2:return new KW(a,this.oa);case 4:return a=new JW(a,this.O,this.oa),this.getHandler().V(a,"assistant-sidepane-apply-banding",this.rOb).V(a,"assistant-sidepane-remove-banding",this.vCb),a;default:throw Error("Unsupported recommendation type: "+b);}};
q.rOb=function(a){fac(this.Xa,"Alternating colors applied",this.oa,y(this.Eib,this,a.C))};q.vCb=function(){this.Xa.clear()};q.Eib=function(a){this.dispatchEvent(new UV("assistant-undo-pressed",a,2796))};q.I1=function(a){Dbc.Z.I1.call(this,a);this.setVisible(!a)};q.eua=function(a){return this.Id()?(this.setVisible(!1),a):Dbc.Z.eua.call(this,a)};q.cda=n(3);function MW(a,b,c,d){$u.call(this,a,b,c,d,void 0,void 0,!0)}z(MW,$u);MW.prototype.Sa=function(){MW.Z.Sa.call(this);Ip(this.Ba,"waffle-assistant-toast");Ip(T(this,"docs-ui-toast-content"),"waffle-assistant-toast-content")};MW.prototype.cI=function(a,b,c){c=c?c:"waffle-assistant-toast-action";b=Gq(this,b);MW.Z.cI.call(this,a,b,c)};MW.prototype.Il=function(a,b,c,d){this.cI(a,b,d);a=Iq(this,b);If(this.getHandler(),a,nd,y(function(){this.setVisible(!1);c()},this))};function Ebc(){this.C=null}z(Ebc,G);Ebc.prototype.clear=function(){this.C&&(this.C.setVisible(!1),this.C.dispose(),this.C=null)};function fac(a,b,c,d){a.clear();a.C=new MW(b,c,!1,5E3);a.C.render();d&&a.C.Il("Undo","w-a-u-tm-u",d,void 0);a.C.setVisible(!0);a.C.getElement().focus()}Ebc.prototype.ma=function(){Ebc.Z.ma.call(this);this.clear()};function Fbc(a){a=""+('<div class="waffle-assistant-quicksum-entry" tabindex="0"><span class="waffle-assistant-quicksum-entry-name" title="'+W(a.title)+'">'+U(a.name)+'</span><span class="waffle-assistant-quicksum-entry-value"></span><span aria-label="'+ss("Press enter to insert formula")+'"></span></div>');return V(a)};function NW(a,b){Bq.call(this);this.C=a;this.D=b}z(NW,Bq);q=NW.prototype;q.Sa=function(){this.Ba=Tr(Fbc,{name:this.C,title:this.D})};q.Ga=function(){NW.Z.Ga.call(this);var a=T(this,"waffle-assistant-quicksum-entry-name");VV(a);this.getHandler().V(this.Ba,"keypress",this.QVb);R(this.Ba,!1)};q.getFunctionName=f("C");q.Wa=function(a){sn(T(this,"waffle-assistant-quicksum-entry-value"),a||"");R(this.Ba,!!a)};q.Ta=function(){return kq(this.Ba)};
q.QVb=function(a){13==a.keyCode&&(a.stopPropagation(),a.preventDefault(),this.dispatchEvent(new K("insert",this)))};function OW(a,b,c,d,e){Bq.call(this,e);this.La=a;this.ea=b;this.R=c;this.L=d;this.D=a.C;this.Da=new Li;this.Y=ap(new $o,17).Fa();this.X=ap(new $o,2).Fa();this.O=!1;this.F=[];this.C=null;this.J=[]}z(OW,Bq);
OW.prototype.Ga=function(){OW.Z.Ga.call(this);this.xi(new NW(ritz.getLocalizedFunctionName("SUM"),"Sum"),0,!0);this.xi(new NW(ritz.getLocalizedFunctionName("AVERAGE"),"Average"),1,!0);this.xi(new NW(ritz.getLocalizedFunctionName("MIN"),"Minimum"),2,!0);this.xi(new NW(ritz.getLocalizedFunctionName("MAX"),"Maximum"),3,!0);this.xi(new NW(ritz.getLocalizedFunctionName("COUNTA"),"Count all"),4,!0);this.C=new uW(this.Ba,this.ea,this.D,this.R);this.C.J=this.O;H(this,this.C);this.getHandler().V(this,"insert",
this.$).V(this.C,"formula_inserted",this.Na)};
function Gbc(a){function b(a){return l?ritz.renderNumberAsFormattedString(a,m):null}if(Aw(a.D)){var c=Bw(a.D),d=AC(c),e=YI(a.D);if(yb(d,c.Qt,c)){var g=[];a.F=[];for(c=0;c<d.length;c++){var h=d[c],k=gha(e+"",h.hc(),h.bc(),h.Uc(),h.bd());g.push(a.Da.serialize(k));a.F.push(h)}if(d=ritz.quickSum(g)){R(a.Ba,!0);var e=d.count,c=d.countNumberFormat,l=1<d.numericCount,m=l?d.valueNumberFormat:null;a.Ad(0).Wa(b(d.sum));a.Ad(1).Wa(b(d.average));a.Ad(2).Wa(b(d.min));a.Ad(3).Wa(b(d.max));1<e?a.Ad(4).Wa(ritz.renderNumberAsFormattedString(e,
c)):R(a.Ba,!1);if(a.C){a.C.O=[];a.J=[];for(c=0;c<a.qd();++c)d=a.Ad(c),a.J.push(Hbc(a,d.getFunctionName()));a.C.O=a.J}}else R(a.Ba,!1)}else R(a.Ba,!1)}else R(a.Ba,!1)}OW.prototype.$=function(a){var b=a.target;a=this.F[0];a=new N(a.left,a.Uc());b=b.getFunctionName();b=Hbc(this,b);a=new PE(Bw(this.D),a,b);this.R.C(a);this.L.Pb(2624,this.X)};OW.prototype.Na=function(){this.L.Pb(2624,this.Y)};function Hbc(a,b){var c=Zw(a.La.O);a=vb(a.F,function(a){return Sw(a)});return"="+b+"("+a.join(c)+")"};function Ibc(a){a=""+('<div class="waffle-autovis-lightbox"><div class="waffle-autovis-lightbox-header"><div class="waffle-autovis-lightbox-buttons-wrapper">'+U(wt({content:os("INSERT CHART"),style:4,Oe:"goog-inline-block waffle-autovis-lightbox-button waffle-autovis-lightbox-insert waffle-autovis-lightbox-readonly-hidden"}))+U(wt({Oe:"waffle-autovis-lightbox-close",content:ps(""+U(Uu({icon:"docs-icon-img docs-icon-close-white"}))),style:4,title:os("Close")}))+'</div></div><div class="waffle-autovis-lightbox-content"><div class="waffle-autovis-lightbox-content-inner">\x3c!-- TODO(cuiffo): Replace with real icons --\x3e'+
U(wt({content:ps("&#10094;"),style:4,Oe:"goog-inline-block waffle-autovis-lightbox-button waffle-autovis-lightbox-previous",attributes:qs('aria-label="'+ss("Previous chart")+'"')}))+'<div class="goog-inline-block waffle-autovis-lightbox-container"></div>'+U(wt({content:ps("&#10095;"),style:4,Oe:"goog-inline-block waffle-autovis-lightbox-button waffle-autovis-lightbox-next",attributes:qs('aria-label="'+ss("Next chart")+'"')}))+'</div><div class="waffle-autovis-lightbox-page-count"><span class="waffle-autovis-lightbox-page-number"></span>/'+
U(a.fGb)+"</div></div></div>");return V(a)}function Jbc(){return V('<div class="waffle-autovis-lightbox-chart"></div>')};function PW(a,b,c){Bq.call(this,c);this.F=a;this.D=b;this.J=[];this.C=new xt("",this.oa);this.Ma(this.C);this.R=new xt("",this.oa);this.Ma(this.R);this.O=new xt("",this.oa);this.Ma(this.O);this.L=new xt("",this.oa);this.Ma(this.L)}z(PW,Bq);q=PW.prototype;q.Sa=function(){PW.Z.Sa.call(this);this.Ba=Tr(Ibc,{fGb:this.F.length})};
q.Ga=function(){PW.Z.Ga.call(this);var a=X.fH.isEnabled();Kbc(this,!a);a=T(this,"waffle-autovis-lightbox-close");this.C.Va(a);a=T(this,"waffle-autovis-lightbox-insert");this.R.Va(a);var b=T(this,"waffle-autovis-lightbox-previous");this.O.Va(b);b=T(this,"waffle-autovis-lightbox-next");this.L.Va(b);Lbc(this);Mbc(this,this.D,!1);this.getHandler().V(document.body,dd,this.gRb).V(this.Ba,"keydown",this.hRb).V(Ym(),"resize",this.kRb).V(this.C,"action",this.close).V(this.R,"action",this.tqb).V(this.O,"action",
this.jRb).V(this.L,"action",this.iRb);b=new Hv(this.Ba,this.oa);Iv(b);H(this,b);a.focus()};function Lbc(a){var b=T(a,"waffle-autovis-lightbox-content"),c=T(a,"waffle-autovis-lightbox-content-inner");a=T(a,"waffle-autovis-lightbox-page-count");var d=Wm();a=hq(a);var e=d.height-a.height-195,g=d.width-200;.75<e/g?(d=g,e=.75*g):d=e/.75;eq(c,d,e);eq(b,d,e+a.height+35)}function Kbc(a,b){Mp(a.Ba,"waffle-autovis-lightbox-readonly",b)}
function Mbc(a,b,c){c&&ao("Page "+(b+1+(" of "+(a.F.length+"."))));a.J[b]?Nbc(a,b):a.F[b]&&F$b(a.F[b],y(a.Sjb,a,b),!0)}q.Sjb=function(a,b){if(!this.isDisposed()&&b){var c=T(this,"waffle-autovis-lightbox-container"),d=Tr(Jbc);c.appendChild(d);this.J[a]=d;JV(b,d,um);Nbc(this,a)}};function Nbc(a,b){R(a.J[a.D],!1);R(a.J[b],!0);a.O.Qa(0!=b);a.L.Qa(b!=a.F.length-1);var c=T(a,"waffle-autovis-lightbox-page-number");sn(c,b+1);a.D=b}q.gRb=function(a){!pn(this.Ba,a.target)&&a.relatedTarget&&a.relatedTarget.focus()};
q.hRb=function(a){27==a.keyCode?this.close():37==a.keyCode||38==a.keyCode?0!=this.D&&Mbc(this,this.D-1,!0):39!=a.keyCode&&40!=a.keyCode||Obc(this);a.stopPropagation()};q.kRb=function(){var a=T(this,"waffle-autovis-lightbox-container");en(a);this.J=[];Lbc(this);Mbc(this,this.D,!0)};q.tqb=function(){this.close();I$b(this.F[this.D],2256)};q.jRb=function(){0!=this.D&&Mbc(this,this.D-1,!0);0==this.D&&this.L.Ba.focus()};q.iRb=function(){Obc(this);this.D==this.F.length-1&&this.O.Ba.focus()};
function Obc(a){a.D!=a.F.length-1&&Mbc(a,a.D+1,!0)}q.close=function(){this.dispose()};q.xd=function(){PW.Z.xd.call(this);var a=this.F[this.D];a&&a.Ba&&a.Ba.focus()};function Pbc(a,b){L.call(this);this.Za=a;this.xb=b;this.F=a.C;this.Da=new Li;this.Ka=Vj();this.J=Vj();this.gc=this.C=this.D=this.L=this.O=this.va=this.Y=null;this.$a=!1;this.$=null;this.Xa=!0;this.Pa=this.La=!1;this.Na=this.Ua=null;this.R=AJ.getInstance();this.Ha=this.ea="";b=this.Za.O.Jr();this.X=new jW;F(this.X,2,Vna);a=Boa&&!a.Id();F(this.X,3,a);F(this.X,4,toa);a=tm&&"en"==kD(b);F(this.X,5,a);F(this.X,6,woa);F(this.X,7,Coa);F(this.X,10,!1);a=new M(this);H(this,a);a.V(this.xb,"Ca",this.rWb)}
z(Pbc,L);var Qbc={y0b:"cu",WWa:"cs",VWa:"ce",wZa:"ls",vZa:"le"};q=Pbc.prototype;q.update=function(a,b,c){c&&this.C&&!zb(c,function(a){return aha(a,this.C.rect)},this)||(this.Ka.cancel(!0),this.Y&&this.Y.cancel(!0),a&&(this.Pa=!0,this.J.cancel(!0),this.D=this.L=this.O=this.va=null),this.Ka=Rbc(),this.Ka.addCallback(this.P2a,this),this.Ka.addCallback(Fa(this.Q2a,b),this))};q.qh=ea("Ua");q.rWb=function(){this.Y&&3==this.xb.getState()&&(this.Y.Hb(),this.Y=null)};
function Rbc(){var a=null,b=new Oj(function(){null===a||hl(a)}),a=gl(function(){b.Hb()});return b}q.cjb=function(){this.La=!0};q.P2a=function(){var a=this.F.getActiveGrid();if(a){var b=Bw(this.F),c=AC(b),d=Sbc(this,c||[]),e=Sbc(this,this.gc||[]);d&&!e||!d&&!Tbc(c,this.gc)?(this.D=null,this.$a=!0):this.$a=!1;this.gc=c;var g=DC(b).clone();A(AC(b),function(a){yh(g,a)});this.$=new Mh(a.fb(),"",g)}else this.$=null};
q.Q2a=function(a){this.ea=BJ(this.R,nj.Sva);var b=this.F.getActiveGrid(),c=this.$&&this.$.vd;if(!b||b.fb()!=c||null===c)return this.$=null;var d=this.F.getActiveGrid().D,b=BA(d,this.$.rect);b.addCallback(function(){if(!this.F.getActiveGrid()||vw(this.F)!=c)return null;var b=Bw(this.F),g=EA(b,this.$.rect,hc(Xg),a?void 0:500),h=xA(b.F,"r"),k=b.Qm("r");return!b.Qt(g)||h>=g.hc()&&YIa(b)||k<=g.Uc()&&XIa(b)?(this.dispatchEvent(new K("ls")),DA(d,g,hc(Xg),a?void 0:500).addCallback(this.k5a,this)):g},this);
b.addCallback(function(a){var b=this.F.getActiveGrid();return a&&b&&b.fb()==c&&null!==c?Ubc(this,a,Bw(this.F)):null},this);b.addCallback(function(b){b=b&&new Mh(c,"",b);if(null===b&&null!==this.C||null!==b&&!b.equals(this.C))this.D=this.L=this.O=this.va=null;var d=null!==b&&b.equals(this.C);if(d=this.Pa||this.$a||!d&&(null===this.O||null!==this.L&&null===this.D))this.Xa=this.La&&this.Xa||!this.C||!b||!b.rect.intersects(this.C.rect);var e=null!==b&&b.contains(this.C);this.C=b;""!=this.ea&&(CJ(this.R,
this.ea),this.ea="");d&&(a&&(this.Ha=BJ(this.R,nj.Tva)),this.J.cancel(!0),this.J=Vj(),this.J.addCallback(this.X2a,this),this.J.addCallback(this.h5a,this),a&&(this.J.addCallback(Fa(this.d5a,e),this),this.Ua&&!kx(this.Za)&&xoa?this.J.addCallback(this.seb,this):(this.J.addCallback(this.U2a,this),this.J.addCallback(this.V2a,this)),this.J.addCallback(this.c5a,this)),Rj(this.J,this.cjb,this))},this);return b};
q.X2a=function(){if(null!==this.C&&null!==this.C.rect&&null===this.va){var a=BJ(this.R,nj.Fua);this.va=ritz.getAssistantConfidence(""+this.C.vd,this.C.rect.top,this.C.rect.height+this.C.rect.top,this.C.rect.left,this.C.rect.width+this.C.rect.left,this.Da.serialize(this.X));CJ(this.R,a)}};q.k5a=function(){this.dispatchEvent(new K("le"))};q.h5a=function(){this.dispatchEvent(new Vbc(this.C,this.va))};q.d5a=function(a){a=new Wbc(a,this.Pa);this.Pa=!1;this.dispatchEvent(a)};
q.seb=function(){if(null===this.C||null===this.C.rect||null!==this.L&&null!==this.D)return null;J(this.Na);return 3!=this.xb.getState()?(this.Y=new Oj,this.Y.addCallback(this.gSa,this),this.Y):this.gSa()};
q.gSa=function(){var a=BJ(this.R,nj.Vva),b=Xbc(this),c=b&&!b.yNa,b=ritz.getAssistantRequestProto(this.C.vd.toString(),this.C.rect.top,this.C.rect.height+this.C.rect.top,this.C.rect.left,this.C.rect.width+this.C.rect.left,c?b.rows:[],c?b.Be:[]),b=this.Da.od(hW.Ca(),b),c=new Li;c.Dv=!0;var b=Xi(c.serialize(b)),d=new Oj;this.Na=wj(xj(uj(bl(cl(this.Ua.Cf("/explore/getrecommendations").Gf("rp",b),"GET")).setTimeout(6E4),1),function(b){var c=BJ(this.R,nj.Uva);b=Ybc(this,b.Mf());CJ(this.R,c);this.L=Fc(b,
1);this.D=Fc(b,2);this.Na=null;CJ(this.R,a);d.Hb()},this),function(){this.L=[];this.D=[];d.Hb()},this).Te();return d};
q.U2a=function(){function a(){b=null;ritz.continueAssistantRecommendation(this.O)?(this.L=Fc(Ybc(this,ritz.getAssistantRecommendations(this.O)),1),d.Hb()):b=gl(a,5,this)}if(null===this.C||null===this.C.rect||null!==this.O&&null!==this.L)return null;this.O=ritz.newAssistantRecommender(this.Da.serialize(this.X));this.D=this.L=null;ritz.startAssistantRecommendation(this.O,""+this.C.vd,this.C.rect.top,this.C.rect.height+this.C.rect.top,this.C.rect.left,this.C.rect.width+this.C.rect.left);var b=null,c=
y(function(){null!==b&&(hl(b),this.D=this.L=this.O=b=null)},this),d=new Oj(c),b=gl(a,5,this);return d};q.V2a=function(){var a=Xbc(this);a&&this.O&&null===this.D&&(this.D=a.yNa?[]:Fc(Ybc(this,ritz.getAssistantRecommendationsOnlySelection(this.O,a.rows,a.Be)),2))};q.c5a=function(){this.La=!1;var a=this.D&&0<this.D.length?this.D:this.L;""!=this.Ha&&(CJ(this.R,this.Ha),this.Ha="");this.dispatchEvent(new Zbc(this.C,a||[],this.Xa))};function Ybc(a,b){return a.Da.od(gW.Ca(),b)}
function Ubc(a,b,c){b=b.clone();fc(Xg,function(a){for(var d=!0;d&&b;){for(var g=bh(a),h=0;h<(g?b.width:b.height);h++){var k=Gh(b,a),l=g?b.bc():b.hc();if(g&&!lJb(c.sf(k,l+h))||!g&&!lJb(c.sf(l+h,k))){d=!1;break}}d&&(eha(b,-1,a),0==b.width||0==b.height)&&(b=null)}return!!b},a);return b}function Tbc(a,b){return Wb(a,b,function(a,b){return zh(a,b)})}
function Xbc(a){var b=a.F.getActiveGrid();if(!b||!a.C||b.fb()!=a.C.vd)return null;for(var c=AC(Bw(a.F)),c=vb(c,Fa(xh,a.C.rect)),c=ub(c,sa),d=vb(c,function(a){return new nh(a.left-this.C.rect.left,a.top-this.C.rect.top,a.width,a.height)},a),b=new rg,e=new rg,g=0;g<d.length;g++){for(var h=0;h<d[g].width;h++)e.add(d[g].left+h);for(h=0;h<d[g].height;h++)b.add(d[g].top+h)}a=Sbc(a,c);return{rows:b.Fd(),Be:e.Fd(),yNa:a}}
function Sbc(a,b){a.F.getActiveGrid();if(0==b.length)return!0;if(1!=b.length)return!1;b=b[0];if(Ah(b)||0==Kh(b))return!0;a=GMa(Bw(a.F).Y,b.top,b.left);return b.equals(a)}function Vbc(a,b){K.call(this,"cu");this.C=a;this.F=b}z(Vbc,K);function Zbc(a,b,c){K.call(this,"ce");this.C=a;this.F=b;this.Y=c}z(Zbc,K);function Wbc(a,b){K.call(this,"cs");this.C=a;this.F=b}z(Wbc,K);function QW(a,b,c,d,e,g){uU.call(this,g);this.Na=a;this.Gb=b.C;this.La=c;this.Wc=d;this.L=e;this.Y=new OW(b,c,d,e,this.oa);this.Ma(this.Y);this.R=new MV(!1,"#4285f4");this.Ma(this.R);this.O=null;this.mb=this.bb=!1;this.Xa=!0;this.Ua=AJ.getInstance();this.ea=this.$="";this.Fc=ap(new $o,10).Fa()}z(QW,uU);q=QW.prototype;q.Sa=function(){QW.Z.Sa.call(this);this.Ba=Tr(this.gua(),{oOb:tm});Ip(this.Ba,"waffle-assistant-sidepanel")};q.gua=v;
q.Ga=function(){QW.Z.Ga.call(this);var a=T(this,"waffle-assistant-quicksum-panel");this.Y.Va(a);a=T(this,"waffle-assistant-spinner-container");this.R.render(a);this.getHandler().V(this,"close-sidebar",this.Tma).V(this.Na,Qbc.wZa,this.Hma).V(this.Na,Qbc.vZa,this.Gma).V(this.Na,Qbc.WWa,this.fma).V(this.Na,Qbc.VWa,this.ema).V(T(this,"waffle-assistant-scroll-pane"),"scroll",C9b(this.J1,10,this));a=X.fH.isEnabled();this.dda(!a)};
q.resize=function(){var a=T(this,"waffle-assistant-sidepane-content"),a=hq(a).height,b=T(this,"waffle-assistant-spinner-container");Pp(b,"margin-top",a/2-16+"px")};q.qh=oa;function $bc(a,b){var c=a.XG();0!=c.length&&(J(a.O),c=c.filter(function(a){return a instanceof pW}),b=c.indexOf(b),0<c.length&&-1!=b&&(a.O=new PW(c,b,a.oa),a.O.render(),H(a,a.O),Kbc(a.O,a.mb)))}
q.dda=function(a){this.mb=a;Mp(this.Ba,"waffle-assistant-readonly",a);var b=this.Y;b.O=a;b.C&&(b.C.J=a);Mp(b.Ba,"waffle-assistant-quicksum-panel-readonly",a);this.O&&!this.O.isDisposed()&&Kbc(this.O,a)};q.setVisible=function(a){var b=this.Ta();QW.Z.setVisible.call(this,a);a&&!b&&(this.ea=BJ(this.Ua,nj.$va),this.R.setActive(!0),RW(this));a||this.$T(!0)};q.Hma=function(){this.Ta()&&(this.$T(!0),this.R.setActive(!0),RW(this))};q.Gma=function(){this.Ta()&&(this.R.setActive(!1),RW(this))};
q.fma=function(a){this.Ta()&&(this.L.Pb(2775,this.Fc),this.$T(void 0,a.C,a.F),this.c$()||this.R.setActive(!0),RW(this),this.Xa=!1)};q.ema=function(a){if(this.Ta()){this.L.Pb(2776,this.Fc);var b=a.F;0<b.length&&(this.$=BJ(this.Ua,nj.Yva));this.$T(!1);this.R.setActive(!1);this.fua(b,a.C);a=a.Y;b=this.XG();0<b.length&&this.bb&&(b[b.length-1].Qb=!0);this.bb=!1;RW(this);this.hua(a);this.J1()}};q.fua=v;q.hua=v;q.$T=v;q.Vja=v;
function RW(a){var b=a.c$(),c=kq(T(a,"waffle-assistant-quicksum-panel")),d=a.R.Ob(),b=b||c||d,c=a.Vja();a=T(a,c);R(a,!b)}q.c$=v;q.J1=v;q.XG=v;q.aHa=Mf;function acc(a){return T(a,"waffle-assistant-scroll-pane").scrollTop+hq(T(a,"waffle-assistant-sidepane-content")).height}q.Ec=oa;q.Id=f("mb");q.Tma=function(){this.L.Pb(2226,this.Fc)};q.hFb=function(){""!=this.$&&(CJ(this.Ua,this.$),this.$="");""!=this.ea&&(CJ(this.Ua,this.ea),this.ea="");this.Xa||(this.L.Pb(2777,this.Fc),this.Xa=!0)};function bcc(a,b,c){a=a||{};c=c||{};b=V;var d=ps(""+ccc()),e;e=c||{};e=V(""+('<div class="waffle-assistant-empty-list-old" style="'+(e.cb?"/*"+e.cb+"*/":"")+'display: none"><img src="//ssl.gstatic.com/docs/spreadsheets/bulbman.svg" /><div aria-live="polite"><div class="waffle-assistant-empty-list-title-old">Nothing interesting here right now</div><div class="waffle-assistant-empty-list-body-old">Try selecting different data. Information with numbers works best.</div></div><a href="https://support.google.com/docs/?p=explore_sheets" target="_blank">Learn more</a><a href="https://docs.google.com/spreadsheets/d/1Hh2grfB6rp9OQ2yAIu3S5YF_CCFJGwyqPGveABlOZKg/copy" target="_blank">Try an example</a></div>'));
return b(U(EU(ms({title:d,Mj:ps('<div class="waffle-assistant-scroll-pane"><div class="waffle-assistant-scroll-pane-content">'+e+'<div class="waffle-assistant-spinner-container"></div><div class="waffle-assistant-quicksum-panel" style="'+(c.cb?"/*"+c.cb+"*/":"")+'display: none"></div><div class="waffle-assistant-card-holder"></div></div></div>'),id:os("autovis"),e1:os("waffle-assistant-title"),tO:os("waffle-assistant-sidepane-content")},a))))}
function dcc(a,b,c){a=a||{};b=V;var d=ps('<div class="waffle-assistant-replaceable-title">'+ccc()+"</div>"),e;e=a||{};c=c||{};var g=V,h=c;e=e||{};h=h||{};h=""+('<div class="waffle-assistant-empty-list" style="'+(h.cb?"/*"+h.cb+"*/":"")+'display: none"><div class="waffle-assistant-empty-list-content" aria-live="polite">'+U(G9b({color:"rgb(46%, 46%, 46%)",iconSize:"40"}))+'<div class="waffle-assistant-empty-list-title">Get insights instantly</div><div class="waffle-assistant-empty-list-body">');h=e.oOb?
h+"To see answers, formatting, and charts in a single click, try adding more data or selecting different cells in your spreadsheet.":h+"To see formatting and charts in a single click, try adding more data or selecting different cells in your spreadsheet.";e=V(h+'</div><div class="waffle-assistant-empty-list-learn-more waffle-assistant-empty-list-link"><span>Learn more</span></div><div class="waffle-assistant-empty-list-link"><a href="https://docs.google.com/spreadsheets/d/1Hh2grfB6rp9OQ2yAIu3S5YF_CCFJGwyqPGveABlOZKg/copy" target="_blank">Try it out</a></div></div></div>');
c=g('<div class="waffle-assistant-scroll-pane"><div class="waffle-assistant-scroll-pane-content"><div class="waffle-assistant-scroll-pane-feature-content">'+e+'<div class="waffle-assistant-spinner-container"></div><div class="waffle-assistant-quicksum-panel" style="'+(c.cb?"/*"+c.cb+"*/":"")+'display: none"></div><div class="waffle-assistant-features"></div></div><div class="waffle-assistant-expanded-panel" style="'+(c.cb?"/*"+c.cb+"*/":"")+'display: none"></div></div></div>');return b(U(EU(ms({title:d,
Mj:ps(""+c),id:os("autovis"),e1:os("waffle-assistant-title"),tO:os("waffle-assistant-sidepane-content")},a))))}function ccc(){return V('<div class="waffle-assistant-title-bar"><div class="waffle-assistant-title-icon">'+U(G9b({color:"#ffffff",iconSize:"21"}))+'</div><div class="waffle-assistant-title-text">'+U("Explore")+"</div></div>")};function SW(a,b,c,d,e,g,h){QW.call(this,a,b,c,d,e,h);this.Za=g;this.Qb=b;this.X=new Bq(this.oa);this.Ma(this.X);this.J=new Ebc;H(this,this.J);this.D=[];this.F=null;this.Da=new xt("",h,4);xr(this.Da,2);this.Ma(this.Da)}z(SW,QW);
var TW={rz:"waffle-assistant-scroll-pane-feature-content",gYa:"waffle-assistant-empty-list",wYa:"waffle-assistant-features",oZa:"waffle-assistant-empty-list-learn-more",sea:"waffle-assistant-expanded-panel",G_a:"waffle-assistant-replaceable-title",$kc:"waffle-assistant-scroll-pane",zN:"waffle-assistant-title"},ecc={defaultHelpArticleId:"6280499"};q=SW.prototype;q.gua=function(){return dcc};q.Vja=n("waffle-assistant-empty-list");
q.Ga=function(){SW.Z.Ga.call(this);this.X.Va(T(this,TW.sea));VV(this.C.Ba,"Close");var a=this.Qb.O.Jr();tm&&"en"==kD(a)&&(a=new IW(this.Za,this.La,this.Gb,this.Wc,this.L,this.J,this.oa),this.Ma(a),this.D.push(a));if(Boa||Coa)a=new Dbc(this.L,this.J,this.oa),this.Ma(a),this.D.push(a);a=new sW(this.Gb,this.La,this.L,this.J,this.oa);this.Ma(a);this.D.push(a);var b=T(this,TW.wYa);A(this.D,function(a){a.render(b);this.X.Ma(a.D,!0)},this);this.Da.Va(T(this,TW.oZa));this.getHandler().V(this.Da,"action",
this.qWb);fcc(this)};q.qWb=function(){Q.$l.Ub(ecc)};q.fua=function(a,b){for(var c=0;c<this.D.length;c++){for(var d=[],e=0;e<a.length;e++){var g=Gc(a[e],1);this.D[c].r4(g)&&d.push(a[e])}0<d.length&&this.D[c].cua(d,b)}};q.hua=function(){A(this.D,function(a){P9b(a)})};q.$T=function(a,b,c){A(this.D,function(d){d.G1(a,b,c)})};q.c$=function(){return!!zb(this.D,function(a){return a.ena()})};
q.J1=function(){var a=acc(this);A(this.D,function(b){this.F&&this.F!=b||(b instanceof sW&&Gf(this.getHandler(),b,"assistant-done-rendering",this.hFb),a=b.eua(a))},this)};q.XG=function(){if(this.F)return this.F.D.D;var a=[];A(this.D,function(b){Pb(a,O9b(b))});return a};q.dda=function(a){SW.Z.dda.call(this,a);fcc(this)};q.qh=function(a){A(this.D,function(b){b.qh(a)})};
q.Ec=function(){var a=T(this,TW.rz),b=T(this,TW.G_a),c=T(this,TW.zN),d=this.X.Ba;if(this.F)this.F.D.setVisible(!1),this.F.setActive(!1),this.F=null,R(a,!0),R(d,!1),Rr(b,ccc),Bp(b,"label"),this.resize();else if(this.F=zb(this.D,function(a){return a.Ob()}))R(a,!1),R(d,!0),this.F.D.setVisible(!0),Q9b(this.F,b),Fp(b,this.F.ZT());gq(c,hq(b).height);gl(function(){var a=ew;a&&a.dispatchEvent("resize");this.J1()},150,this)};
q.setVisible=function(a){var b=this.Ta();SW.Z.setVisible.call(this,a);a&&!b&&gcc(this,!0);a||this.J.clear()};q.Tma=function(){SW.Z.Tma.call(this);this.F&&this.Ec()};q.Hma=function(){SW.Z.Hma.call(this);gcc(this,!0)};q.Gma=function(){SW.Z.Gma.call(this);gcc(this,!1)};q.fma=function(a){SW.Z.fma.call(this,a);gcc(this,!0,a.C)};q.ema=function(a){SW.Z.ema.call(this,a);gcc(this,!1)};function fcc(a){A(a.D,function(a){a.I1(this.Id())},a)}q.aHa=f("D");function gcc(a,b,c){A(a.D,function(a){c||K9b(a.D,b)})};function hcc(a){var b;a=a||{};return V('<div class="docs-explore-promo-base '+W(a.Wf)+'"><div class="docs-explore-promo-content">'+(a.gF?'<div class="docs-explore-promo-header">'+U(null==(b=a.gF)?"":b)+"</div>":"")+'<div class="docs-explore-promo-description">'+U(null==(b=a.UW)?"":b)+'<div class="docs-explore-promo-buttons">'+(a.zI?U(wt({Oe:"docs-explore-promo-button docs-explore-promo-continue-button",content:ps(""+U(a.zI)),style:4})):"")+(a.QI?U(wt({Oe:"docs-explore-promo-button docs-explore-promo-close-button",
content:ps(""+U(a.QI)),style:4})):"")+"</div></div></div>"+(a.FMa?V('<div class="docs-explore-promo-icon-wrapper"><div class="docs-explore-promo-icon">'+U(G9b({color:a.FMa,iconSize:"32"}))+"</div></div>"):"")+"</div>")};function icc(a,b){Bq.call(this,b);this.F=new xt("",b);this.Ma(this.F);this.C=new xt("",b);this.Ma(this.C);this.D=new xt("",b);xr(this.D,2);this.Ma(this.D);this.J=a;Nqa([Q.Hda,Q.Ida,Q.Xva],!0)}z(icc,Bq);q=icc.prototype;q.Sa=function(){this.Ba=Tr(hcc,this.J)};
q.Ga=function(){icc.Z.Ga.call(this);var a=T(this,"docs-explore-promo-continue-button");a&&this.F.Va(a);(a=T(this,"docs-explore-promo-close-button"))&&this.C.Va(a);(a=T(this,"docs-explore-promo-icon"))&&this.D.Va(a);this.getHandler().V(this.F,"action",this.oJa).V(this.C,"action",this.r6a).V(this.D,"action",this.Lpb)};q.show=function(a){Q.Xva.Ub();this.render(a)};q.oJa=function(a){Q.Hda.Ub();a.stopPropagation()};q.r6a=function(a){Q.Ida.Ub();a.stopPropagation()};q.Lpb=function(a){this.oJa(a)};function jcc(a){return V('<div class="waffle-assistant-walkthrough-promo-content"><h1 class="waffle-assistant-walkthrough-promo-header">'+U(a.gF)+'</h1><p class="waffle-assistant-walkthrough-promo-description">'+U(a.UW)+"</p>"+(a.zI?U(wt({Oe:"waffle-assistant-walkthrough-promo-button waffle-assistant-walkthrough-promo-continue-button",content:ps(""+U(a.zI)),style:4})):"")+(a.QI?U(wt({Oe:"waffle-assistant-walkthrough-promo-button waffle-assistant-walkthrough-promo-close-button",content:ps(""+U(a.QI)),
style:4})):"")+"</div>")};function UW(a,b,c){bF.call(this,a,c);this.O=new xt("",c);this.C=new xt("",c);a=Tr(jcc,b);this.setContent(a);this.Fg("docs-promo-bubble");this.setPosition(0,0);this.F.Cy=!0;Nq(this.D,!1);this.vv=!1}z(UW,bF);UW.prototype.Ga=function(){UW.Z.Ga.call(this);var a=T(this,"waffle-assistant-walkthrough-promo-continue-button");a&&this.O.Va(a);(a=T(this,"waffle-assistant-walkthrough-promo-close-button"))&&this.C.Va(a);this.getHandler().V(this.O,"action",this.J).V(this.C,"action",this.R)};
UW.prototype.J=function(a){this.dispatchEvent("promo-continue");a.stopPropagation()};UW.prototype.R=function(a){this.dispatchEvent("promo-dismiss");a.stopPropagation()};function kcc(a){var b=Um("waffle-assistant-chart-preview",void 0);UW.call(this,b,{gF:"See the big picture",UW:"Data visualizations and text summaries make it easier to spot trends and outliers",zI:"Learn more",QI:"Got it"},a)}z(kcc,UW);var lcc={defaultHelpArticleId:"6280499"};kcc.prototype.J=function(a){Q.$l.Ub(lcc);kcc.Z.J.call(this,a)};function mcc(a,b){var c=Um("waffle-assistant-answers-input",void 0),d;d=new fw;a="Interested in the "+(d.Dm("b")+(a+(d.Om("b")+"? Ask a question about your data to learn more, no formulas needed.")));d={gF:"Find answers in a snap",UW:d.format(a),zI:"Next",QI:"Dismiss"};UW.call(this,c,d,b)}z(mcc,UW);function ncc(a,b){a={Wf:"waffle-assistant-entry-promo",gF:"Get insights instantly",UW:tm&&"en"==kD(a)?"Find answers to questions about your data, apply formatting, and create charts in a single click using Sheets Explore":"Apply formatting and create charts over your data in a single click using Sheets Explore",zI:"Check it out",QI:"Dismiss",FMa:"#0F9D58"};icc.call(this,a,b)}z(ncc,icc);function occ(a){var b=Um("waffle-assistant-banding-color-picker-container",void 0);UW.call(this,b,{gF:"Make it pop",UW:"Quickly apply alternating row color formatting to add style, polish, and visual appeal",zI:"Next",QI:"Dismiss"},a)}z(occ,UW);function pcc(a,b,c,d,e,g,h,k,l){AU.call(this,b,h);this.Ka=a;this.C=b;this.X=c;this.Ha=d;this.Ua=e;this.Y=g;this.Pa=k;this.R=c.C;this.Da=this.va=!1;this.J=l;this.D=null;this.xb=new Li;this.O=null;a=zw(this.Ua);this.qa.V(this.Ha,"selectionChange",this.tWb).V(this.R,"Sa",this.sWb).V(a,"kb",this.Dsb).V(this.C,"assistant-sidepane-apply-conditional-format-rules",this.dib).V(this.C,"assistant-sidepane-apply-banding",this.cib).V(this.C,"assistant-sidepane-remove-banding",this.Bwb).V(this.C,"assistant-sidepane-change-selection",
this.ujb).V(this.C,"assistant-sidepane-insert-chart",this.uqb).V(this.C,"assistant-sidepane-thumbs",this.qzb).V(this.C,"assistant-sidepane-set-active-panel",this.lyb).V(this.C,"assistant-sidepane-back-button-clicked",this.zib).V(this.C,"assistant-undo-pressed",this.uWb).V(this.Ka,"cu",this.Nkb);Yo(this.L,X.fH,jo,this.xqb).subscribe(X.hU,"action",this.wib).subscribe(X.V1,"action",this.dzb).subscribe(X.mda,"action",this.Zyb);X.U1.Qa(!0);this.Fc=ap(new $o,10).Fa();this.La=AJ.getInstance();this.ea=BJ(this.La,
nj.Wva);gl(Fa(this.tW,!1),100,this)}z(pcc,AU);q=pcc.prototype;q.Gh=function(){return X.oda};q.Xs=function(){return X.pda};q.vs=function(a){pcc.Z.vs.call(this,a);X.V1.Qa(a);this.tW(!1);!this.va&&a&&(this.va=!0,Hoa&&BK(this.Pa,"ritz-DisplayExploreV2Promo",!1))};q.qh=function(a){this.C.qh(a);this.Ka.qh(a)};q.wib=function(){var a=this.C.Ta();this.Gh().setVisible(!a);a?this.J.Pb(2226,this.Fc):(this.C.focus(),this.J.Pb(2253,this.Fc))};q.Zyb=function(){this.C.Ta()||this.vs(!0)};
q.dzb=function(a){$bc(this.C,a)};q.tWb=function(){this.tW(!0);this.D&&(J(this.D),this.D=null)};q.tW=function(a,b){if(b){if(!b.length)return;if(1==b.length&&this.O&&b[0].equals(this.O)){this.O=null;return}}var c=this.C;c.Ta()&&(Gbc(c.Y),RW(c));this.Ka.update(!a,this.C.Ta(),b)};
q.Nkb=function(a){""!=this.ea&&(CJ(this.La,this.ea),this.ea="");var b=a.F||0;a=a.C;var c=!!a&&a.rect,d=(c=!!c&&50<=Kh(c)&&5<=Fh(c,"r")&&3<=Fh(c,"c")&&5E4>=Kh(c))&&.6<=b;d!==this.Da&&(this.Da=d,X.U1.Ub(d));if(c){if(a&&a.rect){var d=.9<=b,e=1E3>=Kh(a.rect),c=ritz.isFormsRegion(""+a.vd,a.rect.top,a.rect.left,a.rect.height+a.rect.top,a.rect.width+a.rect.left),d=xoa&&!this.C.Ta()&&!this.va&&d&&e&&!kx(this.X),c=yoa&&c,e=zoa&&this.X.Id();d&&(c||e)?(d=new z9b,P(d,1,b),P(d,2,c),P(d,3,e),c=new no,gj(c,58,d),
this.AAa(new Zo(10,c)),c=!0):c=!1}else c=!1;if(c=!c)if(c=Hoa){if(b=.6<=b&&!this.C.Ta()&&!this.va&&!this.D&&this.Pa.C["ritz-DisplayExploreV2Promo"].Ia()&&a)b=a.rect,b=ritz.hasBandingSuggestions(a.vd+"",b.hc(),b.Uc(),b.bc(),b.bd());c=b}c&&(a=this.X.O.Jr(),this.D=new ncc(a),H(this,this.D),this.D.show(),this.L.subscribe(Q.Hda,"action",this.Enb).subscribe(Q.Ida,"action",this.Nma),BK(this.Pa,"ritz-DisplayExploreV2Promo",!1),this.J.Pb(2788,this.Fc))}};
q.AAa=function(a){this.C.bb=!0;var b=oOa(Bw(this.R));yKb.C||b||(a=a||this.Fc,this.Gh().setVisible(!0),this.J.Pb(2225,a),gl(Fa(this.l3a,a),5E3,this))};q.l3a=function(a){this.C.Ta()||this.J.Pb(2752,a)};q.Nma=function(){J(this.D);this.D=null};
q.Enb=function(){J(this.D);this.vs(!0);Gf(this.qa,this.C,"assistant-done-rendering",y(function(){var a;a:{this.C.Ta();a=this.X.O.Jr();a=tm&&"en"==kD(a);for(var b=!1,c=!1,d=!1,e=this.C.XG(),g=0;g<e.length;g++)if(e[g]instanceof xW?b=!0:e[g]instanceof JW?c=!0:e[g]instanceof pW&&(d=!0),c&&d&&(b||!a)){a=!0;break a}a=!1}a?this.VKa():this.Nma()},this))};
q.VKa=function(){this.C.Ta();J(this.D);var a=null;this.D instanceof ncc?(a=this.X.O.Jr(),tm&&"en"==kD(a)?(a=this.C.aHa(),a=kbc(zb(a,function(a){return a instanceof IW}).L).toLowerCase(),a=new mcc(a)):a=new occ):this.D instanceof mcc?a=new occ:this.D instanceof occ&&(a=new kcc);if(this.D=a)H(this,this.D),this.D.render(),Gf(Gf(this.qa,this.D,"promo-dismiss",this.Nma),this.D,"promo-continue",this.VKa)};q.zib=function(){this.C.Ec()};
q.uWb=function(a){var b=a.C,c=b.D.wJ(),d=parseInt(c.fb(),10);this.O=Rh(c);this.Y.C(new rLb(d));Abc(b,c);this.J.Pb(a.Ej(),this.Fc)};q.sWb=function(){Aw(this.R)?(this.C.Qa(!0),this.tW(!1)):(this.Gh().setVisible(!1),this.C.Qa(!1))};q.xqb=function(){this.C.dda(!X.fH.isEnabled())};q.Dsb=function(a){this.tW(!1,a.C?a.C:a.rect?[a.rect]:[])};
q.dib=function(a){var b=Bw(this.R),c=""+b.mc(),d=[],e=n5b(b);if(e){var b=new Ze,g=Gc(e,2);F(b,3,g);g=Gc(e,2);F(b,2,g);e=Gc(e,1);F(b,1,e);d.push(b)}b=a.C.mb;for(e=0;e<b.length;e++)g=new Ze,F(g,2,b[e]),d.push(g);this.Y.C(new FU(d,c));a=a.Ej();this.J.Pb(a,this.Fc)};
q.cib=function(a){var b=a.C,c=a6b(b.C),d=b.D.wJ(),e=c.Lt?c.uw:null,g=c.C?c.aw:null,h=parseInt(d.fb(),10),k=qcc(d);this.O=Rh(d);k?this.Y.C(new zU(k,h,this.O,e,c.Dr,c.us,g)):this.Y.C(new xU(h,this.O,e,c.Dr,c.us,g));d=new A5b;P(d,1,1);c=new TT;b=b.D.TS();P(c,2,b);gj(c,5,d);b=new no;gj(b,46,c);b=new Zo(10,b);a=a.Ej();this.J.Pb(a,b)};q.Bwb=function(a){a=a.C;var b=a.D.wJ(),c=parseInt(b.fb(),10),d=qcc(b);this.O=Rh(b);this.Y.C(new yU(d,c));Abc(a,b)};
function qcc(a){var b=a.fb();a=Rh(a);b=ritz.getWorkbookRangeIntersectingIds(b,a.hc(),a.bc(),a.Uc(),a.bd(),7,!1);return 0<b.length?b[0]:null}q.ujb=function(a){JC(Bw(this.R),a.F);a=a.Ej();this.J.Pb(a,this.Fc)};
q.qzb=function(a){var b=a.C;a=a.Ej();if(b instanceof vW||b instanceof xW)this.J.Pb(a,this.Fc);else{var c=this.C.XG(),d=new TT,e=b.D.TS(),c=c.indexOf(b);P(d,1,c);P(d,2,e);e=new no;gj(e,46,d);if(b instanceof pW){(d=b.L)?(b=rcc(this,b,d),b=M8b(b,d,d.Sg)):b=null;if(!b)return;gj(e,39,b)}else if(b instanceof rW){var g=b.D,c=new B9b;if(b instanceof rW)b=1;else throw Error("Unknown text analysis card type.");g=Fc(g.getAutovisRecommendation(),20).slice(0,10);P(c,2,g||[]);P(c,1,b);gj(d,3,c)}this.J.Pb(a,new Zo(10,
e))}};q.lyb=function(){this.C.Ec()};
q.uqb=function(a){var b=a.Y;if(b){var c=Bw(this.R),d=a.Ve();d||(d=kA(this.Ha).ud().C.Ve());var e=16,g=16,h=a.xb;h&&(e=h.x,g=h.y);c={oid:null,ar:QC(c,d.y),ac:RC(c,d.x),x:e,y:g,h:MGa.height,w:MGa.width,p:{context:{chartName:"Chart "+(scc(this)+1)}}};d=new SH(vw(this.R)||0,c,!1,!1);c=b.Sg;e=new Il(c);g=Ul(e,"headers");g=null!=g&&ya(g)&&Ua(g)?parseInt(g,10):-1;d.Pa=g;d.va=0;g="1"==Ul(e,"transpose");d.Ka=g;d.O=g?"ROWS":"COLS";g=Ul(e,"range");g=r5b(q5b(g,","),this.R);d.fT(g);x4b(d,b);if(e=Ul(e,"dt"))e=
this.xb.od(ff.Ca(),JSON.parse(decodeURIComponent(e))),d.R=encodeURIComponent(JSON.stringify(d.Ua.serialize(e)));this.Ha.dispatchEvent(new UE("objectRequest"));this.Y.C(new NE(this.X,d));e=tcc(this,b,a.$,a.Se());d=this.J;a=a.Ej();b=M8b(e,b,c);c=new no;gj(c,39,b);d.Pb(a,new Zo(10,c))}};function rcc(a,b,c){var d=a.C.XG().filter(function(a){return a instanceof pW});return tcc(a,c,d.indexOf(b),b.L&&b.L.Se())}
function tcc(a,b,c,d){var e=new O8b;a=a.C.XG().filter(function(a){return a instanceof pW}).map(function(a){return a.getChartType()});e.R=a;e.F=c;P8b(e,b.getChartType());e.D=d?d.clone():null;return e}function scc(a){var b=0;kG(a.X.J,function(a){6==a.getType()&&b++});return b};function ucc(a,b){nW.call(this,a,b)}z(ucc,nW);q=ucc.prototype;q.mz=function(a){a()};q.cz=oa;q.Wx=n("assistantPivotTableFeedback");q.pE=n(2632);q.oE=n(2631);function vcc(a,b,c,d,e,g,h){QW.call(this,a,b,c,d,e,h);this.J=new Bq(this.oa);this.Ma(this.J);this.F=null;this.Da=new M;H(this,this.Da);this.D=[];this.Za=null;this.X=!0}z(vcc,QW);var wcc={YWa:"waffle-assistant-card-holder",rz:"waffle-assistant-sidepane-content",aYa:"waffle-assistant-dragger-card",$Xa:"waffle-assistant-dragged-card",gYa:"waffle-assistant-empty-list-old",VISIBLE:"waffle-assistant-visible"};q=vcc.prototype;q.gua=function(){return bcc};q.Vja=n("waffle-assistant-empty-list-old");
q.Ga=function(){vcc.Z.Ga.call(this);var a=T(this,wcc.YWa);this.J.Va(a)};q.setVisible=function(a){var b=this.Ta();vcc.Z.setVisible.call(this,a);a&&!b&&(this.X=!0)};
q.fua=function(a){for(var b=0;b<a.length;b++){var c=a[b],d=D(c,1),e=null;switch(d){case 0:"WordCloud"==c.getAutovisRecommendation().getChartType()?e=new rW(c,this.oa):e=new pW(c,this.Gb,this.La,this.L,null,this.oa);break;case 1:e=new ucc(c,this.oa);break;case 2:e=new KW(c,this.oa);break;case 4:e=new JW(c,this.L,this.oa);break;default:throw Error("Unsupported recommendation type: "+d);}c=this.J.qd();e.Y=c;this.J.Ma(e,!0);if(X.fH.isEnabled()){if(!this.F||this.F.isDisposed())this.F=new xcc,c6b(this.F,
this.J.Ba),this.F.X=10,this.F.R=Wa(wcc.aYa).split(" "),this.F.ea=!0,this.F.xra(wcc.VISIBLE),this.F.L=!1,this.F.We(),this.Da.V(this.F,"beforedragstart",y(this.vWb,this)).V(this.F,"dragstart",y(this.wWb,this)).V(this.F,"beforedragend",y(this.Jib,this));var c=this.F,d=this.J.Ba,g=e.Ba;u(void 0)?upa(d,g,void 0):d.appendChild(g);d6b(c,g)}0!=this.D.length&&e.getHandler().V(this.D[this.D.length-1],"content-rendered",e.HO);this.D.push(e)}};
q.hua=function(a){0<this.D.length&&this.D[0].HO();if(a||this.X)this.X=!1,ycc(this)};function ycc(a){if(0!=a.D.length){for(var b=0,c=0;c<a.D.length;c++){var d=a.D[c].Ba;Vp(d,0,1E3);b+=hq(d).height}b=Math.max(hq(T(a,"waffle-assistant-sidepane-content")).height,b);gq(a.J.Ba,b);for(c=0;c<a.D.length;c++)gl(Fa(a.O1a,a.D[c]),100*c,a);gl(function(){gq(this.J.Ba,"auto")},100*a.D.length,a)}}q.O1a=function(a){!a.isDisposed()&&this.isEnabled()&&(new kU(a.Ba,[0,1E3],[0,0],100)).play()};
q.$T=function(){this.Da.Ic();J(this.F);for(var a=0;a<this.D.length;a++){var b=this.D[a];b.rc()&&this.J.removeChild(b,!0);J(b)}this.D=[]};q.c$=function(){return 0<this.D.length};q.J1=function(){for(var a=acc(this),b=0,c=0;c<this.D.length;c++)b<a?(XV(this.D[c],!0),b+=hq(this.D[c].Ba).height):XV(this.D[c],!1)};q.vWb=function(a){var b=sb(this.J.Ba.childNodes,a.C),b=this.J.Ad(b);b.oNa()?this.Za=b:a.preventDefault()};q.wWb=function(a){Ip(a.F,wcc.$Xa)};
q.Jib=function(a){var b=Wp(a.F),c=kA(this.La).C;if(ph(xE(c,"page",!1,!1)).contains(b)){var d=vE(c,b.x,b.y,"page"),c=zE(c,vh(d),"page");this.Za.T8(d,new N(b.x-c.left,b.y-c.top))}a.Y.ow(null,!0);a.preventDefault();this.Za=null};q.XG=f("D");function xcc(){GU.call(this)}z(xcc,GU);xcc.prototype.Yka=function(a){a=xcc.Z.Yka.call(this,a);var b=vb(a.querySelectorAll("clippath"),function(a){return a.id});zcc(a,b);return a};
function zcc(a,b){for(var c=a.getAttribute&&a.getAttribute("clip-path"),d=0;d<b.length;d++){var e=b[d];ya(c)&&cb(c,e)&&a.setAttribute("clip-path",c.replace(e,e+"-clone"));e==a.id&&(a.id=e+"-clone")}a=kn(a);for(d=0;d<a.length;d++)zcc(a[d],b)};function Acc(){G.call(this)}z(Acc,On);Acc.prototype.C=function(){return Pbc};Acc.prototype.F=function(){return Boa||Coa||tm?SW:vcc};Acc.prototype.D=function(){return pcc};Wn("assistant",Acc);
