chrome.runtime.onMessage.addListener(function(a,b,c){if(a.sendContentToPhone)_a8a38423d35d5e919c78ba5ae1d5f1dfd8164cb7(a.action_data),c({confirmation:'{"requestToSendImg":"true"}'});else if(a.pushThisPageToPhone)c({message_received_to_push_to_phone:!0}),_1ee7c81a6ce8321134253f87b43e9f5b19202d88("sendToPhone");else if(a.launchMT)c({launching_MT:!0}),_9c919ed7c3296451894bd5cfb3ed464be379768c();else if(a.openComposeNew)c({opening_compose_new:!0}),_1ee7c81a6ce8321134253f87b43e9f5b19202d88("composeNew");
else if(a.sendLinkViaSMS)c({sending_link_via_sms:!0}),_1ee7c81a6ce8321134253f87b43e9f5b19202d88("sendMessage");else if(a.requestPhoneStatusNotCollapsed)b="check-phone-status-not-needed",a.hasOwnProperty("high_priority_gcm")&&(b="gcm_priority_high"),_a0419897fdd53067666b8229e0b075f897d959ca("get_phone_status&collapse_key=false",b),c({requesting_phone_status:!0});else if(a.openComposeNewInNewTab)c({opening_compose_new_in_new_tab:!0}),_197c67f142e8ffbbda3922ac55df9fef57502114();else if(a.getInfoForAdditionalNotif)c({global_device_notif:deviceNotifManagerArray[a.globalDeviceKey],
user_email:google_username_currently_logged_in}),delete deviceNotifManagerArray[a.globalDeviceKey];else if(a.getPathToLatestCutOfWebApp)c({path_to_latest_webapp:void 0!=currentProductionPath?currentProductionPath:"error_loading_external_js_file_from_MT"});else if(a.sendImageViaMMS)c({sending_image_via_mms:!0}),_1ee7c81a6ce8321134253f87b43e9f5b19202d88("sendMessage",a.imgToSendSrc);else if(a.GAEventInfo)c({confirmation:"Recorded GA Event!"}),_gaq.push(["_trackEvent",a.GAEventInfo.category,a.GAEventInfo.action,
a.GAEventInfo.label]);else if(a.KMEventInfo)c({confirmation:"Recorded KM Event!"}),_kmq.push(["record",a.KMEventInfo.event,a.KMEventInfo.properties]);else if(a.hasOwnProperty("intercomEventInfo")){var d=a.intercomEventInfo;d.hasOwnProperty("event")?(a=d.event,b={},d.hasOwnProperty("properties")&&(b=d.properties),d={confirmation:"Recorded Intercom Event!"},Intercom("trackEvent",a,b)):d={error:'Missing "event" parameter'};c(d)}else a.hasOwnProperty("get_phone_contacts")&&c({contacts:contactsFromPhoneGlobal})});
function _ba256ebb91e7ecec954d6c672bb1ed9401020207(){chrome.contextMenus.removeAll(function(){chrome.contextMenus.create({id:"context-menu-handle-image",title:chrome.i18n.getMessage("send_img_with_mt"),type:"normal",contexts:["image"],onclick:function(a,b){_80f8b0e51da82a9a1354a5d75eded5fa896070b3(a,b,"image")}},function(){});chrome.contextMenus.create({id:"context-menu-handle-page",title:chrome.i18n.getMessage("send_page_with_mt"),type:"normal",onclick:function(a,b){_80f8b0e51da82a9a1354a5d75eded5fa896070b3(a,
b,"link")}},function(){});chrome.contextMenus.create({id:"context-menu-handle-selection",title:chrome.i18n.getMessage("send_selection_with_mt"),type:"normal",contexts:["selection"],onclick:function(a,b){_80f8b0e51da82a9a1354a5d75eded5fa896070b3(a,b,"selection")}},function(){})})}
function _80f8b0e51da82a9a1354a5d75eded5fa896070b3(a,b,c,d,e){console.log("inside of handle click because of: "+c);var f={info:a,tab:b,context:c};console.log(f);if(void 0!=a.frameUrl&&-1<String(a.frameUrl).indexOf("mightytext.net"))return!1;chrome.tabs.sendMessage(b.id,{webToPhoneJSTestMessage:!0},function(a){console.log(a);a&&a.content_script_exists?(console.log(a),_3f13653fe035659cba05430a5b634fccf097048e(f,b.id,d,e)):(chrome.tabs.insertCSS(b.id,{file:"styles/font-awesome-4.2.0/css/font-awesome.css"},
function(){console.log("inserted font-awesome");chrome.tabs.insertCSS(b.id,{file:"styles/animate.css"},function(){console.log("inserted animated.css");chrome.tabs.insertCSS(b.id,{file:"styles/bootstrap-alert-css-only/css/bootstrap-custom.css"},function(){console.log("inserted bootstrap-custom.css");chrome.tabs.insertCSS(b.id,{file:"styles/web_to_phone.css"},function(){console.log("inserted web_to_phone.css")})})})}),chrome.tabs.executeScript(b.id,{file:"scripts/libs/jquery-2.1.0.min.js"},function(){console.log("executed jquery");
chrome.tabs.executeScript(b.id,{file:"scripts/libs/bootstrap-growl-master/bootstrap-growl.min.js"},function(){console.log("inserted bootstrap growl library");chrome.tabs.executeScript(b.id,{file:"scripts/libs/jQuery.dotdotdot-1.6.14/src/js/jquery.dotdotdot.min.js"},function(){console.log("inserted dotdotdot library");chrome.tabs.executeScript(b.id,{file:"scripts/common.js"},function(){console.log("inserted common.js");chrome.tabs.executeScript(b.id,{file:"scripts/web_to_phone.js"},function(){console.log("executed web_to_phone.js");
"link"!=c&&"selection"!=c||"composeNew"==e?_84bdac4953b8d82ae6024ec4c2fdd469747b5ddb(f,b.id,d,e):_3f13653fe035659cba05430a5b634fccf097048e(f,b.id,d,e)})})})})}))});void 0==e&&(_kmq.push(["record","Context-Menu-Invoke",{"Content-Type":c,Client:"CRX"}]),_gaq.push(["_trackEvent","CRX","Context-Menu-Invoke",c]))}
function _84bdac4953b8d82ae6024ec4c2fdd469747b5ddb(a,b,c,d){console.log("inside of sendclickinfotocontentscript");var e={},e=1==c?{contextMenuInfo:a,bypassOptionsModal:!0,task:d}:{contextMenuInfo:a};console.log({tabid:b,message:e});chrome.tabs.sendMessage(b,e,function(a){console.log(a)})}
function _a8a38423d35d5e919c78ba5ae1d5f1dfd8164cb7(a){console.log(a);if("image"==a.context)body=" ",action="fetch_binary_from_url_store_on_device",action_data=body+"||"+a.info.srcUrl;else if("link"==a.context){var b=_855a19b21ec568fa8351b9822e40b31473bb429c(a.tab.title),c=_855a19b21ec568fa8351b9822e40b31473bb429c(a.info.pageUrl);action="launch_from_url";action_data=c+"|||"+b}else"selection"==a.context&&(action="send_snippet_to_phone",action_data=a.info.selectionText);encoded_action_data=encodeURIComponent(action_data);
_a0419897fdd53067666b8229e0b075f897d959ca(action,encoded_action_data,null,a.tab.id)}function tellCSToOpenWidget(a){a={context:"link",info:{pageUrl:a.url},tab:{title:a.title,id:a.id}};_80f8b0e51da82a9a1354a5d75eded5fa896070b3(a.info,a.tab,"link")}function _2741e107cd109c21e5e04a53a8e4939ed59e418f(a,b){chrome.tabs.sendMessage(a,{sendC2DMStatus:!0,response_status:b},function(a){console.log(a)})}
function _3f13653fe035659cba05430a5b634fccf097048e(a,b,c,d){var e=encodeURIComponent(a.info.pageUrl);$.ajax({type:"GET",url:"https://mightytext.net/prod-assets/bitly/shorten-link.php?url="+e,dataType:"text",success:function(f,e,g){f=f.replace(/\\"/g,'"');f=JSON.parse(f);console.log(f);f=void 0!=f.data.url?f.data.url.replace("http://",""):a.info.pageUrl;a.info.shortUrl=f;console.log(a);_84bdac4953b8d82ae6024ec4c2fdd469747b5ddb(a,b,c,d)},error:function(e,h,g){_439fc287471807456f79b1fd2d9ee4f7a7e1e6fc("Error in C2DM: "+
g,"red");_439fc287471807456f79b1fd2d9ee4f7a7e1e6fc("Error details: "+g.error,"red");a.info.shortUrl=a.info.pageUrl;_84bdac4953b8d82ae6024ec4c2fdd469747b5ddb(a,b,c,d)}})}function _1ee7c81a6ce8321134253f87b43e9f5b19202d88(a,b){chrome.tabs.query({currentWindow:!0,active:!0},function(c){c=c[0];var d,e={editable:!1,menuItemId:"context-menu-handle-page",pageUrl:c.url};void 0!=b?(d="image",e.srcUrl=b):d="link";_80f8b0e51da82a9a1354a5d75eded5fa896070b3(e,c,d,!0,a)})}
function _197c67f142e8ffbbda3922ac55df9fef57502114(){chrome.tabs.create({url:"https://mightytext.net/"+currentProductionPath+"#mode=compose-new"},function(){console.log("new tab with webapp in compose new mode created")})};