'use strict';window.navigator.userAgent.match(/Chrome\/([0-9]+)/);var Ai=function(a,b){this.type=a;this.entryPoint=b};m("castApp.frontEnd.ExtensionMessage",Ai,void 0);var Bi=function(a){return"urn:x-cast:com.google.cast."+a},Ci=Bi("tp.connection"),Di=Bi("receiver"),Ei=Bi("media"),Fi=Bi("webrtc"),Gi=Rb({Wfa:Ci,Xfa:Bi("tp.heartbeat"),pfa:Di,MN:Ei,sea:Bi("media.universalRemote.optIn"),oga:Fi});var Hi=function(a){return"available"==a||"available_rescan"==a};var Ii=function(a,b,c,e,f){this.id=a;this.friendlyName=b;this.iconType=c||"generic";this.description=e||null;this.domain=f||null;this.isLaunching_=!1};var Ji=function(a,b){this.qc=this.sf=this.wg=this.ub=this.qa=null;this.Hd=new Ii(Pf.M().Hm(b),a);this.bf={};this.pp={};this.Ol=!1};d=Ji.prototype;d.Bg=function(){return this.Hd};d.Qm=function(){return this.Hd.friendlyName};d.V8=function(a){this.qc=a;return this};d.getId=function(){return this.Hd.id};d.Es=function(a){this.Hd.id=a;return this};d.FL=function(a){this.Ol=a;return this};
d.update=function(a){if(this.getId()!=a.getId())return!1;var b=!1;this.Hd.friendlyName!=a.Hd.friendlyName&&(this.Hd.friendlyName=a.Hd.friendlyName,b=!0);this.wg!=a.wg&&(this.wg=a.wg,b=!0);this.sf!=a.sf&&(this.sf=a.sf,b=!0);this.qa!=a.qa&&(this.qa=a.qa,b=!0);this.ub!=a.ub&&(this.ub=a.ub,b=!0);return b};d.t8=function(a){this.qa=a;return this};d.Eb=function(){return this.ub};d.El=function(a){this.ub=a;return this};d.O7=function(a){this.wg=a;return this};d.K7=function(a){this.sf=a;return this};
d.ae=function(a){return this.bf[a]||"unknown"};d.mT=function(a){return this.pp[a]||null};d.ro=function(a,b){this.bf[a]=b;this.pp[a]=u();return this};d.nM=function(){return"name = "+this.Hd.friendlyName+(this.qa?", ip = "+this.qa:"")+(this.qc?", model = "+this.qc:"")+", apps = "+JSON.stringify(this.bf)};var Ki=function(a){var b=new Ji(a.Hd.friendlyName,"");b.Hd.id=a.Hd.id;b.qa=a.qa;b.ub=a.ub;b.wg=a.wg;b.sf=a.sf;b.qc=a.qc;b.bf=a.bf;b.pp=a.pp;b.Ol=a.Ol;return b};var Mi=function(a,b,c,e,f,g){this.re=new Ii(Li(a),b,this.kF(e));this.qc=c||null;this.qd=e||null;this.qa=f||null;this.ub=g||null;this.bf={};this.Am=!1},Li=function(a){return Pf.M().Hm(a)},Ni=function(a){if(!a.qc)return null;var b=a.qc;if(!a.qa)return null;var c=a.qa,e=a.Bg().id,f;f=a.Bg().friendlyName;f=-1!=f.indexOf("&")?"document"in h?Ra(f):Sa(f):f;b=new Mi(e,f,b,void 0,c,Pf.M().Gj||8009);b.re.id=a.Bg().id;b.AK(!0);return b};d=Mi.prototype;
d.update=function(a,b,c,e){var f=!1;this.re.friendlyName!=a&&(this.re.friendlyName=a,f=!0);this.qa!=b&&(this.qa=b,f=!0);this.ub!=c&&(this.ub=c,f=!0);this.qd!=e&&(this.qd=e,f=!0);return f};d.Bg=function(){return this.re};d.Qm=function(){return this.re.friendlyName};d.kF=function(a){return a&1?"cast":a&32?"cast_audio_group":"cast_audio"};d.m7=function(a){this.qd=a;this.re.iconType=this.kF(this.qd)};d.getId=function(){return this.re.id};d.Eb=function(){return this.ub};
d.ae=function(a){return this.bf[a]||"unknown"};d.ro=function(a,b){this.bf[a]=b};d.nM=function(){return"name = "+this.re.friendlyName+(this.qa?", ip = "+this.qa:"")+(this.qc?", model = "+this.qc:"")+", capabilities = "+this.qd+", apps = "+JSON.stringify(this.bf)};d.AK=function(a){this.Am=a};var Oi={mea:0,dea:1},Pi={jga:0,iO:1,qfa:2},Qi={DIAL:0,qea:1,rea:2,jda:3},Ri={Mea:0,TIMEOUT:1,FAILED:2},Si={QA:0,Cca:1,bda:2,Dda:3,Wca:4,yea:5},Ti=function(a){ih("MediaRouter.Cast.Session.Ended",a,Pi)},Ui=function(a){ih("MediaRouter.Cast.Discovery.Type",a,Qi)},Vi=function(a){ih("MediaRouter.Cast.Session.Fail",a,Ri)};var Wi=function(a){this.Jf=a};Wi.prototype.handleEvent=p;var Xi=new Map,Yi=new Map,Zi=function(a){var b=Xi.get(a)||null;if(b)return G(b);b=Yi.get(a);b||(b=I(),Yi.set(a,b));return b.promise},$i=function(a){var b=a.Jf;if(Xi.has(b))throw Error("Duplicate module "+b);Xi.set(b,a);(b=Yi.get(b))&&b.resolve(a)};var aj=function(a,b,c,e){for(var f=[],g=3;g<arguments.length;++g)f[g-3]=arguments[g];this.Hb=a;this.Jf=b;this.Ig=!1;this.pa=c;this.S_=f;this.Pk=this.PR.bind(this)};d=aj.prototype;d.Fy=function(){nf(this);this.Ig&&this.NC()};d.NC=function(){this.pa.addListener.apply(this.pa,[].concat([this.Pk],ia(this.S_)))};d.register=function(){this.Ig||(this.Ig=!0,this.NC())};d.unregister=function(){this.Ig&&(this.pa.removeListener(this.Pk),this.Ig=!1)};d.li=function(){return this.Ig};
d.PR=function(a){for(var b=[],c=0;c<arguments.length;++c)b[c-0]=arguments[c];var e=this;if(c=Xi.get(this.Jf)||null)return c.handleEvent.apply(c,[].concat([this.pa],ia(b)));Zi(this.Jf).then(function(a){return a.handleEvent.apply(a,[].concat([e.pa],ia(b)))});return this.DR()};d.DR=p;d.la=function(){return"mr.DeferredEventListener."+this.Hb};d.getData=function(){return[this.Ig]};d.eb=function(){this.Ig=kf(this)};var bj={serviceType:"_googlecast._tcp.local"},cj=null,dj=function(){cj||(cj=new aj("CastMdnsEventListener","mr.cast.SinkDiscoveryService",chrome.mdns.onServiceList,bj));return cj},ej=null,fj=function(){ej||(ej=new aj("CastNetworksChangedEventListener","mr.cast.SinkDiscoveryService",chrome.networkingPrivate.onNetworksChanged));return ej};var gj=function(a,b){this.Jf="mr.cast.SinkDiscoveryService";this.Uc=b;this.OB=a;this.OB.W=this.W.bind(this);this.Vc=new z;this.Jl=new z;this.Lf=new z;this.AH=null;this.rn=this.Rg="";this.Tj=null;this.dG=this.kn=!1;this.a=B("mr.cast.SinkDiscoveryService")};w(gj,Wi);d=gj.prototype;d.init=function(){nf(this);this.kn&&(this.dH(),this.DD());$i(this)};d.dH=function(){this.P_()?(E(this.a,"Start listening to network changes"),fj().register()):E(this.a,"Listening to network changes was disabled")};d.P_=function(){return!lh()};
d.start=function(){var a=u(),b=dj();if(b.li()){if(6E4>a-this.AH)return;E(this.a,"Forcing mdns discovery");this.aT()}else E(this.a,"Adding mdns listener"),b.register();this.AH=a};d.aT=function(){chrome.mdns.forceDiscovery(p);var a=dj();a.unregister();a.register()};
d.handleEvent=function(a,b){for(var c=[],e=1;e<arguments.length;++e)c[e-1]=arguments[e];if(a==chrome.mdns.onServiceList)this.kJ.apply(this,[].concat(ia(c)));else if(a==chrome.networkingPrivate.onNetworksChanged)this.DD();else throw Error("Unhandled event");};
d.qR=function(a){if(-1==a.serviceName.indexOf("._googlecast."))return null;var b={};a.serviceData.forEach(function(a){0==a.search(/[a-z]{2}=.+/)&&(b[a.substring(0,2)]=a.substring(3))});var c=b.id;if(!c)return D(this.a,"Missing ID"),null;var e=Li(c),f=Number(a.serviceHostPort.substring(a.serviceHostPort.indexOf(":")+1));if(isNaN(f)||0>f||65535<f)return D(this.a,"Missing or invalid port"),null;if(this.Lf.ab(e)){var g=this.Lf.get(e);if(g.qa==a.ipAddress&&g.Eb()==f)return D(this.a,"Sink has pending connection "+
e),null;D(this.a,"Pending sink changed ip "+e);this.Lf.remove(e)}g=b.fn;if(!g||!a.ipAddress)return D(this.a,"Missing friendly name or IP address"),null;var k=Number(b.ca),k=isNaN(k)?0:k;return(e=this.Vc.get(e))?(e.update(g,a.ipAddress,f,k)&&(e.AK(!1),this.Uc.fd(e)),null):new Mi(c,g,b.md||"",k,a.ipAddress,f)};d.refresh=function(){F(this.a,"Executing forceDiscovery.");chrome.mdns.forceDiscovery(p)};d.kJ=function(a){E(this.a,"Registering "+a.length+" devices");this.rR(a).forEach(this.p0,this)};
d.Fu=function(a,b){this.Lf.ab(a.getId())||(this.Lf.set(a.getId(),a),this.lm(a).then(function(c){c?(c=this.Vc.get(a.getId()),b&&(c?c.Am&&Ui(3):Ui(1)),this.dm(a)):E(this.a,"Inaccessible sink: "+a.getId())},null,this).Gc(function(){this.Lf.remove(a.getId());0==this.Lf.P()&&this.bs()},this))};d.p0=function(a){this.Fu(a,!0)};d.rR=function(a){var b=[];a.forEach(function(a){(a=this.qR(a))&&b.push(a)},this);return b};
d.dm=function(a){E(this.a,"Adding sink "+a.getId());var b=this.Vc.get(a.getId()),c=null,e=a.qa,f=a.Eb();null!=e&&null!=f&&(c=this.Jl.get(e+":"+f));if(b&&!c){var g=a.qa,k=a.Eb();g&&k&&this.Jl.remove(g+":"+k)}c&&!b&&this.Vc.remove(c.getId());this.Vc.set(a.getId(),a);null!=e&&null!=f&&this.Jl.set(e+":"+f,a);this.kn||(this.kn=!0,this.dH());this.Uc.Fi(a);Pf.M().Oi=new Of(a.qc,a.qa)};d.Ix=function(a){E(this.a,"Channel error for sink "+a);this.ql(a)};
d.ql=function(a){var b=this.Vc.get(a);if(b){E(this.a,"Removing sink "+a);this.Vc.remove(a);a=b.qa;var c=b.Eb();null!=a&&null!=c&&this.Jl.remove(a+":"+c);this.Uc.Rr(b)}};d.c5=function(){var a=this.Vc.B();this.Vc.clear();this.Jl.clear();a.forEach(this.Uc.Rr,this.Uc)};d.lm=function(a){F(this.a,"Checking access to "+a.getId());return this.OB.Mj(a).then(function(b){if(a.Am){var c=4;b.audioOnly||(c|=1);a.m7(c)}return!0},function(){return!1})};
d.bs=function(){E(this.a,"Pruning inactive sinks.");Cc(this.cn(),function(a){this.Lf.set(a.getId(),a);this.lm(a).then(function(b){b||this.ql(a.getId())},null,this).Gc(function(){this.Lf.remove(a.getId())},this)},this)};d.W=function(a){return this.Vc.get(a,null)};d.FX=function(a,b){return this.Jl.get(a+":"+b)};d.GX=function(a){var b=[];Cc(this.cn(),function(c){Hi(c.ae(a))&&b.push(c)});return b};d.cn=function(){return this.Vc.Aw()};d.fd=function(a){this.Uc.fd(a)};d.zc=function(){return this.Vc.B()};
var hj=function(a,b){this.sinkMap=a;this.networkIds=b;this.version=2},ij=function(a){this.hasSavedSinks=a};d=gj.prototype;d.la=function(){return"cast.SinkDiscoveryService"};d.getData=function(){var a={};Cc(this.Vc.xE(),function(b){var c;c=this.Vc.get(b);c={id:c.getId(),ip:c.qa,port:c.Eb(),friendlyName:c.Qm(),modelName:c.qc,capabilities:c.qd};a[b]=c},this);return[new hj(a,this.rn),new ij(this.kn)]};
d.eb=function(){var a=kf(this);a&&2==a.version&&(this.rn=a.networkIds,this.iH(a.sinkMap));if(a=lf(this))this.kn=a.hasSavedSinks};d.iH=function(a){this.dG=0<Object.keys(a).length;for(var b in a){var c;c=a[b];var e=new Mi("",c.friendlyName,c.modelName,c.capabilities,c.ip,c.port);e.re.id=c.id;c=e;this.W(c.getId())||this.Fu(c,!1)}};
d.DD=function(){E(this.a,"Fetching networks state");this.Tj&&vf(this.Tj);chrome.networkingPrivate.getNetworks({networkType:"All",visible:!0,configured:!0},function(a){for(var b=[],c=0;c<a.length;c++)"Connected"==a[c].ConnectionState&&b.push(a[c].GUID);this.sba(b.sort().join(","))}.bind(this))};
d.sba=function(a){E(this.a,"Update current network "+jj(a));a!=this.Rg&&(this.Tj&&(mf.remove(this.Tj.la()),this.Tj=null),a?(this.rn&&a!=this.rn?this.c5():this.bs(),this.rn=this.Rg=a,this.Tj=new kj(this,this.Rg)):this.Rg="")};var jj=function(a){for(var b=0,c=0;c<a.length;c++)b+=a.charCodeAt(c);return b},kj=function(a,b){this.ld=a;this.Rg=b;nf(this)};kj.prototype.la=function(){return"cast.NetworkSink."+this.Rg};
kj.prototype.getData=function(){var a=null,b=this.ld.getData();b&&(this.ld.dG||0<this.ld.zc().length)&&(a=b[0]);E(this.ld.a,"Saving sink data for network "+jj(this.Rg));return[null,a]};kj.prototype.eb=function(){E(this.ld.a,"Restoring sink data for network "+jj(this.Rg));var a=lf(this);a&&2==a.version&&this.ld.iH(a.sinkMap)};var lj={STOP_MEDIA:"STOP",MEDIA_SET_VOLUME:"SET_VOLUME",MEDIA_GET_STATUS:"GET_STATUS"};var mj=function(){this.type="GET_STATUS";this.requestId=0};var nj=function(a){this.type="LAUNCH";this.requestId=0;this.appId=a;this.language=null};var oj=function(a){this.type="STOP";this.requestId=0;this.sessionId=a||null};var pj=function(a,b){this.requestId=a;this.Yaa=b;this.mM=null};pj.prototype.Lx=function(){};var qj=function(){this.Vb=new z};qj.prototype.dB=function(a){this.Vb.set(a.requestId,a);a.mM=setTimeout(this.E2.bind(this,a),a.Yaa)};qj.prototype.bo=function(a){var b=this.Vb.get(a);if(!b)return null;clearTimeout(b.mM);this.Vb.remove(a);return b};qj.prototype.ai=function(a){return this.Vb.get(a,null)};qj.prototype.E2=function(a){this.Vb.remove(a.requestId);a.Lx()};var rj=function(a){this.Gaa=a;this.$k=1E3*Math.floor(1E6*Math.random())};d=rj.prototype;d.WC=function(){nf(this)};d.Hq=function(){var a=this.$k++;0==a&&(a=this.$k++);return a};d.la=function(){return"IdGenerator."+this.Gaa};d.getData=function(){return[this.$k]};d.eb=function(){var a=kf(this);a&&(this.$k=a)};var sj=function(a,b){this.Ic=a;this.kd=b;this.Ii=new qj;this.xJ=new rj("cast.RequestIdGenerator")};sj.prototype.init=function(){this.xJ.WC()};var tj=function(a,b,c,e){pj.call(this,a,c);this.wb=b;this.sourceId=e};w(tj,pj);tj.prototype.Lx=function(){this.wb.reject(uj)};sj.prototype.eB=function(a,b,c){var e=this.xJ.Hq();a.requestId=e;a=I();b=new tj(e,a,r(b)&&0<b?b:6E5,c);this.Ii.dB(b);return b};sj.prototype.My=function(a){this.Ii.bo(a.requestId)};sj.prototype.bo=function(a){return this.Ii.bo(a)};
var uj=Error("Timeout"),vj=Error("Failed to send message");sj.prototype.sendRequest=function(a,b,c,e,f,g){if(!Gi.hasOwnProperty(c))return H(Error("Custom namespace is not supported"));var k=this.eB(a,l(e)?e:3E3,f),n=k.wb;this.Ic.us(b,c,a,f||this.kd,g).then(null,function(){this.My(k);n.reject(vj)},this);return n.promise};
sj.prototype.sendMessage=function(a,b,c,e,f,g){var k=this.eB(a,l(e)?e:3E3,f),n=k.wb;this.Ic.us(b,c,a,f||this.kd,g).then(function(){this.My(k);n.resolve(!0)},function(){this.My(k);n.reject(vj)},this);return n.promise};sj.prototype.D5=function(a,b){var c=new nj(a.appId);c.language=a.language?a.language:chrome.i18n.getUILanguage?chrome.i18n.getUILanguage():chrome.runtime.getManifest().default_locale;return this.sendRequest(c,b,Di,a.requestSessionTimeout)};
sj.prototype.G5=function(a,b){return this.sendRequest(new oj(a),b,Di)};var wj=function(a,b){this.type="cast_app";this.originId=window["castApp.eventPage.Message.OriginID"]||void 0;this.subtype=a;this.devices=b;this.deviceJustSetUp=void 0};m("castApp.eventPage.Message",wj,void 0);var xj=function(a,b,c){this.ipAddress=a;this.appId=b;this.sessionId=c};wj.DeviceData=xj;wj.DeviceJustSetUp=function(a,b,c,e){this.ipAddress=a;this.name=b;this.udn=c;this.modelName=e};var yj=function(a,b){this.vc=a;this.rd=b;this.Zj=new z;this.Xj=new Oc;this.QG=0;this.A0=new z("serviceCheck",this.SY.bind(this),"startDeviceMonitor",this.$Y.bind(this),"releaseDeviceMonitor",this.NY.bind(this),"deviceJustSetUp",this.zY.bind(this));chrome.runtime.onMessage.addListener(this.IY.bind(this));chrome.runtime.onMessageExternal.addListener(this.CY.bind(this));this.Qe("serviceReady")};d=yj.prototype;d.a=B("castApp.eventPage.Service");d.ON=3E4;d.qN=52;d.pN=53;
d.YY=function(){if(this.TB()){var a=new Oc;Cc(this.vc.cn(),function(b){var e=b.qa;a.add(e);this.Zj.ab(e)||this.rd.sendRequest(new mj,b,Di)}.bind(this));var b=!1;this.Zj.ob().forEach(function(c){a.contains(c)||(this.Zj.remove(c),b=!0)}.bind(this));b&&this.ru()}};
d.uY=function(a,b){if(this.TB()&&Gi.hasOwnProperty(b.namespace_)&&(a=a.qa)&&(b=JSON.parse(b.data),"RECEIVER_STATUS"===b.type)){var c=b.status&&b.status.applications&&b.status.applications[0],e=b=null;c&&(c.appId&&(b=c.appId),c.sessionId&&(e=c.sessionId));c=this.Zj.get(a);this.Zj.set(a,new xj(a,b,e));c&&c.appId===b||this.ru()}};
d.TB=function(){if(0===this.Xj.P())return!1;var a=u();a-this.QG>this.ON&&(this.QG=a,chrome.tabs.query({url:["chrome://cast/*","chrome-extension://"+chrome.runtime.id+"/cast_setup/*"]},function(a){0===a.length?(E(this.a,"No tabs found. Clearing device monitor clients."),this.Xj.clear()):E(this.a,"Tab check found active tabs: "+a.map(function(a){return a.id}))}.bind(this)));a=this.Xj.P();E(this.a,"Monitor client count: "+a);return 0<a};
d.IY=function(a,b,c){if("object"!==typeof a||"cast_app"!==a.type)return!1;var e=this.A0.get(a.subtype);if(!e)return!1;if(!a.originId)return $a("Missing origin ID in the incoming message."),!1;try{var f=e(a,b,c);f&&c(f)}catch(g){C(this.a,"Error while handling request",g)}return!1};d.Qe=function(a,b){a=new wj(a,b);E(this.a,"Sending message: "+JSON.stringify(a));chrome.runtime.sendMessage(a)};d.SY=function(){this.Qe("serviceReady")};
d.$Y=function(a){this.Xj.contains(a.originId)?E(this.a,"Client: "+a.originId+"already registered, dispatching current device list."):(E(this.a,"Registering monitor client: "+a.originId),this.Xj.add(a.originId));this.ru();this.Q4()};d.NY=function(a){E(this.a,"Unregistering monitor client: "+a.originId);this.Xj.remove(a.originId)};d.zY=function(a){a=a.deviceJustSetUp;var b=a.udn.replace(/-/g,"").toLowerCase();a=new Mi(b,a.name,a.modelName,void 0,a.ipAddress,Pf.M().Gj||8009);this.vc.Fu(a,!0)};
d.ru=function(){var a=this.Zj.B();this.Qe("devices",a)};d.Q4=function(){this.vc.refresh();this.vc.zc().forEach(function(a){this.rd.sendRequest(new mj,a,Di)}.bind(this))};
d.CY=function(a,b,c){switch(a.type){case "handshake":c(new Ai("handshake"));break;case "launch":b=b.tab&&r(b.tab.id)?b.tab.id:null,null===b||"setup"!==a.entryPoint&&"offers"!==a.entryPoint&&"devices"!==a.entryPoint||(a=0<=Wa(vi,this.pN)?"chrome://cast#"+a.entryPoint:0<=Wa(vi,this.qN)?"chrome-extension://"+chrome.runtime.id+"/cast_setup/index.html#"+a.entryPoint:"chrome-extension://"+chrome.runtime.id+"/cast_setup/"+a.entryPoint+".html",chrome.tabs.update(b,{url:a}))}};chrome.cast.Ye={CUSTOM_CONTROLLER_SCOPED:"custom_controller_scoped",TAB_AND_ORIGIN_SCOPED:"tab_and_origin_scoped",ORIGIN_SCOPED:"origin_scoped",PAGE_SCOPED:"page_scoped"};m("chrome.cast.AutoJoinPolicy",chrome.cast.Ye,void 0);chrome.cast.Zo={CREATE_SESSION:"create_session",CAST_THIS_TAB:"cast_this_tab"};m("chrome.cast.DefaultActionPolicy",chrome.cast.Zo,void 0);chrome.cast.gg={VIDEO_OUT:"video_out",AUDIO_OUT:"audio_out",VIDEO_IN:"video_in",AUDIO_IN:"audio_in",MULTIZONE_GROUP:"multizone_group"};
m("chrome.cast.Capability",chrome.cast.gg,void 0);chrome.cast.Ze={CANCEL:"cancel",TIMEOUT:"timeout",API_NOT_INITIALIZED:"api_not_initialized",INVALID_PARAMETER:"invalid_parameter",EXTENSION_NOT_COMPATIBLE:"extension_not_compatible",EXTENSION_MISSING:"extension_missing",RECEIVER_UNAVAILABLE:"receiver_unavailable",SESSION_ERROR:"session_error",CHANNEL_ERROR:"channel_error",LOAD_MEDIA_FAILED:"load_media_failed"};m("chrome.cast.ErrorCode",chrome.cast.Ze,void 0);chrome.cast.jO={AVAILABLE:"available",UNAVAILABLE:"unavailable"};
m("chrome.cast.ReceiverAvailability",chrome.cast.jO,void 0);chrome.cast.vO={CHROME:"chrome",IOS:"ios",ANDROID:"android"};m("chrome.cast.SenderPlatform",chrome.cast.vO,void 0);chrome.cast.ap={CAST:"cast",DIAL:"dial",HANGOUT:"hangout",CUSTOM:"custom"};m("chrome.cast.ReceiverType",chrome.cast.ap,void 0);chrome.cast.xN={RUNNING:"running",STOPPED:"stopped",ERROR:"error"};m("chrome.cast.DialAppState",chrome.cast.xN,void 0);chrome.cast.cm={CAST:"cast",STOP:"stop"};
m("chrome.cast.ReceiverAction",chrome.cast.cm,void 0);chrome.cast.MA={CONNECTED:"connected",DISCONNECTED:"disconnected",STOPPED:"stopped"};m("chrome.cast.SessionStatus",chrome.cast.MA,void 0);chrome.cast.VERSION=[1,2];m("chrome.cast.VERSION",chrome.cast.VERSION,void 0);chrome.cast.Tba=!0;m("chrome.cast.usingPresentationApi",chrome.cast.Tba,void 0);chrome.cast.Error=function(a,b,c){this.code=a;this.description=b||null;this.details=c||null};m("chrome.cast.Error",chrome.cast.Error,void 0);chrome.cast.uO=function(a){this.platform=a;this.packageId=this.url=null};m("chrome.cast.SenderApplication",chrome.cast.uO,void 0);chrome.cast.Image=function(a){this.url=a;this.width=this.height=null};
m("chrome.cast.Image",chrome.cast.Image,void 0);chrome.cast.Volume=function(a,b){this.level=l(a)?a:null;this.muted=l(b)?b:null};m("chrome.cast.Volume",chrome.cast.Volume,void 0);chrome.cast.nN=function(a,b,c,e,f){this.sessionRequest=a;this.sessionListener=b;this.receiverListener=c;this.autoJoinPolicy=e||chrome.cast.Ye.TAB_AND_ORIGIN_SCOPED;this.defaultActionPolicy=f||chrome.cast.Zo.CREATE_SESSION;this.customDialLaunchCallback=null;this.invisibleSender=!1;this.additionalSessionRequests=[]};m("chrome.cast.ApiConfig",chrome.cast.nN,void 0);chrome.cast.zN=function(a,b){this.appName=a;this.launchParameter=b||null};m("chrome.cast.DialRequest",chrome.cast.zN,void 0);
chrome.cast.EA=function(a,b,c){this.receiver=a;this.appState=b;this.extraData=c||null};m("chrome.cast.DialLaunchData",chrome.cast.EA,void 0);chrome.cast.yN=function(a,b){this.doLaunch=a;this.launchParameter=b||null};m("chrome.cast.DialLaunchResponse",chrome.cast.yN,void 0);chrome.cast.LA=function(a,b,c){this.appId=a;this.capabilities=ua(b)?b:[chrome.cast.gg.VIDEO_OUT,chrome.cast.gg.AUDIO_OUT];this.requestSessionTimeout=c||chrome.cast.timeout.requestSession;this.dialRequest=this.language=null};
m("chrome.cast.SessionRequest",chrome.cast.LA,void 0);chrome.cast.Lt=function(a,b,c,e){this.label=a;this.friendlyName=b;this.capabilities=c||[];this.volume=e||null;this.receiverType=chrome.cast.ap.CAST;this.displayStatus=this.isActiveInput=null};m("chrome.cast.Receiver",chrome.cast.Lt,void 0);chrome.cast.kO=function(a,b){this.statusText=a;this.appImages=b;this.showStop=null};m("chrome.cast.ReceiverDisplayStatus",chrome.cast.kO,void 0);
chrome.cast.PA=function(){this.requestSession=6E4;this.sendCustomMessage=this.setReceiverVolume=this.stopSession=this.leaveSession=3E3};m("chrome.cast.Timeout",chrome.cast.PA,void 0);chrome.cast.timeout=new chrome.cast.PA;m("chrome.cast.timeout",chrome.cast.timeout,void 0);chrome.cast.mN="auto-join";chrome.cast.JA="cast-session_";chrome.cast.media.bm={PAUSE:"pause",SEEK:"seek",STREAM_VOLUME:"stream_volume",STREAM_MUTE:"stream_mute"};m("chrome.cast.media.MediaCommand",chrome.cast.media.bm,void 0);chrome.cast.media.Rd={GENERIC:0,MOVIE:1,TV_SHOW:2,MUSIC_TRACK:3,PHOTO:4};m("chrome.cast.media.MetadataType",chrome.cast.media.Rd,void 0);chrome.cast.media.$o={IDLE:"IDLE",PLAYING:"PLAYING",PAUSED:"PAUSED",BUFFERING:"BUFFERING"};m("chrome.cast.media.PlayerState",chrome.cast.media.$o,void 0);
chrome.cast.media.Mt={OFF:"REPEAT_OFF",ALL:"REPEAT_ALL",SINGLE:"REPEAT_SINGLE",ALL_AND_SHUFFLE:"REPEAT_ALL_AND_SHUFFLE"};m("chrome.cast.media.RepeatMode",chrome.cast.media.Mt,void 0);chrome.cast.media.lO={PLAYBACK_START:"PLAYBACK_START",PLAYBACK_PAUSE:"PLAYBACK_PAUSE"};m("chrome.cast.media.ResumeState",chrome.cast.media.lO,void 0);chrome.cast.media.NA={BUFFERED:"BUFFERED",LIVE:"LIVE",OTHER:"OTHER"};m("chrome.cast.media.StreamType",chrome.cast.media.NA,void 0);
chrome.cast.media.FN={CANCELLED:"CANCELLED",INTERRUPTED:"INTERRUPTED",FINISHED:"FINISHED",ERROR:"ERROR"};m("chrome.cast.media.IdleReason",chrome.cast.media.FN,void 0);chrome.cast.media.FO={TEXT:"TEXT",AUDIO:"AUDIO",VIDEO:"VIDEO"};m("chrome.cast.media.TrackType",chrome.cast.media.FO,void 0);chrome.cast.media.CO={SUBTITLES:"SUBTITLES",CAPTIONS:"CAPTIONS",DESCRIPTIONS:"DESCRIPTIONS",CHAPTERS:"CHAPTERS",METADATA:"METADATA"};m("chrome.cast.media.TextTrackType",chrome.cast.media.CO,void 0);
chrome.cast.media.yO={NONE:"NONE",OUTLINE:"OUTLINE",DROP_SHADOW:"DROP_SHADOW",RAISED:"RAISED",DEPRESSED:"DEPRESSED"};m("chrome.cast.media.TextTrackEdgeType",chrome.cast.media.yO,void 0);chrome.cast.media.DO={NONE:"NONE",NORMAL:"NORMAL",ROUNDED_CORNERS:"ROUNDED_CORNERS"};m("chrome.cast.media.TextTrackWindowType",chrome.cast.media.DO,void 0);
chrome.cast.media.zO={SANS_SERIF:"SANS_SERIF",MONOSPACED_SANS_SERIF:"MONOSPACED_SANS_SERIF",SERIF:"SERIF",MONOSPACED_SERIF:"MONOSPACED_SERIF",CASUAL:"CASUAL",CURSIVE:"CURSIVE",SMALL_CAPITALS:"SMALL_CAPITALS"};m("chrome.cast.media.TextTrackFontGenericFamily",chrome.cast.media.zO,void 0);chrome.cast.media.AO={NORMAL:"NORMAL",BOLD:"BOLD",BOLD_ITALIC:"BOLD_ITALIC",ITALIC:"ITALIC"};m("chrome.cast.media.TextTrackFontStyle",chrome.cast.media.AO,void 0);chrome.cast.media.DN=function(){this.customData=null};m("chrome.cast.media.GetStatusRequest",chrome.cast.media.DN,void 0);chrome.cast.media.WN=function(){this.customData=null};m("chrome.cast.media.PauseRequest",chrome.cast.media.WN,void 0);chrome.cast.media.ZN=function(){this.customData=null};m("chrome.cast.media.PlayRequest",chrome.cast.media.ZN,void 0);chrome.cast.media.tO=function(){this.customData=this.resumeState=this.currentTime=null};m("chrome.cast.media.SeekRequest",chrome.cast.media.tO,void 0);
chrome.cast.media.wO=function(){this.customData=null};m("chrome.cast.media.StopRequest",chrome.cast.media.wO,void 0);chrome.cast.media.IO=function(a){this.volume=a;this.customData=null};m("chrome.cast.media.VolumeRequest",chrome.cast.media.IO,void 0);chrome.cast.media.IN=function(a){this.type="LOAD";this.requestId=0;this.sessionId=null;this.media=a;this.activeTrackIds=null;this.autoplay=!0;this.customData=this.currentTime=null};m("chrome.cast.media.LoadRequest",chrome.cast.media.IN,void 0);
chrome.cast.media.BN=function(a,b){this.requestId=0;this.activeTrackIds=a||null;this.textTrackStyle=b||null};m("chrome.cast.media.EditTracksInfoRequest",chrome.cast.media.BN,void 0);chrome.cast.media.CN=function(){this.metadataType=this.type=chrome.cast.media.Rd.GENERIC;this.releaseDate=this.releaseYear=this.images=this.subtitle=this.title=null};m("chrome.cast.media.GenericMediaMetadata",chrome.cast.media.CN,void 0);
chrome.cast.media.QN=function(){this.metadataType=this.type=chrome.cast.media.Rd.MOVIE;this.releaseDate=this.releaseYear=this.images=this.subtitle=this.studio=this.title=null};m("chrome.cast.media.MovieMediaMetadata",chrome.cast.media.QN,void 0);chrome.cast.media.GO=function(){this.metadataType=this.type=chrome.cast.media.Rd.TV_SHOW;this.originalAirdate=this.releaseYear=this.images=this.episode=this.episodeNumber=this.season=this.seasonNumber=this.episodeTitle=this.title=this.seriesTitle=null};
m("chrome.cast.media.TvShowMediaMetadata",chrome.cast.media.GO,void 0);chrome.cast.media.RN=function(){this.metadataType=this.type=chrome.cast.media.Rd.MUSIC_TRACK;this.releaseDate=this.releaseYear=this.images=this.discNumber=this.trackNumber=this.artistName=this.songName=this.composer=this.artist=this.albumArtist=this.title=this.albumName=null};m("chrome.cast.media.MusicTrackMediaMetadata",chrome.cast.media.RN,void 0);
chrome.cast.media.XN=function(){this.metadataType=this.type=chrome.cast.media.Rd.PHOTO;this.creationDateTime=this.height=this.width=this.longitude=this.latitude=this.images=this.location=this.artist=this.title=null};m("chrome.cast.media.PhotoMediaMetadata",chrome.cast.media.XN,void 0);chrome.cast.media.PN=function(a,b){this.contentId=a;this.streamType=chrome.cast.media.NA.BUFFERED;this.contentType=b;this.customData=this.textTrackStyle=this.tracks=this.duration=this.metadata=null};
m("chrome.cast.media.MediaInfo",chrome.cast.media.PN,void 0);chrome.cast.media.aO=function(a){this.itemId=null;this.media=a;this.autoplay=!0;this.startTime=0;this.playbackDuration=null;this.preloadTime=0;this.customData=this.activeTrackIds=null};m("chrome.cast.media.QueueItem",chrome.cast.media.aO,void 0);chrome.cast.media.vN="CC1AD845";m("chrome.cast.media.DEFAULT_MEDIA_RECEIVER_APP_ID",chrome.cast.media.vN,void 0);chrome.cast.media.timeout={};
m("chrome.cast.media.timeout",chrome.cast.media.timeout,void 0);chrome.cast.media.timeout.load=0;chrome.cast.media.timeout.load=chrome.cast.media.timeout.load;chrome.cast.media.timeout.cb=0;chrome.cast.media.timeout.getStatus=chrome.cast.media.timeout.cb;chrome.cast.media.timeout.play=0;chrome.cast.media.timeout.play=chrome.cast.media.timeout.play;chrome.cast.media.timeout.pause=0;chrome.cast.media.timeout.pause=chrome.cast.media.timeout.pause;chrome.cast.media.timeout.seek=0;
chrome.cast.media.timeout.seek=chrome.cast.media.timeout.seek;chrome.cast.media.timeout.stop=0;chrome.cast.media.timeout.stop=chrome.cast.media.timeout.stop;chrome.cast.media.timeout.Fl=0;chrome.cast.media.timeout.setVolume=chrome.cast.media.timeout.Fl;chrome.cast.media.timeout.fv=0;chrome.cast.media.timeout.editTracksInfo=chrome.cast.media.timeout.fv;chrome.cast.media.timeout.q4=0;chrome.cast.media.timeout.queue=chrome.cast.media.timeout.q4;
chrome.cast.media.EO=function(a,b){this.trackId=a;this.trackContentType=this.trackContentId=null;this.type=b;this.customData=this.subtype=this.language=this.name=null};m("chrome.cast.media.Track",chrome.cast.media.EO,void 0);chrome.cast.media.BO=function(){this.customData=this.fontStyle=this.fontGenericFamily=this.fontFamily=this.fontScale=this.windowRoundedCornerRadius=this.windowColor=this.windowType=this.edgeColor=this.edgeType=this.backgroundColor=this.foregroundColor=null};
m("chrome.cast.media.TextTrackStyle",chrome.cast.media.BO,void 0);chrome.cast.media.cO=function(a){this.type="QUEUE_LOAD";this.sessionId=this.requestId=null;this.items=a;this.startIndex=0;this.repeatMode=chrome.cast.media.Mt.OFF;this.customData=null};m("chrome.cast.media.QueueLoadRequest",chrome.cast.media.cO,void 0);chrome.cast.media.$N=function(a){this.type="QUEUE_INSERT";this.sessionId=this.requestId=null;this.items=a;this.customData=this.insertBefore=null};
m("chrome.cast.media.QueueInsertItemsRequest",chrome.cast.media.$N,void 0);chrome.cast.media.gO=function(a){this.type="QUEUE_UPDATE";this.sessionId=this.requestId=null;this.items=a;this.customData=null};m("chrome.cast.media.QueueUpdateItemsRequest",chrome.cast.media.gO,void 0);chrome.cast.media.bO=function(){this.type="QUEUE_UPDATE";this.customData=this.jump=this.currentItemId=this.sessionId=this.requestId=null};m("chrome.cast.media.QueueJumpRequest",chrome.cast.media.bO,void 0);
chrome.cast.media.fO=function(){this.type="QUEUE_UPDATE";this.customData=this.repeatMode=this.sessionId=this.requestId=null};m("chrome.cast.media.QueueSetPropertiesRequest",chrome.cast.media.fO,void 0);chrome.cast.media.dO=function(a){this.type="QUEUE_REMOVE";this.sessionId=this.requestId=null;this.itemIds=a;this.customData=null};m("chrome.cast.media.QueueRemoveItemsRequest",chrome.cast.media.dO,void 0);
chrome.cast.media.eO=function(a){this.type="QUEUE_REORDER";this.sessionId=this.requestId=null;this.itemIds=a;this.customData=this.insertBefore=null};m("chrome.cast.media.QueueReorderItemsRequest",chrome.cast.media.eO,void 0);chrome.cast.media.u=function(a,b){this.sessionId=a;this.mediaSessionId=b;this.media=null;this.playbackRate=1;this.playerState=chrome.cast.media.$o.IDLE;this.currentTime=0;this.LG=-1;this.supportedMediaCommands=[];this.volume=new chrome.cast.Volume;this.items=this.preloadedItemId=this.loadingItemId=this.currentItemId=this.customData=this.activeTrackIds=this.idleReason=null;this.repeatMode=chrome.cast.media.Mt.OFF};m("chrome.cast.media.Media",chrome.cast.media.u,void 0);
chrome.cast.media.u.prototype.cb=function(){};chrome.cast.media.u.prototype.getStatus=chrome.cast.media.u.prototype.cb;chrome.cast.media.u.prototype.play=function(){};chrome.cast.media.u.prototype.play=chrome.cast.media.u.prototype.play;chrome.cast.media.u.prototype.R3=function(){};chrome.cast.media.u.prototype.playWithContext=chrome.cast.media.u.prototype.R3;chrome.cast.media.u.prototype.pause=function(){};chrome.cast.media.u.prototype.pause=chrome.cast.media.u.prototype.pause;
chrome.cast.media.u.prototype.L3=function(){};chrome.cast.media.u.prototype.pauseWithContext=chrome.cast.media.u.prototype.L3;chrome.cast.media.u.prototype.seek=function(){};chrome.cast.media.u.prototype.seek=chrome.cast.media.u.prototype.seek;chrome.cast.media.u.prototype.stop=function(){};chrome.cast.media.u.prototype.stop=chrome.cast.media.u.prototype.stop;chrome.cast.media.u.prototype.Fl=function(){};chrome.cast.media.u.prototype.setVolume=chrome.cast.media.u.prototype.Fl;
chrome.cast.media.u.prototype.fv=function(){};chrome.cast.media.u.prototype.editTracksInfo=chrome.cast.media.u.prototype.fv;chrome.cast.media.u.prototype.t4=function(){};chrome.cast.media.u.prototype.queueInsertItems=chrome.cast.media.u.prototype.t4;chrome.cast.media.u.prototype.r4=function(){};chrome.cast.media.u.prototype.queueAppendItem=chrome.cast.media.u.prototype.r4;chrome.cast.media.u.prototype.D4=function(){};chrome.cast.media.u.prototype.queueUpdateItems=chrome.cast.media.u.prototype.D4;
chrome.cast.media.u.prototype.y4=function(){};chrome.cast.media.u.prototype.queuePrev=chrome.cast.media.u.prototype.y4;chrome.cast.media.u.prototype.x4=function(){};chrome.cast.media.u.prototype.queueNext=chrome.cast.media.u.prototype.x4;chrome.cast.media.u.prototype.u4=function(a){this.Vv(a)};chrome.cast.media.u.prototype.queueJumpToItem=chrome.cast.media.u.prototype.u4;chrome.cast.media.u.prototype.C4=function(){};chrome.cast.media.u.prototype.queueSetRepeatMode=chrome.cast.media.u.prototype.C4;
chrome.cast.media.u.prototype.A4=function(){};chrome.cast.media.u.prototype.queueRemoveItems=chrome.cast.media.u.prototype.A4;chrome.cast.media.u.prototype.z4=function(a){this.Vv(a)};chrome.cast.media.u.prototype.queueRemoveItem=chrome.cast.media.u.prototype.z4;chrome.cast.media.u.prototype.B4=function(){};chrome.cast.media.u.prototype.queueReorderItems=chrome.cast.media.u.prototype.B4;
chrome.cast.media.u.prototype.w4=function(a,b,c,e){a=this.Vv(a);0>a||(0>b?e&&e(new chrome.cast.Error(chrome.cast.Ze.INVALID_PARAMETER)):a==b&&c&&c())};chrome.cast.media.u.prototype.queueMoveItemToNewIndex=chrome.cast.media.u.prototype.w4;chrome.cast.media.u.prototype.Paa=function(a){return-1<this.supportedMediaCommands.indexOf(a)};chrome.cast.media.u.prototype.supportsCommand=chrome.cast.media.u.prototype.Paa;
chrome.cast.media.u.prototype.LU=function(){if(this.playerState==chrome.cast.media.$o.PLAYING&&0<=this.LG){var a=(u()-this.LG)/1E3,a=this.currentTime+this.playbackRate*a;this.media&&null!=this.media.duration&&a>this.media.duration&&(a=this.media.duration);0>a&&(a=0);return a}return this.currentTime};chrome.cast.media.u.prototype.getEstimatedTime=chrome.cast.media.u.prototype.LU;chrome.cast.media.u.prototype.Yt=function(){};chrome.cast.media.u.prototype.addUpdateListener=chrome.cast.media.u.prototype.Yt;
chrome.cast.media.u.prototype.Zt=function(){};chrome.cast.media.u.prototype.addUpdateListenerWithContext=chrome.cast.media.u.prototype.Zt;chrome.cast.media.u.prototype.Ny=function(){};chrome.cast.media.u.prototype.removeUpdateListener=chrome.cast.media.u.prototype.Ny;chrome.cast.media.u.prototype.Oy=function(){};chrome.cast.media.u.prototype.removeUpdateListenerWithContext=chrome.cast.media.u.prototype.Oy;
chrome.cast.media.u.prototype.Vv=function(a){return ib(this.items,function(b){return b.itemId==a})};var zj=function(a,b,c){this.sessionId=a;this.namespaceName=b;this.message=c};var Aj=function(a){this.rd=a;this.a=B("mr.cast.ReceiverStatusQuerier")};Aj.prototype.taa=function(a){return(new Qf(t(this.p4,this,a),3500,5)).zs(2).start().va(function(b){E(this.a,"Failed to get receiver status from "+a.getId());throw b;},this)};Aj.prototype.p4=function(a){E(this.a,"Query receiver status: "+a.getId());return this.rd.sendRequest(new mj,a,Di)};var Bj=function(a,b){this.type="SET_VOLUME";this.requestId=0;this.volume=a;this.expectedVolume=b||null};chrome.cast.w=function(a,b,c,e,f){this.sessionId=a;this.appId=b;this.displayName=c;this.statusText=null;this.appImages=e;this.receiver=f;this.senderApps=[];this.namespaces=[];this.media=[];this.status=chrome.cast.MA.CONNECTED;this.transportId=""};m("chrome.cast.Session",chrome.cast.w,void 0);chrome.cast.w.prototype.I9=function(a,b,c){this.pL(null,a,b,c)};chrome.cast.w.prototype.setReceiverVolumeLevel=chrome.cast.w.prototype.I9;
chrome.cast.w.prototype.pL=function(a,b,c,e){b=new Bj(new chrome.cast.Volume(b,null),this.receiver.volume);a.setReceiverVolume(this.sessionId,b,c,e)};chrome.cast.w.prototype.setReceiverVolumeLevelWithContext=chrome.cast.w.prototype.pL;chrome.cast.w.prototype.H9=function(a,b,c){this.oL(null,a,b,c)};chrome.cast.w.prototype.setReceiverMuted=chrome.cast.w.prototype.H9;
chrome.cast.w.prototype.oL=function(a,b,c,e){a=new Bj(new chrome.cast.Volume(null,b),this.receiver.volume);null.setReceiverVolume(this.sessionId,a,c,e)};chrome.cast.w.prototype.setReceiverMutedWithContext=chrome.cast.w.prototype.oL;chrome.cast.w.prototype.leave=function(a,b){null.leaveSession(this.sessionId,a,b)};chrome.cast.w.prototype.leave=chrome.cast.w.prototype.leave;chrome.cast.w.prototype.stop=function(){};chrome.cast.w.prototype.stop=chrome.cast.w.prototype.stop;
chrome.cast.w.prototype.Faa=function(){};chrome.cast.w.prototype.stopWithContext=chrome.cast.w.prototype.Faa;chrome.cast.w.prototype.sendMessage=function(){};chrome.cast.w.prototype.sendMessage=chrome.cast.w.prototype.sendMessage;chrome.cast.w.prototype.C6=function(){};chrome.cast.w.prototype.sendMessageWithContext=chrome.cast.w.prototype.C6;chrome.cast.w.prototype.Yt=function(){};chrome.cast.w.prototype.addUpdateListener=chrome.cast.w.prototype.Yt;chrome.cast.w.prototype.Zt=function(){};
chrome.cast.w.prototype.addUpdateListenerWithContext=chrome.cast.w.prototype.Zt;chrome.cast.w.prototype.Ny=function(){};chrome.cast.w.prototype.removeUpdateListener=chrome.cast.w.prototype.Ny;chrome.cast.w.prototype.Oy=function(){};chrome.cast.w.prototype.removeUpdateListenerWithContext=chrome.cast.w.prototype.Oy;chrome.cast.w.prototype.$O=function(){};chrome.cast.w.prototype.addMessageListener=chrome.cast.w.prototype.$O;chrome.cast.w.prototype.aP=function(){};
chrome.cast.w.prototype.addMessageListenerWithContext=chrome.cast.w.prototype.aP;chrome.cast.w.prototype.YO=function(){};chrome.cast.w.prototype.addMediaListener=chrome.cast.w.prototype.YO;chrome.cast.w.prototype.ZO=function(){};chrome.cast.w.prototype.addMediaListenerWithContext=chrome.cast.w.prototype.ZO;chrome.cast.w.prototype.o5=function(){};chrome.cast.w.prototype.removeMediaListener=chrome.cast.w.prototype.o5;chrome.cast.w.prototype.p5=function(){};
chrome.cast.w.prototype.removeMediaListenerWithContext=chrome.cast.w.prototype.p5;chrome.cast.w.prototype.q5=function(){};chrome.cast.w.prototype.removeMessageListener=chrome.cast.w.prototype.q5;chrome.cast.w.prototype.r5=function(){};chrome.cast.w.prototype.removeMessageListenerWithContext=chrome.cast.w.prototype.r5;chrome.cast.w.prototype.X_=function(a){a.sessionId=this.sessionId};chrome.cast.w.prototype.loadMedia=chrome.cast.w.prototype.X_;chrome.cast.w.prototype.v4=function(a){a.sessionId=this.sessionId};
chrome.cast.w.prototype.queueLoad=chrome.cast.w.prototype.v4;var Fj=function(a,b){if(!b.applications||1!=b.applications.length)return null;var c=b.applications[0];a=Cj(a);a=new chrome.cast.w(c.sessionId,c.appId,c.displayName,c.appImages,a);a.senderApps=c.senderApps;a.namespaces=c.namespaces||[];a.transportId=c.transportId;a.statusText=c.statusText;if(!a.sessionId||!(a.namespaces&&0!=a.namespaces.length||Dj(a)))return null;a.receiver.volume=b.volume;"boolean"==typeof b.isActiveInput&&(a.receiver.isActiveInput=b.isActiveInput);return a},Gj=function(a){var b=
[];if(!a)return b;a&1&&b.push(chrome.cast.gg.VIDEO_OUT);a&2&&b.push(chrome.cast.gg.VIDEO_IN);a&4&&b.push(chrome.cast.gg.AUDIO_OUT);a&8&&b.push(chrome.cast.gg.AUDIO_IN);a&32&&b.push(chrome.cast.gg.MULTIZONE_GROUP);return b},Cj=function(a){return new chrome.cast.Lt(a.getId(),a.Qm(),Gj(a.qd))},Hj=function(a,b){if(a.statusText!=b.statusText)return!0;var c=a.namespaces||[],e=b.namespaces||[];if(c.length!=e.length)return!0;for(var f=0;f<c.length;f++)if(!e.some(function(a){return a.name==c[f].name}))return!0;
return a.receiver.volume.level!==b.receiver.volume.level||a.receiver.volume.muted!==b.receiver.volume.muted?!0:!1},Ij=function(a){ua(a)?a.forEach(Ij):xa(a)&&Object.keys(a).forEach(function(b){null===a[b]?delete a[b]:(xa(a[b])||ua(a[b]))&&Ij(a[b])})},Jj=function(a,b){return a.namespaces.some(function(a){return a.name==b})},Kj=["MultizoneLeader","MultizoneFollower"],Dj=function(a){return null!==a&&"MultizoneLeader"==a.appId},Lj=function(a){return"E8C28D3C"==a||"00000000-0000-0000-0000-000000000000"==
a};var Mj=function(a){this.rd=a;this.a=B("mr.cast.SessionLauncher")};Mj.prototype.qx=function(a,b){ih("MediaRouter.Cast.Session.Type",0,Oi);return this.rd.D5(a,b).then(t(this.FY,this,b),function(a){a&&uj==a?Vi(1):Vi(0);return H(a)})};Mj.prototype.FY=function(a,b){F(this.a,"Got launch result from "+a.getId());if("LAUNCH_ERROR"==b.type)throw Vi(2),Error(b.reason);a=Fj(a,b.status);E(this.a,"Launched session: "+a.sessionId);return a};var Nj=function(a,b,c,e){this.type=a;this.message=b;this.sequenceNumber=l(c)?c:-1;this.timeoutMillis=e||0;this.clientId=""};var Oj=function(a,b){this.Wg=a;this.Ob=b;this.fH=[];this.Ii=new qj},Pj=function(a,b){pj.call(this,a,3E4);this.wb=b};w(Pj,pj);Pj.prototype.Lx=function(){this.wb.resolve(!1)};d=Oj.prototype;d.a=B("mr.cast.ApiMessenger");d.Kq=function(a){return(a=this.Ob.zd(a))?a.routeId:null};d.listen=function(a,b){this.fH[a]=b};d.Wf=function(a,b,c){F(this.a,"Sending to "+b);F(this.a,JSON.stringify(c));c.clientId=b;this.Wg.RR(a,c)};
d.Vf=function(a,b){var c=this.Ob.zd(a);c&&c.Tw?this.Wf(c.routeId,a,b):this.connect(a).then(function(c){c?(c=this.Kq(a))?this.Wf(c,a,b):D(this.a,"No route for "+a):D(this.a,"No connected client "+a)},null,this)};d.In=function(a){F(this.a,"App "+a);var b=this.Kq(a);if(b){if(b=this.Ii.bo(b))(a=this.Ob.zd(a))?(a.Tw=!0,b.wb.resolve(!0)):b.wb.resolve(!1)}else D(this.a,"No route for client "+a)};
d.S0=function(a){F(this.a,"Received: "+a);a=JSON.parse(a);var b=a.clientId;"client_connect"==a.type?this.In(b):this.Kq(b)?(b=this.fH[a.type])&&b(a):D(this.a,"No route for "+b)};d.connect=function(a){if(this.d_(a))return G(!0);var b=this.Kq(a);if(!b)return D(this.a,"No route for client "+a),G(!1);if(a=this.Ii.ai(b))return a.wb.promise;var c=I();a=new Pj(b,c);this.Ii.dB(a);return c.promise};d.d_=function(a){a=this.Ob.zd(a);return null!=a&&a.Tw};var Qj=function(a,b){this.ck=this.We=this.Tf="";this.ub=null;this.Rh=this.gd="";this.Dd=this.r_=!1;var c;a instanceof Qj?(this.Dd=l(b)?b:a.Dd,this.Ms(a.Tf),this.Gz(a.en()),this.Al(a.yf()),this.El(a.Eb()),this.lh(a.gd),this.Is(a.Nf.clone()),this.Ds(a.Rh)):a&&(c=String(a).match(df))?(this.Dd=!!b,this.Ms(c[1]||"",!0),this.Gz(c[2]||"",!0),this.Al(c[3]||"",!0),this.El(c[4]),this.lh(c[5]||"",!0),this.Is(c[6]||"",!0),this.Ds(c[7]||"",!0)):(this.Dd=!!b,this.Nf=new Rj(null,null,this.Dd))};d=Qj.prototype;
d.toString=function(){var a=[],b=this.Tf;b&&a.push(Sj(b,Tj,!0),":");var c=this.yf();if(c||"file"==b)a.push("//"),(b=this.en())&&a.push(Sj(b,Tj,!0),"@"),a.push(encodeURIComponent(String(c)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),c=this.Eb(),null!=c&&a.push(":",String(c));if(c=this.gd)this.Yq()&&"/"!=c.charAt(0)&&a.push("/"),a.push(Sj(c,"/"==c.charAt(0)?Uj:Vj,!0));(c=this.JU())&&a.push("?",c);(c=this.Rh)&&a.push("#",Sj(c,Wj));return a.join("")};
d.resolve=function(a){var b=this.clone(),c=a.DZ();c?b.Ms(a.Tf):c=a.GZ();c?b.Gz(a.en()):c=a.Yq();c?b.Al(a.yf()):c=a.aG();var e=a.gd;if(c)b.El(a.Eb());else if(c=a.$F()){if("/"!=e.charAt(0))if(this.Yq()&&!this.$F())e="/"+e;else{var f=b.gd.lastIndexOf("/");-1!=f&&(e=b.gd.substr(0,f+1)+e)}f=e;if(".."==f||"."==f)e="";else if(-1!=f.indexOf("./")||-1!=f.indexOf("/.")){for(var e=Ea(f,"/"),f=f.split("/"),g=[],k=0;k<f.length;){var n=f[k++];"."==n?e&&k==f.length&&g.push(""):".."==n?((1<g.length||1==g.length&&
""!=g[0])&&g.pop(),e&&k==f.length&&g.push("")):(g.push(n),e=!0)}e=g.join("/")}else e=f}c?b.lh(e):c=a.zZ();c?b.Is(a.gU()):c=a.oZ();c&&b.Ds(a.Rh);return b};d.clone=function(){return new Qj(this)};d.Ms=function(a,b){this.Oh();if(this.Tf=b?Xj(a,!0):a)this.Tf=this.Tf.replace(/:$/,"");return this};d.DZ=function(){return!!this.Tf};d.en=function(){return this.We};d.Gz=function(a,b){this.Oh();this.We=b?Xj(a):a;return this};d.GZ=function(){return!!this.We};d.yf=function(){return this.ck};
d.Al=function(a,b){this.Oh();this.ck=b?Xj(a,!0):a;return this};d.Yq=function(){return!!this.ck};d.Eb=function(){return this.ub};d.El=function(a){this.Oh();if(a){a=Number(a);if(isNaN(a)||0>a)throw Error("Bad port number "+a);this.ub=a}else this.ub=null;return this};d.aG=function(){return null!=this.ub};d.lh=function(a,b){this.Oh();this.gd=b?Xj(a,!0):a;return this};d.$F=function(){return!!this.gd};d.zZ=function(){return""!==this.Nf.toString()};
d.Is=function(a,b){this.Oh();a instanceof Rj?(this.Nf=a,this.Nf.sz(this.Dd)):(b||(a=Sj(a,Yj)),this.Nf=new Rj(a,null,this.Dd));return this};d.JU=function(){return this.Nf.toString()};d.gU=function(){return this.Nf.Zaa()};d.Ds=function(a,b){this.Oh();this.Rh=b?Xj(a):a;return this};d.oZ=function(){return!!this.Rh};d.Oh=function(){if(this.r_)throw Error("Tried to modify a read-only Uri");};d.sz=function(a){this.Dd=a;this.Nf&&this.Nf.sz(a);return this};
var Xj=function(a,b){return a?b?decodeURI(a.replace(/%25/g,"%2525")):decodeURIComponent(a):""},Sj=function(a,b,c){return q(a)?(a=encodeURI(a).replace(b,Zj),c&&(a=a.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),a):null},Zj=function(a){a=a.charCodeAt(0);return"%"+(a>>4&15).toString(16)+(a&15).toString(16)},Tj=/[#\/\?@]/g,Vj=/[\#\?:]/g,Uj=/[\#\?]/g,Yj=/[\#\?@]/g,Wj=/#/g,Rj=function(a,b,c){this.Qa=this.tb=null;this.xg=a||null;this.Dd=!!c};
Rj.prototype.tf=function(){if(!this.tb&&(this.tb=new z,this.Qa=0,this.xg)){var a=this;ff(this.xg,function(b,c){a.add(decodeURIComponent(b.replace(/\+/g," ")),c)})}};var ak=function(a,b,c){b=Jc(a);if("undefined"==typeof b)throw Error("Keys are undefined");c=new Rj(null,null,c);a=Ic(a);for(var e=0;e<b.length;e++){var f=b[e],g=a[e];ua(g)?c.KL(f,g):c.add(f,g)}return c};d=Rj.prototype;d.P=function(){this.tf();return this.Qa};
d.add=function(a,b){this.tf();this.Ik();a=this.pk(a);var c=this.tb.get(a);c||this.tb.set(a,c=[]);c.push(b);this.Qa+=1;return this};d.remove=function(a){this.tf();a=this.pk(a);return this.tb.ab(a)?(this.Ik(),this.Qa-=this.tb.get(a).length,this.tb.remove(a)):!1};d.clear=function(){this.Ik();this.tb=null;this.Qa=0};d.Gb=function(){this.tf();return 0==this.Qa};d.ab=function(a){this.tf();a=this.pk(a);return this.tb.ab(a)};d.Oj=function(a){var b=this.B();return lb(b,a)};
d.ob=function(){this.tf();for(var a=this.tb.B(),b=this.tb.ob(),c=[],e=0;e<b.length;e++)for(var f=a[e],g=0;g<f.length;g++)c.push(b[e]);return c};d.B=function(a){this.tf();var b=[];if(q(a))this.ab(a)&&(b=tb(b,this.tb.get(this.pk(a))));else{a=this.tb.B();for(var c=0;c<a.length;c++)b=tb(b,a[c])}return b};d.set=function(a,b){this.tf();this.Ik();a=this.pk(a);this.ab(a)&&(this.Qa-=this.tb.get(a).length);this.tb.set(a,[b]);this.Qa+=1;return this};
d.get=function(a,b){a=a?this.B(a):[];return 0<a.length?String(a[0]):b};d.KL=function(a,b){this.remove(a);0<b.length&&(this.Ik(),this.tb.set(this.pk(a),ub(b)),this.Qa+=b.length)};d.toString=function(){if(this.xg)return this.xg;if(!this.tb)return"";for(var a=[],b=this.tb.ob(),c=0;c<b.length;c++)for(var e=b[c],f=encodeURIComponent(String(e)),e=this.B(e),g=0;g<e.length;g++){var k=f;""!==e[g]&&(k+="="+encodeURIComponent(String(e[g])));a.push(k)}return this.xg=a.join("&")};d.Zaa=function(){return Xj(this.toString())};
d.Ik=function(){this.xg=null};d.clone=function(){var a=new Rj;a.xg=this.xg;this.tb&&(a.tb=this.tb.clone(),a.Qa=this.Qa);return a};d.pk=function(a){a=String(a);this.Dd&&(a=a.toLowerCase());return a};d.sz=function(a){a&&!this.Dd&&(this.tf(),this.Ik(),this.tb.forEach(function(a,c){var e=c.toLowerCase();c!=e&&(this.remove(c),this.KL(e,a))},this));this.Dd=a};d.extend=function(a){for(var b=0;b<arguments.length;b++)Lc(arguments[b],function(a,b){this.add(b,a)},this)};var bk=function(a,b,c,e,f,g,k,n){this.cu=a;this.td=b||null;this.up=c||null;this.Vp=e||null;this.yr=l(f)?f:null;this.du=g||null;this.JC=k||null;this.Pw=n||!1},ck=/(^\w+)(?:\(([\w,\ ]*)\))?$/,dk=function(a,b){return(a=a.match(b+"=([^/]*)"))?a[1]:null},ek=function(a){a=a.match(/__castAppId__=([^/]*)/g);return null==a?[]:eb(fb(a,function(a){a=dk(a,"__castAppId__");if(!a)return null;a=a.match(ck);if(!a||0==a.length)return null;var c=[];3==a.length&&a[2]&&(c=a[2].split(","));return{appId:a[1],capabilities:c}}),
function(a){return null!=a})},fk=function(a){return dk(a,"__castClientId__")};d=bk.prototype;d.Jm=function(){return fb(this.cu,function(a){return a.appId})};d.GD=function(){return this.du};d.jc=function(){return this.td};d.Ev=function(){return this.up?this.up:chrome.cast.Ye.TAB_AND_ORIGIN_SCOPED};d.hU=function(){return this.Vp?this.Vp:chrome.cast.Zo.CREATE_SESSION};d.vV=function(){return null==this.yr?chrome.cast.timeout.requestSession:this.yr};
d.toString=function(){var a=new Qj;a.Ms("https");a.Al("google.com");a.lh("/cast");var b=[];x(this.cu,function(a){var e="__castAppId__="+a.appId;a.capabilities&&0<a.capabilities.length&&(e=e+"("+a.capabilities.join(","),e+=")");b.push(e)});this.td&&b.push("__castClientId__="+this.td);this.up&&b.push("__castAutoJoinPolicy__="+this.up);this.Vp&&b.push("__castDefaultActionPolicy__="+this.Vp);null!=this.yr&&b.push("__castLaunchTimeout__="+this.yr);this.du&&b.push("__dialAppName__="+this.du);this.JC&&b.push("__dialPostData__="+
this.JC);this.Pw&&b.push("__castInvisibleSender__=true");a.Ds(b.join("/"));return a.toString()};d.x_=function(a){var b=this.Jm(),c=gk(a);return gb(b,function(a){return lb(c,a)})};
var hk=function(a){a=new Qj(a);if("https"!=a.Tf||"google.com"!=a.yf()||"/cast"!=a.gd)return null;var b=a.Rh;a=ek(b);if(!a||0==a.length)return null;var c=fk(b),e=dk(b,"__castAutoJoinPolicy__"),f=dk(b,"__castDefaultActionPolicy__"),g;g=dk(b,"__castLaunchTimeout__");null==g?g=null:(g=Number(g),g=!isNaN(g)&&0<=g?g:null);var k=dk(b,"__dialAppName__"),n=dk(b,"__dialPostData__"),b=dk(b,"__castInvisibleSender__");return new bk(a,c,e,f,g,k,n,null===b?null:"true"==b)},gk=function(a){return(a=hk(a))?a.Jm():
null},ik=function(a){return(a=hk(a))?a.jc():null};var jk=function(a,b,c,e,f,g){this.Qf=a;this.Y=b;this.Ob=c;this.na=e;this.Ic=f;this.Wg=g;this.Yc=new Oj(g,c);this.K4=new Aj(this.Qf);this.Q6=new Mj(this.Qf)};d=jk.prototype;d.a=B("mr.cast.ApiHandler");d.init=function(){this.Ob.init();this.Yc.listen("v2_message",this.I2.bind(this));this.Yc.listen("app_message",this.X0.bind(this));this.Yc.listen("leave_session",this.E1.bind(this))};d.ke=function(a,b){this.Yc.S0(b)};
d.Yy=function(a,b,c,e){a=this.na.RD(a);c&&0==a.length&&a.push(c.clientId);a.slice().forEach(function(a){a!=e&&this.YJ(a,b)},this)};d.YJ=function(a,b){b.clientId=a;this.Yc.Vf(a,b)};d.aK=function(a,b,c){b={receiver:Cj(b),action:c};this.YJ(a,new Nj("receiver_action",b))};
d.I2=function(a){var b=a.message,c=b.sessionId;if(c){var e=this.na.sw(c);if(e)if(c=this.na.lF(c))if(c=this.Y.W(c))switch(b.type){case "STOP":this.U0(a,c);break;case "LOAD":case "PAUSE":case "PLAY":case "SEEK":case "STOP_MEDIA":case "MEDIA_SET_VOLUME":case "MEDIA_GET_STATUS":case "EDIT_TRACKS_INFO":case "QUEUE_LOAD":case "QUEUE_INSERT":case "QUEUE_UPDATE":case "QUEUE_REMOVE":case "QUEUE_REORDER":this.R0(a,c,e);break;case "SET_VOLUME":this.T0(a,c);break;default:D(this.a,"Unknown request")}else this.wl(a,
chrome.cast.Ze.INVALID_PARAMETER,"No receiver");else this.wl(a,chrome.cast.Ze.INVALID_PARAMETER,"No sink ID");else this.wl(a,chrome.cast.Ze.INVALID_PARAMETER,"Unknown session ID")}else this.wl(a,chrome.cast.Ze.INVALID_PARAMETER,"No session ID")};d.wl=function(a,b,c){b=new chrome.cast.Error(b,c);this.Xy(a,b)};d.Xy=function(a,b){this.Yc.Vf(a.clientId,new Nj("error",b,a.sequenceNumber))};
d.U0=function(a,b){var c=a.message;hh("MediaRouter.Cast.Session.End");var e=c.sessionId,f=this.na.ee(e);f&&(f.mr=!0);this.Qf.sendRequest(c,b,Di,a.timeoutMillis,a.clientId).Gc(function(){this.pl(e,a)},this)};d.R0=function(a,b,c){var e=a.message,f=e.type;f in lj&&(e.type=lj[f]);this.Qf.sendRequest(e,b,Ei,a.timeoutMillis,a.clientId,c.transportId).then(function(b){this.XI(c,b);this.Yc.Vf(a.clientId,new Nj("v2_message",b,a.sequenceNumber))},function(b){this.Xy(a,b)},this)};
d.T0=function(a,b){var c=a.message;delete c.sessionId;this.Qf.sendRequest(c,b,Di,a.timeoutMillis,a.clientId).then(function(){this.Yc.Vf(a.clientId,new Nj("v2_message",null,a.sequenceNumber))},function(b){this.Xy(a,b)},this)};
d.X0=function(a){var b=a.message,c=b.sessionId;if(c){var e=this.na.lF(c);e?(e=this.Y.W(e))?(c=this.na.sw(c),jb(c.namespaces,function(a){return a.name==b.namespaceName})?this.Ic.us(e,b.namespaceName,b.message,a.clientId,c.transportId).then(function(){this.Yc.Vf(a.clientId,new Nj("app_message",null,a.sequenceNumber))},function(){this.wl(a,chrome.cast.Ze.CHANNEL_ERROR,"Channel to receiver not available")},this):this.wl(a,chrome.cast.Ze.INVALID_PARAMETER,"Invalid namespace")):D(this.a,"No receiver from sinkId"):
D(this.a,"No sinkId from sessionId")}else D(this.a,"No sessionId")};d.t5=function(a){a.Nd.slice().forEach(function(a){this.Wg.tX(a)||this.Wg.ol(a,!0)}.bind(this))};d.Rr=function(a){(a=this.na.Zm(a))&&a.session&&this.pl(a.session.sessionId)};
d.E1=function(a){E(this.a,"Leave session");var b=a.message,c=this.na.ee(b);if(c){var e=a.clientId,f=this.Ob.zd(e);if(f){var g=[],k=[],n=f.tabId,v=f.origin,A=f.autoJoinPolicy;c.jf.forEach(function(a){var b=this.Ob.zd(a);A==chrome.cast.Ye.TAB_AND_ORIGIN_SCOPED&&n==b.tabId&&v==b.origin||A==chrome.cast.Ye.ORIGIN_SCOPED&&v==b.origin?g.push(a):k.push(a)},this);this.Yc.Vf(e,new Nj("leave_session",null,a.sequenceNumber));g.forEach(function(a){this.Yc.Vf(a,new Nj("disconnect_session",b))},this);c.jf=k}else D(this.a,
"No client record")}else D(this.a,"No session")};d.aJ=function(a,b){Jj(a,Ei)&&this.Qf.sendRequest(new mj,b,Ei,void 0,void 0,a.transportId).va(p)};d.bJ=function(a,b){var c=a.getId();E(this.a,"Query status for "+c);this.K4.taa(a).then(function(e){this.oI(c,e);b&&(e=this.na.Mq(c))&&this.aJ(e,a)},p,this)};d.o2=function(a,b){Gi.hasOwnProperty(b.namespace_)?this.l2(a,b):this.k2(a,b)};
d.D_=function(a){if("*"==a.destinationId)return!0;a=a.destinationId;if(a==this.Ic.fF()||null!=this.Ob.zd(a))return!0;E(this.a,"Invalid destination "+a);return!1};
d.l2=function(a,b){F(this.a,"Cast message: "+JSON.stringify(b));if(this.D_(b))if(b.namespace_==Fi)(a=this.na.Zm(a))&&a.Nd.forEach(function(a){this.Wg.QR(a,b)}.bind(this));else{var c=JSON.parse(b.data),e=this.LY(c),e=e?e.sourceId:void 0;switch(c.type){case "RECEIVER_STATUS":this.oI(a,c);break;case "MEDIA_STATUS":this.n2(a,b,e)}}else this.Ic.fC(a,b.destinationId,b.sourceId,!0)};
d.LY=function(a){var b=this.Qf.bo(a.requestId);if(!b)return null;var c=b.wb;switch(a.type){case "LAUNCH_ERROR":case "INVALID_REQUEST":case "LOAD_CANCELLED":case "LOAD_FAILED":case "INVALID_PLAYER_STATE":delete a.requestId,c.reject(new chrome.cast.Error(chrome.cast.Ze.SESSION_ERROR,a.reason||a.type,a));default:c.resolve(a)}return b};
d.k2=function(a,b){F(this.a,"App message: "+JSON.stringify(b));if(a=this.na.Mq(a)){var c=[],c="*"==b.destinationId?this.na.RD(a.sessionId):[b.destinationId],e=new zj(a.sessionId,b.namespace_,b.data);c.forEach(function(a){this.Yc.Vf(a,new Nj("app_message",e))},this)}else D(this.a,"No session for incoming app message")};
var kk=function(a,b){a.forEach(function(a){a.sessionId=b;var e=a.supportedMediaCommands,f=[];e&1&&f.push(chrome.cast.media.bm.PAUSE);e&2&&f.push(chrome.cast.media.bm.SEEK);e&4&&f.push(chrome.cast.media.bm.STREAM_VOLUME);e&8&&f.push(chrome.cast.media.bm.STREAM_MUTE);a.supportedMediaCommands=f});return a};d=jk.prototype;d.XI=function(a,b){a=a.sessionId;b.sessionId=a;this.na.e$(a,kk(b.status,a))};d.R1=function(a,b,c){this.Yc.Vf(c,new Nj("new_session",a));this.aJ(a,b)};
d.ks=function(a){if(a=this.na.Mq(a)){a=a.sessionId;var b=this.na.ee(a);b&&b.mr||this.pl(a)}};d.pl=function(a,b){this.Yy(a,new Nj("remove_session",a,b?b.sequenceNumber:void 0),b);(b=this.na.ee(a))&&this.t5(b);this.na.pl(a)};
d.oI=function(a,b){F(this.a,"Receiver status for "+a);var c=b.status;if(c)if(b=this.Y.W(a)){var c=Fj(b,c),e=this.na.Zm(a);e?c?c.sessionId==e.session.sessionId?this.XY(e,c):(this.LF(a),this.Wg.ye(null,b,null,c)):this.LF(a):c&&this.Wg.ye(null,b,null,c)}else hh("MediaRouter.Cast.Error.Sink.Missing.From.Discovery.Service"),D(this.a,"Got message from receiver "+a+", but sink is no longer available.")};
d.XY=function(a,b){var c=a.session;Hj(c,b)&&(F(this.a,"Updating session "+b.sessionId),c.statusText=b.statusText,c.namespaces=b.namespaces,c.receiver.volume=b.receiver.volume,this.Wg.Eba(a),this.Yy(c.sessionId,new Nj("update_session",c),void 0))};d.LF=function(a){this.ks(a,"receiver-app-end");Ti(1)};d.n2=function(a,b,c){if(a=this.na.Mq(a))if(b=JSON.parse(b.data))this.XI(a,b),this.Yy(b.sessionId,new Nj("v2_message",b),void 0,c)};
d.FQ=function(a,b){var c=Gj(b.qd);return(b=jb(a.cu,function(a){return hb(a.capabilities,function(a){return lb(c,a)})}))?b.appId:a.Jm()[0]};d.qx=function(a,b){var c=hk(a);if(!c)return H(Error("Invalid source "+a));a=this.FQ(c,b);var c=c.vV(),e=new $g("MediaRouter.Cast.Session.Launch");return this.Q6.qx(new chrome.cast.LA(a,void 0,c),b).then(function(a){e.end("Success");return G(a)},function(a){e.end("Failure");return H(a)},this)};var lk=B("mr.RuntimeErrorUtils"),mk=function(){chrome.runtime.lastError&&lk.nD(chrome.runtime.lastError.message||"unknown runtime error")};var nk=function(){this.a=B("mr.cast.ChannelFactory");this.fy=new z;this.gy=new z;this.Pn=new z};d=nk.prototype;d.Mj=function(a,b){var c=a.getId(),e=a.qa+":"+a.Eb(),f=this.fy.get(c);if(f){if(this.Pn.get(c)==e)return F(this.a,"Using pending creation to "+c),f;E(this.a,"Device "+c+" IP changed from "+this.Pn.get(a.getId())+" to "+e);this.KO(a)}a=this.VR(a,b).then(function(a){this.Hu(c);return a},function(a){e==this.Pn.get(c)&&this.Hu(c);return H(a)},this);this.fy.set(c,a);this.Pn.set(c,e);return a};
d.KO=function(a){a=a.getId();F(this.a,"Aborting connection to device "+a);var b=this.gy.get(a);b&&b.abort();this.Hu(a)};d.Hu=function(a){this.fy.remove(a);this.gy.remove(a);this.Pn.remove(a)};d.VR=function(a,b){if(1===b)return this.zI(a);var c=r(b)&&1<b?b:3;b=new Qf(t(this.zI,this,a),1E3,c);this.gy.set(a.getId(),b);return b.zs(1.5).start().then(null,function(b){E(this.a,"Failed to create channel to "+a.getId()+" after "+c+" attempts.");return H(b)},this)};
d.zI=function(a){var b=ok++;E(this.a,"Connecting to (id "+b+") "+a.getId());var c=new $g("MediaRouter.Cast.Mdns.Channel.Open");return this.K2(a).then(function(a){E(this.a,"Channel opened (id "+b+"): "+JSON.stringify(a));c.end("Success");return a},function(a){E(this.a,"Channel did not open (id "+b+").");c.end("Failure");return H(a)},this)};var ok=0;
nk.prototype.K2=function(a){a={ipAddress:a.qa,port:a.Eb(),auth:"ssl_verified",timeout:1E4,livenessTimeout:1E4,pingInterval:5E3,capabilities:0};E(this.a,"Opening channel to "+JSON.stringify(a));var b=I();chrome.cast.channel.open(a,t(function(a){mk();"open"==a.readyState?b.resolve(a):(chrome.cast.channel.close(a,function(){chrome.runtime.lastError||F(this.a,"Channel close success")}.bind(this)),b.reject(Error(a.errorState)))},this));return b.promise};var pk=function(a,b,c,e){return{namespace_:a,data:q(b)?b:JSON.stringify(b),sourceId:c,destinationId:e}};var rk=function(a){this.type="CONNECT";this.origin={};this.userAgent=ac;var b=this.userAgent.indexOf("(")+1,b=this.userAgent.substr(b,this.userAgent.indexOf(")",b)-1-b+1);this.senderInfo={sdkType:2,version:chrome.runtime.getManifest().version,browserVersion:vi,platform:qk(),systemVersion:b,connectionType:1};this.connType=a?0:2},qk=function(){switch(nh()){case "ChromeOS":return 5;case "Windows":return 3;case "Mac":return 4;case "Linux":return 6}return 0};var sk=function(){this.Xe=new z};ra(sk);d=sk.prototype;d.init=function(){nf(this)};d.Wx=function(a,b,c,e){this.eC(a,b,c,!1);var f=pk(Ci,new rk(e),b,c);chrome.cast.channel.send(a,f,t(this.zD,this));this.Xe.set(this.bx(a,b,c),e)};d.eC=function(a,b,c,e){if(this.mG(a,b,c)){var f=0;this.Xe.forEach(function(a,b){b=b.split("#")[2];a&&b==c&&f++});if(e||1<f)this.tJ(a,b,c),b=pk(Ci,{type:"CLOSE"},b,c),chrome.cast.channel.send(a,b,t(this.zD,this))}};d.tJ=function(a,b,c){this.Xe.remove(this.bx(a,b,c))};
d.v5=function(a){this.Xe.ob().forEach(function(b){b.split("#")[0]==a.channelId.toString()&&this.Xe.remove(b)},this)};d.L0=function(a,b){this.Xe.forEach(function(c,e){var f=e.split("#");f[0]==a.channelId.toString()&&(this.Wx(b,f[1],f[2],c),this.Xe.remove(e))},this)};d.rS=function(a,b,c){this.mG(a,b,c)||this.Wx(a,b,c,0==c.indexOf("receiver-0"))};d.mG=function(a,b,c){return this.Xe.ab(this.bx(a,b,c))};d.zD=function(){mk()};d.bx=function(a,b,c){return[a.channelId,b,c].join("#")};
var tk=function(a){this.ZM=a};sk.prototype.la=function(){return"cast.VirtualConnectionManager"};sk.prototype.getData=function(){var a=this.Xe.b();return[new tk(a)]};sk.prototype.eb=function(){var a=kf(this);if(a)for(var b in a.ZM)this.Xe.set(b,a.ZM[b])};var uk=function(a,b){this.Eu=b;this.kd=a;this.a=B("mr.cast.ChannelService");this.$g=new z;this.pg=new z;this.qj=sk.M();this.wQ=new nk;this.W=null};d=uk.prototype;d.init=function(){chrome.cast.channel.onMessage.addListener(t(this.d1,this));chrome.cast.channel.onError.addListener(t(this.b1,this));this.qj.init();nf(this)};d.fF=function(){return this.kd};d.us=function(a,b,c,e,f){var g=e||this.kd,k=f||"receiver-0";return this.Mj(a).then(function(a){return this.J6(a,b,c,g,k)},null,this)};
d.L2=function(a,b,c,e){return this.Mj(a).then(function(a){this.qj.Wx(a,b,c,e)},null,this)};d.fC=function(a,b,c,e){(a=this.$g.get(a))&&this.qj.eC(a,b,c,e)};
d.d1=function(a,b){var c=this.pg.get(a.channelId);if(c){var e=this.W(c);if(e){if(Gi.hasOwnProperty(b.namespace_)){c=JSON.parse(b.data);if("CLOSE"==c.type){this.qj.tJ(a,b.destinationId,b.sourceId);return}E(this.a,"Got message "+(c.type||c.responseType)+" from "+e.getId())}else E(this.a,"Got message in "+b.namespace_+" from "+e.getId());this.Eu.c1(e,b)}else D(this.a,"Receiver "+c+" not found.")}else D(this.a,"This message is from unknown receiver.")};
d.gC=function(a){chrome.cast.channel.close(a,function(){chrome.runtime.lastError||F(this.a,"Channel close success")}.bind(this));var b=this.pg.get(a.channelId);b&&(this.pg.remove(a.channelId),this.$g.remove(b))};d.b1=function(a,b){D(this.a,"Channel error: "+JSON.stringify(a)+(b?", "+JSON.stringify(b):""));b&&this.TO(b.errorState,b);this.dC(a)};
d.TO=function(a,b){switch(a){case "unknown":a=0;break;case "authentication_error":a=1;break;case "connect_error":a=2;break;default:return}if(b){if(-8192<=b.nssErrorCode&&-7192>b.nssErrorCode||2==b.challengeReplyErrorType||8==b.challengeReplyErrorType||9==b.challengeReplyErrorType||11==b.challengeReplyErrorType||-200>=b.netReturnValue&&-300<b.netReturnValue||30==b.eventType||31==b.eventType||32==b.eventType)a=3;if(26==b.eventType||-201==b.netReturnValue||-8181==b.nssErrorCode||-8162==b.nssErrorCode||
-8161==b.nssErrorCode)a=4;-138==b.netReturnValue&&(a=5);if(-8182==b.nssErrorCode||10==b.eventType||12==b.eventType)a=1}D(this.a,"Channel error code: "+a);ih("MediaRouter.Cast.Channel.Error",a,Si)};d.dC=function(a){var b=this.pg.get(a.channelId);this.gC(a);if(b){var c=this.W(b);c&&this.Mj(c).then(function(b){E(this.a,"Re-connected to receiver: "+c.getId());this.qj.L0(a,b);this.Eu.e1(c)},function(){E(this.a,"Failed to re-connect to receiver: "+c.getId());this.qj.v5(a);this.Eu.Ix(c,a.errorState)},this)}};
d.Mj=function(a){var b=a.getId(),c=this.$g.get(b);return c&&"open"==c.readyState?G(c):this.wQ.Mj(a).then(function(a){if(this.pg.ab(a.channelId))return a;this.$g.get(b)&&(D(this.a,"Duplicate channel to a receiver "+b),this.gC(this.$g.get(b)));E(this.a,"Connected to: "+b);this.$g.set(b,a);this.pg.set(a.channelId,b);return a},null,this)};
d.J6=function(a,b,c,e,f){this.qj.rS(a,e,f);Ij(c);var g=pk(b,c,e,f);E(this.a,"Channel is sending message");F(this.a,"....message was: "+JSON.stringify(g));return new fe(function(b,c){chrome.cast.channel.send(a,g,t(function(a){mk();a.errorState?(c(Error("Failed to send message")),this.dC(a)):b(!0)},this))},this)};var vk=function(a,b){this.J4=a;this.xQ=b};uk.prototype.la=function(){return"cast.ChannelService"};uk.prototype.getData=function(){return[new vk(this.$g.b(),this.pg.b())]};
uk.prototype.eb=function(){var a=kf(this);a&&(this.$g.addAll(a.J4),this.pg.addAll(a.xQ))};var wk=function(){this.requestId=0;this.type="GET_APP_AVAILABILITY";this.appId=[]};var xk=function(a,b){this.Qf=a;this.Y=b;this.Vb=new Oc;this.sc=new z};d=xk.prototype;d.a=B("mr.cast.AppDiscoveryService");d.init=function(){nf(this)};d.Dy=function(a){var b=this.sc.get(a);b?b.Gy++:this.sc.set(a,{Gy:1});this.p6()};d.cA=function(a){var b=this.sc.get(a);b&&(b.Gy--,0<b.Gy||(Cc(this.Y.cn(),function(b){switch(b.ae(a)){case "available":b.ro(a,"available_rescan");break;case "unavailable":b.ro(a,"unavailable_rescan")}}),this.sc.remove(a)))};
d.p6=function(){E(this.a,"Scanning sinks for app availability");Cc(this.Y.cn(),this.lo,this)};
d.lo=function(a){Cc(this.sc.xE(),function(b){var c;a:{switch(a.ae(b)){case "unknown":case "available_rescan":case "unavailable_rescan":c=!0;break a}c=!1}if(c){var e=a.getId()+":"+b;this.Vb.contains(e)||(this.Vb.add(e),(new Qf(this.AQ.bind(this,a,b),5500,3)).zs(2).start().then(this.DM.bind(this,a,b),function(){C(this.a,"Failed to get app availability response for "+a.getId()+", appId "+b+" after 3 attempts.");this.DM(a,b,"unknown")},this).Gc(function(){this.Vb.remove(e)},this))}},this)};
d.DM=function(a,b,c){c!=a.ae(b)&&(E(this.a,b+" on "+a.getId()+" is "+c),a.ro(b,c),this.Y.fd(a))};
d.AQ=function(a,b){var c=new wk;c.appId=[b];var e=new $g("MediaRouter.Cast.App.Availability");return this.Qf.sendRequest(c,a,Di,5E3).then(function(a){e.end("Success");F(this.a,"App availability response "+JSON.stringify(a));for(var b in a.availability){if("APP_AVAILABLE"==a.availability[b])return"available";if("APP_UNAVAILABLE"==a.availability[b])return"unavailable"}return"unknown"},function(c){e.end("Failure");C(this.a,"checkAppAvailability_ failed for "+a.getId()+", appId "+b);throw c;},this)};
var yk=function(a){this.Y4=a};xk.prototype.la=function(){return"cast.AppDiscoveryService"};xk.prototype.getData=function(){return[new yk(this.sc.b())]};xk.prototype.eb=function(){var a=kf(this);a&&this.sc.addAll(a.Y4)};var zk=function(a,b,c){this.name="RouteRequestError";this.message=b||"";if(c)this.stack=c;else if(Error.captureStackTrace)Error.captureStackTrace(this,zk);else if(b=Error().stack)this.stack=b;this.errorCode=a};w(zk,Error);var Ak=function(a,b){this.sinks=a;this.origins=b||null},Bk=new Ak([]);var Ck=function(){},Dk=function(a){if(!Ea(a,"urn:x-org.chromium:media:route:"))return null;var b=a.substring(31);if(!b)return null;b=Ya(b,"/",2);if(3!=b.length)return null;var c=Ya(b[1],"-",1);if(2!=c.length)return null;var e=new Ck;e.lpa=a;e.QI=b[0];e.uoa=c[0];e.Kpa=c[1];e.nh=b[2];return e};Ck.prototype.ga=function(){return this.nh};var Ek=function(a,b,c,e,f,g){this.id=a;this.sinkId=b;this.mediaSource=c;this.isLocal=e;this.description=f;this.iconUrl=g;this.allowStop=!0;this.customControllerPath=null;this.forDisplay=!0;this.offTheRecord=!1;this.Rj=e},Fk=function(a,b,c,e,f,g,k){return new Ek("urn:x-org.chromium:media:route:"+a+"/"+b+"-"+c+"/"+e,c,e,f,g,k)};var Gk=function(a,b,c,e){return Fk(c,"cast",b.getId(),a,e,"",null)};var Hk=function(a,b,c,e,f,g){this.routeId=a;this.clientId=b;this.autoJoinPolicy=e;this.origin=f;this.tabId=g;this.Tw=!1},Ik=function(){this.vb=[]};d=Ik.prototype;d.init=function(){nf(this)};d.P=function(){return this.vb.length};d.zd=function(a){return jb(this.vb,function(b){return b.clientId==a})};d.Eg=function(a){return jb(this.vb,function(b){return b.routeId==a})};d.Ut=function(a,b,c,e,f,g){a=new Hk(a,b,c,e,f,g);this.vb.push(a);return a};
d.Ly=function(a){this.vb=eb(this.vb,function(b){return b.clientId!=a})};var Jk=function(a){this.js=a};Ik.prototype.la=function(){return"cast.ClientRecords"};Ik.prototype.getData=function(){return[new Jk(this.vb)]};Ik.prototype.eb=function(){var a=kf(this);a&&(this.vb=a.js)};var Kk=function(a){this.Y=a},Lk=function(a){var b=[];a.forEach(function(a){var e="Receiver-"+a.replace(/\./g,"_"),f=Pf.M().Gj||8009;b.push({serviceName:e+"._googlecast._tcp.local",serviceHostPort:e+":"+f,ipAddress:a,serviceData:["id=mdns:"+e,"ve=02","ca=5","st=1","fn="+e,"md=Chromecast"]})});return b};Kk.prototype.init=function(){var a=Lk(Pf.M().vv);this.Y.kJ(a)};var Mk=chrome.i18n.getMessage("4528089202128275824");chrome.i18n.getMessage("2810417817914017289");chrome.i18n.getMessage("3413021810593924462");chrome.i18n.getMessage("7603034707785674700");chrome.i18n.getMessage("8009014317872238527");chrome.i18n.getMessage("8636962961150071298");chrome.i18n.getMessage("1802762746589457177");var Nk=function(a,b){this.jf=[];this.Nd=[];this.sinkId=a;this.session=b;this.zr=this.xn=null;this.offTheRecord=this.mr=!1};d=Nk.prototype;d.Ut=function(a){if(lb(this.jf,a))return!1;this.jf.push(a);return!0};d.Ly=function(a){return qb(this.jf,a)};d.ye=function(a){if(lb(this.Nd,a))return!1;this.Nd.push(a);return!0};d.ol=function(a){return qb(this.Nd,a)};d.oY=function(a,b){Dj(a)?(this.zr=a,this.xn=b):Dj(this.session)&&(this.zr=this.session,this.xn=this.sinkId,this.session=a,this.sinkId=b);return this};
var Ok=function(){this.a=B("mr.cast.SessionRecords");this.vb=[]};d=Ok.prototype;d.init=function(){nf(this)};d.Wt=function(a,b){E(this.a,"Adding new session: "+b+", "+a.sessionId);var c=this.ee(a.sessionId);if(c)return c.oY(a,b);a=new Nk(b,a);this.vb.push(a);return a};d.pl=function(a){E(this.a,"Removing session "+a);this.vb=eb(this.vb,function(b){return b.session.sessionId!=a})};d.RD=function(a){return(a=this.ee(a))?a.jf:[]};d.Mq=function(a){return(a=this.Zm(a))?a.session:null};
d.zd=function(a){return jb(this.vb,function(b){return lb(b.jf,a)})};d.Eg=function(a){return jb(this.vb,function(b){return lb(b.Nd,a)})};d.WW=function(a){return jb(this.vb,function(b){return null!=jb(b.Nd,function(b){return Dk(b).QI==a})})};d.Zm=function(a){return jb(this.vb,function(b){return b.sinkId==a||b.xn==a})};d.ee=function(a){return jb(this.vb,function(b){return b.session.sessionId==a})};d.lF=function(a){return(a=this.ee(a))?a.sinkId:null};d.sw=function(a){return(a=this.ee(a))?a.session:null};
d.e$=function(a,b){var c=this.sw(a);c&&(a=eb(b,function(a){return a.playerState!=chrome.cast.media.$o.IDLE},this),a.forEach(function(a){if(!a.media){var b=jb(c.media,function(b){return b.mediaSessionId==a.mediaSessionId});b&&(a.media=b.media)}}),c.media=a)};d.k4=function(a){for(var b=0;b<this.vb.length;b++)this.vb[b].Ly(a)};var Pk=function(a){this.js=a};Ok.prototype.la=function(){return"cast.SessionRecords"};Ok.prototype.getData=function(){return[new Pk(this.vb)]};
Ok.prototype.eb=function(){var a=kf(this);if(a)for(var b=0;b<a.js.length;b++){var c=a.js[b],e=new Nk(c.sinkId,c.session);e.jf=c.jf;e.Nd=c.Nd;e.mr=c.mr;e.zr=c.zr;e.xn=c.xn;this.vb.push(e)}};var Qk=function(a){this.kd="sender-"+Ua();this.$a=new z;this.oi=null;nf(this);this.v=a;this.Ob=new Ik;this.na=new Ok;this.Ic=new uk(this.kd,this);this.Y=new gj(this.Ic,this);this.AR=new Kk(this.Y);this.rd=new sj(this.Ic,this.kd);this.Zc=new xk(this.rd,this.Y);this.pd=new jk(this.rd,this.Y,this.Ob,this.na,this.Ic,this);this.NB=new yj(this.Y,this.rd);this.oaa=this.Y.start.bind(this.Y)};d=Qk.prototype;d.a=B("mr.CastProvider");d.getName=function(){return"cast"};
d.Ed=function(){this.rd.init();this.na.init();this.pd.init();this.Ic.init();this.Y.init();this.AR.init();this.Zc.init();this.v.Ey(this.oaa)};d.Df=function(){return this.$a.B()};d.Km=function(a){var b=new Oc;this.tq(a).forEach(function(a){this.Y.GX(a).map(function(a){return a.Bg()}).forEach(function(a){b.add(a)})}.bind(this));return new Ak(b.B(),-1!=a.indexOf("0F5096E8")?th:null)};d.jj=function(a){this.tq(a).forEach(function(a){this.Zc.Dy(a)}.bind(this));this.v.Vw()&&this.Y.start()};d.mj=function(a){this.tq(a).forEach(function(a){this.Zc.cA(a)}.bind(this))};
d.ij=function(){};d.lj=function(){};d.W=function(a){return(a=this.Y.W(a))?a.Bg():null};d.x6=function(a){var b=new Zg(Mk,"warning","dismiss");b.routeId=a;this.v.zf().send(b)};d.KF=function(a,b){C(this.a,"Error launching.",b);this.x6(a.id);this.v.onPresentationConnectionClosed(a.id,"error","Launch error");this.ol(a.id,!1)};
d.Zp=function(a,b,c,e,f,g,k){Pf.M().Pi=new Of(b.qc,b.qa);var n=Gk(a,b,c,!0);n.forDisplay=!1;n.offTheRecord=e;this.$a.set(n.id,n);this.v.dl(this,n);this.v.eh(this.la(),!0);(e=hk(a))&&e.jc()&&this.VA(e,n.id,g,k);rh(a)?(n.ie={tabId:k,sessionId:"",PL:b.qa||"",QL:b.qc||""},this.v.Go(this,n,function(e){return this.aH(a,b,c,f,g,k,e)}.bind(this)).then(function(){this.YK(n)},function(a){this.KF(n,a)},this)):this.aH(a,b,c,f,g,k,n).va(function(a){this.KF(n,a)},this);return G(n)};
d.aH=function(a,b,c,e,f,g,k){return this.pd.qx(this.ly(a,b,e),b).then(function(e){this.ye(a,b,c,e,f,g,k);return k},null,this)};d.Ce=function(a,b,c,e,f,g,k){var n=this,v=this.Y.W(b);if(!v)return H(Error("No sink with ID "+b));var A=fk(a);if(A){setTimeout(function(){this.pd.aK(A,v,chrome.cast.cm.CAST)}.bind(this),0);var M=function(){return n.Zp(a,v,c,e,f,g,k)},V=this.Ob.zd(A);if(V)return this.Wc(V.routeId).then(M,M);if(g&&k&&(b=this.vC(a,g,k,e,f,b)))return b}return this.Zp(a,v,c,e,f,g,k)};
d.RR=function(a,b){this.v.ke(this,a,b)};d.QR=function(a,b){var c=this.$a.get(a);c&&c.Rj&&this.v.Pr(this,a,b)};
d.ol=function(a,b){E(this.a,"Remove route "+a);var c=this.Ob.Eg(a);if(c){var e=c.clientId;E(this.a,"Remove client "+e);this.na.k4(e);this.Ob.Ly(e)}if(e=this.na.Eg(a))e.ol(a),this.rH(e.Nd);var f=this.$a.get(a);f&&(f.Rj&&e&&(this.Ic.fC(f.sinkId,c?c.clientId:this.kd,e.session.transportId,b),f.forDisplay&&c&&(this.oi={Jj:c,fK:e})),this.$a.remove(a),this.v.Ei(this,f),this.Df().some(function(a){return a.isLocal})||this.v.eh(this.la(),!1))};
d.Eba=function(a){a.Nd.forEach(function(b){if(b=this.$a.get(b)){var c=a.session;b.ie&&b.forDisplay?this.YK(b):(b.description=c.statusText||c.displayName,this.v.Sg(this,b))}}.bind(this))};d.xba=function(a){gb(a,function(a){a=this.$a.get(a,null);if(!a||!a.mediaSource)return!1;var c=hk(a.mediaSource),c=c?c.Pw:!1;return a.isLocal&&!c},this)&&x(a,function(a){if(a=this.$a.get(a,null))a.isLocal=!0},this)};
d.rH=function(a){var b=[],c=[],e=null;a.forEach(function(a){if(a=this.$a.get(a)){a.forDisplay=!1;var g=hk(a.mediaSource);g&&jb(g.Jm(),Lj)||(a.Rj?(g=g?g.Ev():null,e||g==chrome.cast.Ye.CUSTOM_CONTROLLER_SCOPED||(b.push(a),e=a.sinkId)):e&&e!=a.sinkId?b.push(a):c.push(a))}}.bind(this));x(0<b.length?b:c,function(a){a.forDisplay=!0})};d.VA=function(a,b,c,e){var f=a.jc();f&&!this.Ob.zd(f)&&(E(this.a,"Add client "+f),this.Ob.Ut(b,f,a.Jm(),a.Ev(),c||null,l(e)?e:null))};
d.YK=function(a){var b=this.na.Eg(a.id);b&&(b=b.session,b.statusText=a.description||b.statusText)};
d.ye=function(a,b,c,e,f,g,k){var n=null!=a,v;null==a?(v=new bk([{appId:e.appId,capabilities:e.capabilities}]),a=v.toString()):v=hk(a);var A=k;if(A){if(!this.$a.get(A.id))return D(this.a,"Route "+A.id+" not added"),A}else A=Gk(a,b,c||e.sessionId,n),this.$a.set(A.id,A);c=A.id;E(this.a,"Add route "+c);a=null;v&&(a=v.jc(),this.VA(v,c,f,g));(f=this.na.Zm(b.getId()))||(f=this.na.Wt(e,b.getId()));f.ye(c);A.Rj&&this.Ic.L2(b,a||this.kd,e.transportId,!(v&&v.Pw));f.offTheRecord=A.offTheRecord;v=f.Nd;this.xba(v);
this.rH(v);v=A;g=e.sessionId;c=e.appId;("0F5096E8"==c||"85CDB22F"==c)&&g&&v.ie&&(v.ie.sessionId=g);!Jj(e,Ei)||null!==e&&lb(Kj,e.appId)||(v.customControllerPath="cast_route_details.html?"+["sessionId="+g,"appId="+c].join("&"));v.description=e.statusText||e.displayName;k?this.v.Sg(this,A):(this.v.dl(this,A),A.isLocal&&this.v.eh(this.la(),!0));a&&f.Ut(a)&&this.pd.R1(e,b,a);return A};
d.Wc=function(a){var b=this.$a.get(a);if(!b)return H(new zk(3,"Route in Cast provider not found for routeId  "+a));var c=this.na.Eg(a);if(!c)return this.ol(a,!0),G();var c=c.session.sessionId,e=this.Y.W(b.sinkId);if(!e)return this.pd.pl(c),G();(a=this.Ob.Eg(a))&&this.pd.aK(a.clientId,e,chrome.cast.cm.STOP);Ti(0);var f=I();this.rd.G5(c,e).Gc(function(){this.pd.ks(e.getId(),"close-route");f.resolve()},this);return f.promise};
d.WS=function(a){var b=null;Dc(this.$a.Aw(),function(c){if(!c.Rj)return!1;var e=this.Y.W(c.sinkId);if(!e||!a.x_(this.ly(c.mediaSource,e)))return!1;b=c;return!0},this);if(!b||!b.mediaSource)return null;var c=ik(b.mediaSource);if(!c)return null;var e=this.Ob.zd(c);return e?(c=this.na.zd(c))?{Jj:e,fK:c}:null:null};
d.sP=function(a,b,c){var e=this.WS(a);if(!e){if(!this.oi||this.oi.Jj.origin!=b||this.oi.Jj.tabId!=c)return null;e=this.oi}switch(a.Ev()){case chrome.cast.Ye.PAGE_SCOPED:return null;case chrome.cast.Ye.ORIGIN_SCOPED:if(b!=e.Jj.origin)return null;break;case chrome.cast.Ye.TAB_AND_ORIGIN_SCOPED:if(b!=e.Jj.origin||c!=e.Jj.tabId)return null}return this.na.ee(e.fK.session.sessionId)};
d.vC=function(a,b,c,e,f,g){var k=this,n=null;Dc(this.$a.Aw(),function(a){var b=a.ie;return b&&null!=b.tabId&&b.tabId==c&&qh(a.mediaSource)?(n=a,!0):!1});if(!n)return null;var v=function(){return k.Ce(a,g||n.sinkId,"",e,f,b,null==c?void 0:c)};return this.Wc(n.id).then(v,v)};
d.Fh=function(a,b,c,e,f){if(!hk(a))return H(Error("Unsupported presentation URL"));b=Dk(b);b=this.na.ee(b.QI);if(!b)return H(Error("No matching route"));var g=this.Y.W(b.sinkId);if(!g)return H(Error("No sink"));a=this.ye(a,g,c,b.session,e,f);return G(a)};
d.ni=function(a,b,c,e,f,g){var k=hk(a);if(!k)return H(Error("Unsupported presentation URL"));var n;if(b==chrome.cast.mN){if(n=this.sP(k,f,g),!n&&k.hU()!=chrome.cast.Zo.CAST_THIS_TAB&&(e=this.vC(a,f,g,c,e)))return e}else n=0==b.indexOf(chrome.cast.JA)?this.na.ee(b.substr(chrome.cast.JA.length)):this.na.WW(b);if(!n)return H(Error("No matching route"));if(n.offTheRecord!=c)return H(Error("Off the record mismatch"));e=this.Y.W(n.sinkId);if(!e)return H(Error("No sink"));a=this.ye(a,e,b,n.session,f,g);
a.offTheRecord=c;return G(a)};d.vg=function(a){this.ol(a,!1)};d.Af=function(a){var b=!0,c=!0;if(a=this.Y.W(a))b=a.qd,c=!!(b&1),b=!!(b&4);return hi(b,c)};d.Tm=function(){return"cast_streaming"};
d.ih=function(a,b,c){if(!c)return this.pd.ke(a,b),G();var e=this.na.Eg(a);if(!e)return H(Error("Not managing the route "+a));var f=this.Y.W(e.sinkId);if(!f)return H(Error("Sink no longer accessible"));a=(a=this.Ob.Eg(a))?a.clientId:this.kd;var g=I();this.Ic.us(f,c.namespace,b,a,e.session.transportId).Gc(function(){g.resolve()});return g.promise};d.km=function(a,b){var c=this.Y.W(b);if(!c)return!1;a=this.ly(a,c);return(a=gk(a))&&0!=a.length?gb(a,function(a){return Hi(c.ae(a))}):!1};
d.Ej=function(a,b){var c=this.tq(a);return c&&0!=c.length?b&&b.mediaSource?(a=gk(b.mediaSource),gb(a,function(a){return lb(c,a)},this)):!0:!1};d.tX=function(a){return(a=this.$a.get(a))?fk(a.mediaSource):null};d.ly=function(a,b,c){return rh(a)?(a={appId:0==(b.qd&1)?"85CDB22F":"0F5096E8",capabilities:Gj(b.qd)},(new bk([a],void 0,void 0,void 0,c)).toString()):a};d.tq=function(a){var b=[];rh(a)?(b.push("85CDB22F"),b.push("0F5096E8")):(a=gk(a))&&(b=tb(b,a));return b};
d.Ix=function(a){this.Y.Ix(a.getId());Ti(2)};d.e1=function(a){this.pd.bJ(a,!0)};d.c1=function(a,b){this.NB.uY(a,b);this.pd.o2(a.getId(),b)};d.Fi=function(a){this.v.onSinkAvailabilityUpdated(this,1);this.fd(a);this.pd.bJ(a)};d.Rr=function(a){if(0==this.Y.zc().length)this.v.onSinkAvailabilityUpdated(this,0);this.pd.Rr(a.getId());this.MF()};d.fd=function(a){this.Zc.lo(a);this.MF()};d.MF=function(){this.NB.YY();this.v.Fc()};var Rk=function(a,b,c){this.dK=a;this.routes=b;this.I_=c};Qk.prototype.la=function(){return"cast.Provider"};
Qk.prototype.getData=function(){return[new Rk(this.kd,this.$a.b(),this.oi)]};Qk.prototype.eb=function(){var a=kf(this);a&&(this.kd=a.dK,this.$a.addAll(a.routes),this.oi=a.I_)};Qk.prototype.Uf=function(){return null};var Sk=function(){if(!Tc)return!1;try{return new ActiveXObject("MSXML2.DOMDocument"),!0}catch(a){return!1}},Tk=Tc&&Sk();var Uk=function(){this.$d=[];this.Ae=[]};d=Uk.prototype;d.k0=function(){0==this.$d.length&&(this.$d=this.Ae,this.$d.reverse(),this.Ae=[])};d.enqueue=function(a){this.Ae.push(a)};d.rf=function(){this.k0();return this.$d.pop()};d.P=function(){return this.$d.length+this.Ae.length};d.Gb=function(){return 0==this.$d.length&&0==this.Ae.length};d.clear=function(){this.$d=[];this.Ae=[]};d.contains=function(a){return lb(this.$d,a)||lb(this.Ae,a)};
d.remove=function(a){var b;b=this.$d;var c=cb(b,a);0<=c?(pb(b,c),b=!0):b=!1;return b||qb(this.Ae,a)};d.B=function(){for(var a=[],b=this.$d.length-1;0<=b;--b)a.push(this.$d[b]);for(var c=this.Ae.length,b=0;b<c;++b)a.push(this.Ae[b]);return a};var Vk=function(a,b){se.call(this);this.JH=a||0;this.vi=b||10;if(this.JH>this.vi)throw Error("[goog.structs.Pool] Min can not be greater than max");this.ac=new Uk;this.Jg=new Oc;this.$u=0;this.dx=null;this.gp()};w(Vk,se);d=Vk.prototype;d.getObject=function(){var a=u();if(!(null!=this.dx&&a-this.dx<this.$u)){var b=this.h5();b&&(this.dx=a,this.Jg.add(b));return b}};d.Qi=function(a){return this.Jg.remove(a)?(this.Vt(a),!0):!1};
d.h5=function(){for(var a;0<this.mE()&&(a=this.ac.rf(),!this.Gx(a));)this.gp();!a&&this.P()<this.vi&&(a=this.nf());return a};d.Vt=function(a){this.Jg.remove(a);this.Gx(a)&&this.P()<this.vi?this.ac.enqueue(a):this.Lh(a)};d.gp=function(){for(var a=this.ac;this.P()<this.JH;)a.enqueue(this.nf());for(;this.P()>this.vi&&0<this.mE();)this.Lh(a.rf())};d.nf=function(){return{}};d.Lh=function(a){if("function"==typeof a.mb)a.mb();else for(var b in a)a[b]=null};
d.Gx=function(a){return"function"==typeof a.kQ?a.kQ():!0};d.contains=function(a){return this.ac.contains(a)||this.Jg.contains(a)};d.P=function(){return this.ac.P()+this.Jg.P()};d.nV=function(){return this.Jg.P()};d.mE=function(){return this.ac.P()};d.Gb=function(){return this.ac.Gb()&&this.Jg.Gb()};d.L=function(){Vk.R.L.call(this);if(0<this.nV())throw Error("[goog.structs.Pool] Objects not released");delete this.Jg;for(var a=this.ac;!a.Gb();)this.Lh(a.rf());delete this.ac};var Wk=function(a,b){this.sr=a;this.pj=b};Wk.prototype.getKey=function(){return this.sr};Wk.prototype.nc=function(){return this.pj};Wk.prototype.clone=function(){return new Wk(this.sr,this.pj)};var Xk=function(a){this.Jd=[];a&&this.VZ(a)};d=Xk.prototype;d.insert=function(a,b){var c=this.Jd;c.push(new Wk(a,b));this.K0(c.length-1)};d.VZ=function(a){var b;if(a instanceof Xk){if(b=a.ob(),a=a.B(),0>=this.P()){for(var c=this.Jd,e=0;e<b.length;e++)c.push(new Wk(b[e],a[e]));return}}else b=Jb(a),a=Ib(a);for(e=0;e<b.length;e++)this.insert(b[e],a[e])};d.remove=function(){var a=this.Jd,b=a.length,c=a[0];if(!(0>=b))return 1==b?mb(a):(a[0]=a.pop(),this.J0(0)),c.nc()};
d.J0=function(a){for(var b=this.Jd,c=b.length,e=b[a];a<c>>1;){var f=this.wV(a),g=this.rX(a),f=g<c&&b[g].getKey()<b[f].getKey()?g:f;if(b[f].getKey()>e.getKey())break;b[a]=b[f];a=f}b[a]=e};d.K0=function(a){for(var b=this.Jd,c=b[a];0<a;){var e=this.BW(a);if(b[e].getKey()>c.getKey())b[a]=b[e],a=e;else break}b[a]=c};d.wV=function(a){return 2*a+1};d.rX=function(a){return 2*a+2};d.BW=function(a){return a-1>>1};d.B=function(){for(var a=this.Jd,b=[],c=a.length,e=0;e<c;e++)b.push(a[e].nc());return b};
d.ob=function(){for(var a=this.Jd,b=[],c=a.length,e=0;e<c;e++)b.push(a[e].getKey());return b};d.Oj=function(a){return gb(this.Jd,function(b){return b.nc()==a})};d.ab=function(a){return gb(this.Jd,function(b){return b.getKey()==a})};d.clone=function(){return new Xk(this)};d.P=function(){return this.Jd.length};d.Gb=function(){return 0==this.Jd.length};d.clear=function(){mb(this.Jd)};var Yk=function(){Xk.call(this)};w(Yk,Xk);Yk.prototype.enqueue=function(a,b){this.insert(a,b)};Yk.prototype.rf=function(){return this.remove()};var Zk=function(a,b){this.EC=void 0;this.os=new Yk;Vk.call(this,a,b)};w(Zk,Vk);d=Zk.prototype;d.getObject=function(a,b){if(!a)return(a=Zk.R.getObject.call(this))&&this.$u&&(this.EC=h.setTimeout(t(this.Wq,this),this.$u)),a;this.os.enqueue(l(b)?b:100,a);this.Wq()};d.Wq=function(){for(var a=this.os;0<a.P();){var b=this.getObject();if(b)a.rf().apply(this,[b]);else break}};d.Vt=function(a){Zk.R.Vt.call(this,a);this.Wq()};d.gp=function(){Zk.R.gp.call(this);this.Wq()};
d.L=function(){Zk.R.L.call(this);h.clearTimeout(this.EC);this.os.clear();this.os=null};var $k=function(a,b,c,e){this.ji=a;this.uj=!!e;Zk.call(this,b,c)};w($k,Zk);$k.prototype.nf=function(){var a=new Yf,b=this.ji;b&&b.forEach(function(b,e){a.headers.set(e,b)});this.uj&&a.Iz(!0);return a};$k.prototype.Gx=function(a){return!a.isDisposed()&&!a.Ff()};var al=function(a,b,c,e,f,g){K.call(this);this.Hf=l(a)?a:1;this.cg=l(f)?Math.max(0,f):0;this.$l=new $k(b,c,e,g);this.tc=new z;this.pa=new ki(this)};w(al,K);var bl="ready complete success error abort timeout".split(" ");d=al.prototype;d.Ns=function(a){this.cg=Math.max(0,a)};d.send=function(a,b,c,e,f,g,k,n,v,A){if(this.tc.get(a))throw Error("[goog.net.XhrManager] ID in use");b=new cl(b,t(this.BY,this,a),c,e,f,k,l(n)?n:this.Hf,v,A);this.tc.set(a,b);a=t(this.rY,this,a);this.$l.getObject(a,g);return b};
d.abort=function(a,b){var c=this.tc.get(a);if(c){var e=c.Ct;c.T6(!0);b&&(e&&(this.uJ(e,c.tA),Ue(e,"ready",function(){this.$l.Qi(e)},!1,this)),this.tc.remove(a));e&&e.abort()}};d.rY=function(a,b){var c=this.tc.get(a);c&&!c.Ct?(this.iP(b,c.tA),b.Ns(this.cg),b.vL(c.rl),b.Iz(c.uj),c.Ct=b,this.dispatchEvent(new dl("ready",this,a,b)),this.FJ(a,b),c.RA&&b.abort()):this.$l.Qi(b)};
d.BY=function(a,b){var c=b.target;switch(b.type){case "ready":this.FJ(a,c);break;case "complete":return this.xY(a,c,b);case "success":this.aZ(a,c);break;case "timeout":case "error":this.hn(a,c);break;case "abort":this.pY(a,c)}return null};d.FJ=function(a,b){var c=this.tc.get(a);!c||c.lC||c.Iw()?(c&&(this.uJ(b,c.tA),this.tc.remove(a)),this.$l.Qi(b)):(c.LZ(),b.send(c.getUrl(),c.C0,c.Pj,c.Bq()))};
d.xY=function(a,b,c){var e=this.tc.get(a);if(7==b.Lg||b.Fd()||e.Iw())if(this.dispatchEvent(new dl("complete",this,a,b)),e&&(e.x7(!0),e.kC))return e.kC.call(b,c);return null};d.pY=function(a,b){this.dispatchEvent(new dl("abort",this,a,b))};d.aZ=function(a,b){this.dispatchEvent(new dl("success",this,a,b))};d.hn=function(a,b){this.tc.get(a).Iw()&&this.dispatchEvent(new dl("error",this,a,b))};d.uJ=function(a,b,c){this.pa.od(a,c||bl,b)};d.iP=function(a,b,c){this.pa.listen(a,c||bl,b)};
d.L=function(){al.R.L.call(this);this.$l.mb();this.$l=null;this.pa.mb();this.pa=null;this.tc.clear();this.tc=null};var dl=function(a,b,c,e){J.call(this,a,b);this.id=c;this.Ct=e};w(dl,J);var cl=function(a,b,c,e,f,g,k,n,v){this.st=a;this.C0=c||"GET";this.Pj=e;this.ji=f||null;this.Hf=l(k)?k:1;this.sB=0;this.RA=this.lC=!1;this.tA=b;this.kC=g;this.rl=n||"";this.uj=!!v;this.Ct=null};d=cl.prototype;d.getUrl=function(){return this.st};d.Bq=function(){return this.ji};d.Gq=function(){return this.Hf};d.LZ=function(){this.sB++};
d.Iw=function(){return this.sB>this.Hf};d.x7=function(a){this.lC=a};d.T6=function(a){this.RA=a};var el=function(){this.name="unknown";this.state="error";this.ZZ=null;this.allowStop=!0;this.serviceData=this.Ui=null;this.extraData={}},hl=function(a,b,c){this.re=a;(a=b)||(fl||(fl=new al(3,null,1,10,2E3)),a=fl);this.Yo=a;this.am=[];c||(gl||(gl=new al(0,null,1,10,15E3)),c=gl);this.lN=c;this.a=B("mr.dial.Client")};hl.prototype.abort=function(){this.am.forEach(function(a){this.Yo.abort(a,!0);this.lN.abort(a,!0)},this)};var fl=null,gl=null,il=999;
hl.prototype.launchApp=function(a,b){var c=I(),e=(++il).toString();this.am.push(e);this.lN.send(e,this.Dv(a),"POST",b,null,0,this.pD("launchApp","POST",e,c));return c.promise};hl.prototype.aM=function(a){var b=I(),c=(++il).toString();this.am.push(c);this.Yo.send(c,this.Dv(a),"DELETE",null,null,0,this.pD("stopApp","DELETE",c,b),0);return b.promise};var jl=function(a,b){this.kN=a;this.af=b;this.m6=!!b&&"running"==b.state};
hl.prototype.Cv=function(a){return new fe(function(b){var c=(++il).toString();this.am.push(c);this.Yo.send(c,this.Dv(a),"GET",null,null,0,t(this.w1,this,c,b))},this)};
hl.prototype.w1=function(a,b,c){qb(this.am,a);a=c.target;Rf(this.a,"GetAppInfo","GET",a,!0);if(a.Fd()){c=a.dF();if(!c)if(c=a.vk(),"undefined"!=typeof DOMParser)c=(new DOMParser).parseFromString(c,"application/xml");else if(Tk){var e=new ActiveXObject("MSXML2.DOMDocument");e.resolveExternals=!1;e.validateOnParse=!1;try{e.setProperty("ProhibitDTD",!0),e.setProperty("MaxXMLSize",2048),e.setProperty("MaxElementDepth",256)}catch(n){}e.loadXML(c);c=e}else throw Error("Your browser does not support loading xml documents");
if(c)if((e=c.getElementsByTagName("service"))&&1==e.length){c=new el;for(var f=0,g=e[0].childNodes.length;f<g;f++){var k=e[0].childNodes[f];if("state"==k.nodeName){a:switch(k.textContent){case "running":k="running";break a;case "stopped":k="stopped";break a;default:k="error"}c.state=k}else"name"==k.nodeName?c.name=k.textContent:"link"==k.nodeName?c.Ui=k.getAttribute("href"):"options"==k.nodeName?c.allowStop="false"!=k.getAttribute("allowStop"):c.extraData[k.nodeName]=k.innerHTML}if("unknown"==c.name)E(this.a,
"GET response missing name value"),b(new jl(a,null));else if("error"==c.state)E(this.a,"GET response missing state value"),b(new jl(a,null));else{if((e=/installable=(.+)/.exec(c.state))&&e[1])c.state="installable",c.ZZ=e[1];else if("running"!=c.state&&"stopped"!=c.state){E(this.a,"GET response has invalid state value");b(new jl(a,null));return}b(new jl(a,c))}}else E(this.a,"Invalid GET response (invalid service)"),b(new jl(a,null));else E(this.a,"Empty response"),b(new jl(a,null))}else E(this.a,"Request to "+
a.Eq()+" failed"),b(new jl(a,null))};hl.prototype.Dv=function(a){var b=this.re.wg;"/"!=b.charAt(b.length-1)&&(b+="/");return b+a};hl.prototype.pD=function(a,b,c,e){return t(function(f){qb(this.am,c);f=f.target;Rf(this.a,a,b,f,!0);f.Fd()?e.resolve():e.reject(Error(Sf(f.Lg)))},this)};var kl=function(a,b,c){this.appName=b;this.launchParameter=c||""},ll=B("mr.DialProvider"),nl=function(a){if(Ea(a,"urn:dial-multiscreen-org:dial:application:")){var b=a.indexOf("?"),c=a.substring(42,0<b?b:void 0);a=c&&0<c.length?new kl(a,c,0<b?a.substring(b+1):void 0):null}else a=ml(a);return a},ol=/__dialAppName__=([A-Za-z0-9-._~!$&'()*+,;=%]+)/,pl=/__dialPostData__=([A-Za-z0-9]+={0,2})/,ml=function(a){var b=(new Qj(a)).Rh;if(!b)return null;var c=ol.exec(b),c=c?c[1]:null;if(!c)return null;c=decodeURIComponent(c);
if(b=(b=pl.exec(b))?b[1]:void 0)try{b=Kf(b)}catch(e){return D(ll,"Invalid base64 encoded postData:"+b),null}return new kl(a,c,b)};var ql=function(a,b){this.Za=a;this.appName=b};var rl=function(a){this.hd=new Map;this.St=a};d=rl.prototype;d.init=function(){nf(this)};d.clear=function(){this.hd.clear()};d.add=function(a){this.LD(a.Za.id)||(this.hd.set(a.Za.id,a),this.St.P0(a))};d.LD=function(a){return this.hd.get(a)||null};d.MD=function(a){for(var b=ha(this.hd),c=b.next();!c.done;c=b.next())if(c=ha(c.value),c.next(),c=c.next().value,c.Za.sinkId==a)return c;return null};d.d5=function(a){if(a=this.MD(a))this.hd.delete(a.Za.id),this.St.TH(a)};
d.rJ=function(a){var b=this.hd.get(a);b&&(this.hd.delete(a),this.St.TH(b))};d.Df=function(){return Array.from(this.hd.values(),function(a){return a.Za})};d.kT=function(){return Array.from(this.hd.values())};d.la=function(){return"dial.ActivityRecords"};d.getData=function(){return[Array.from(this.hd)]};d.eb=function(){var a=kf(this);a&&(this.hd=new Map(a))};var sl={sda:0,Bfa:1,Kea:2,rda:3},tl={ERROR:0,bfa:1,EMPTY:2},ul=function(a){ih("MediaRouter.Dial.Create.Route",a,sl)},vl=function(a){ih("MediaRouter.Dial.Device.Description.Failure",a,tl)};var wl=function(a,b){this.a=B("mr.dial.AppDiscoveryService");this.sc=new Set;this.Y=a;this.Xc=b;this.Vb=new Map;this.Ku=new Map;this.te=null;this.ul=!1};d=wl.prototype;d.init=function(){nf(this)};d.start=function(){E(this.a,"Starting periodic scanning.");this.ul||(this.ul=!0,this.QC())};d.stop=function(){E(this.a,"Stopping periodic scanning.");this.ul&&(this.ul=!1,this.te&&(clearTimeout(this.te),this.te=null),this.Vb.clear(),this.Ku.forEach(function(a){a.abort()}))};
d.Dy=function(a){if(!this.sc.has(a)||this.kP(a))this.sc.add(a),0!=this.Y.Oq()&&(this.ul?this.Y.zc().forEach(this.PC.bind(this,a)):this.start())};d.cA=function(a){this.sc.delete(a)};d.aX=function(){return Array.from(this.sc)};
d.QC=function(){E(this.a,"Start app status scan.");var a=[];this.Y.zc().forEach(function(b){a.push.apply(a,this.lo(b))},this);this.Xc.kT().forEach(function(b){a.push(this.o6(b))},this);me(a).Gc(function(){this.ul&&!this.te&&(F(this.a,"Scan complete; scheduling for next scan."),this.te=setTimeout(this.ZR.bind(this),6E4))},this)};d.ZR=function(){F(this.a,"Start app status scan (timer-based)");this.te=null;this.QC()};
d.lo=function(a){if(!a.Ol)return[];for(var b=[],c=ha(this.sc),e=c.next();!e.done;e=c.next())b.push(this.PC(e.value,a));return b};d.PC=function(a,b){if("unknown"!=b.ae(a)&&36E5>u()-b.mT(a)||!b.Ol)return G();F(this.a,"Querying "+b.getId()+" for "+a+" to update app status");return this.FD(b,a).then(this.o0.bind(this,b,a))};
d.o6=function(a){var b=this.Y.W(a.Za.sinkId);if(!b)return D(this.a,"Activity refers to nonexistent sink: "+a.Za.id),G();if(!b.Ol)return G();a=a.appName;F(this.a,"Querying "+b.getId()+" for "+a+" to update activity");return this.FD(b,a).then(this.n0.bind(this,b,a))};d.yU=function(a){var b=this.Ku.get(a.getId());b||(b=new hl(a),F(this.a,"Created DIAL client for "+a.getId()),this.Ku.set(a.getId(),b));return b};
d.FD=function(a,b){var c=xl(a,b),e=this.Vb.get(c);if(e)return e;e=this.yU(a).Cv(b);this.Vb.set(c,e);e.Gc(function(){this.Vb.delete(c)},this);return e};d.uT=function(a,b){if(404==b.kN.cb())return"unavailable";b=b.af;if("Netflix"==a)return this.YR(b);switch(b.state){case "running":case "stopped":return"available";default:return"unavailable"}};
d.YR=function(a){return a.extraData&&l(a.extraData.capabilities)&&"websocket"==a.extraData.capabilities&&("running"==a.state||"stopped"==a.state)?"available":"unavailable"};var xl=function(a,b){return a.getId()+":"+b};d=wl.prototype;d.o0=function(a,b,c){if(404==c.kN.cb()||c.af){c=this.uT(b,c);F(this.a,"Got app status "+c+" from "+a.getId()+" for "+b);var e=a.ae(b);a.ro(b,c);c!=e&&this.Y.Y0(b,a)}else D(this.a,"Failed to process app availability; "+a.getId()+" does not support app availability"),a.FL(!1)};
d.n0=function(a,b,c){(a=this.Xc.MD(a.getId()))&&a.appName==b&&!c.m6&&this.Xc.rJ(a.Za.id)};d.kP=function(a){return this.Y.zc().some(function(b){return"unknown"==b.ae(a)})};d.la=function(){return"dial.AppDiscoveryService"};d.getData=function(){return[this.aX()]};d.eb=function(){var a=kf(this);this.sc=new Set(a||[])};var yl=function(){this.configId=this.modelName=this.deviceType=this.ov=this.qv=this.qp=this.ipAddress=this.friendlyName=this.deviceLabel=this.Ro=null};yl.prototype.Uba=function(){return this.deviceLabel?this.Ro?this.friendlyName?this.ipAddress?this.qp?this.qv?this.ov?null:"Missing expireTimeMillis":"Missing fetchTimeMillis":"Missing appUrl":"Missing ipAddress":"Missing friendlyName":"Missing uniqueId":"Missing deviceLabel"};
yl.prototype.toString=function(){return JSON.stringify(this,function(a,b){return q(b)&&0==b.indexOf("uuid:")?"***":b})};var Bl=function(a){this.wu=new z;this.Vb=new Oc;this.ey=new z;var b;(b=a)||(zl||(zl=new al(3,null,1,10,2E3)),b=zl);this.Yo=b;a||(Al||(Al=new al(2,null,1,10,3E3)),a=Al);this.LO=a;this.a=B("mr.dial.DeviceDescriptionService")},zl=null,Al=null;d=Bl.prototype;
d.vU=function(a){var b=this.zQ(a);return b?(hh("MediaRouter.Dial.Device.Description.Cached"),G(b)):this.Vb.contains(a.deviceLabel)?H(Error("Duplicate request for device "+a.deviceLabel)):this.MS(a)};d.zQ=function(a){var b=this.wu.get(a.deviceLabel);return b?b.configId!=a.configId||u()>=b.ov?(F(this.a,"Removing invalid entry "+b.toString()),this.wu.remove(a.deviceLabel),null):b:null};
d.MS=function(a){var b=I();this.Vb.add(a.deviceLabel);this.Yo.send(a.deviceLabel,a.deviceDescriptionUrl,"GET",null,null,0,t(function(c){(c=this.b4(a,c))?b.resolve(c):b.reject(Error("Failed to get device description"))},this));return b.promise};
d.b4=function(a,b){this.Vb.remove(a.deviceLabel);b=b.target;Rf(this.a,"fetchDeviceDescription","GET",b);if(!b.Fd())return E(this.a,"Request to "+b.Eq()+" failed"),vl(0),null;var c=b.dF();if(!c)return E(this.a,"Invalid or empty response"),vl(2),null;b=this.g3(b,a,c);if(!b)return vl(1),E(this.a,"Invalid device description"),null;E(this.a,"Got device description for "+b.deviceLabel);F(this.a,"... device description was: "+b.toString());null!=b.configId&&(F(this.a,"Caching device description for "+b.deviceLabel),
this.wu.set(a.deviceLabel,b));return b};
d.g3=function(a,b,c){var e=new yl;e.qv=u();e.ov=e.qv+18E5;e.deviceLabel=b.deviceLabel;e.configId=b.configId;e.qp=a.getResponseHeader("Application-URL")||null;a=e.qp;a=a instanceof Qj?a.clone():new Qj(a,void 0);e.ipAddress=a.yf();e.deviceType=Cl(c,"deviceType");e.modelName=Cl(c,"modelName");e.friendlyName=Cl(c,"friendlyName");if(a=e.friendlyName)200<a.length&&(a=a.substring(0,197)+"..."),Pa.test(a)&&(-1!=a.indexOf("&")&&(a=a.replace(Ja,"&amp;")),-1!=a.indexOf("<")&&(a=a.replace(Ka,"&lt;")),-1!=a.indexOf(">")&&
(a=a.replace(La,"&gt;")),-1!=a.indexOf('"')&&(a=a.replace(Ma,"&quot;")),-1!=a.indexOf("'")&&(a=a.replace(Na,"&#39;")),-1!=a.indexOf("\x00")&&(a=a.replace(Oa,"&#0;")));e.friendlyName=a;e.Ro=Cl(c,"UDN");a=e.Uba();F(this.a,"Device description: "+Dl(c));return a?(D(this.a,"Device description failed to validate ("+a+"): "+JSON.stringify(e)),null):e};
var Cl=function(a,b){return(a=a.getElementsByTagName(b))&&0!=a.length?a[0].textContent:null},Dl=function(a){var b=function(a){for(var b=0,f=a.length;b<f;b++)a[b].textContent="***"};b(a.getElementsByTagName("UDN"));b(a.getElementsByTagName("serialNumber"));return(new XMLSerializer).serializeToString(a)};
Bl.prototype.lm=function(a){var b=this.ey.get(a);if(b)return b.promise;b=I();this.ey.set(a,b);this.LO.send(a,a,"GET",null,null,0,t(function(c){this.ey.remove(a);c=c.target;Rf(this.a,"checkAccess","GET",c,!1);b.resolve(c.Fd())},this));return b.promise};var El=null,Fl=null,Gl=function(){El||(El=new aj("dial.DialOnDeviceListEventListener","mr.dial.SinkDiscoveryService",chrome.dial.onDeviceList));Fl||(Fl=new aj("dial.DialOnErrorEventListener","mr.dial.SinkDiscoveryService",chrome.dial.onError));return[El,Fl]};var Hl=function(a,b){this.Jf="mr.dial.SinkDiscoveryService";this.Co=a;this.IC=b||new Bl;this.a=B("mr.dial.SinkDiscoveryService");this.qe=new z;this.Lr=this.sx=!1};w(Hl,Wi);var Il={YouTube:"https://www.youtube.com",Netflix:"https://www.netflix.com",Pandora:"https://www.pandora.com",Radio:"https://www.pandora.com",Hulu:"https://www.hulu.com",Vimeo:"https://www.vimeo.com",Dailymotion:"https://www.dailymotion.com","com.dailymotion":"https://www.dailymotion.com"};d=Hl.prototype;
d.init=function(){nf(this);$i(this)};d.start=function(){this.sx||(E(this.a,"Starting..."),this.sx=!0,Gl().forEach(function(a){return a.register()}),this.refresh())};d.refresh=function(){this.sx?chrome.dial.discoverNow(t(function(a){E(this.a,"chrome.dial.discoverNow = "+a)},this)):E(this.a,"Not started. Ignoring discover().")};
d.q1=function(a){E(this.a,"onDeviceList returned "+a.length+" devices");F(this.a,"....the list is: "+JSON.stringify(a));this.Lr=!1;var b=[],c=new Oc;a.forEach(function(a){b.push(this.c4(a).then(function(a){c.add(a.getId());this.i0(a)},p,this))},this);le(b).Gc(function(){this.Lr||this.bs(c)},this)};
d.i0=function(a){if(!this.Lr){F(this.a,"mayAddSink, id = "+a.getId());var b=this.qe.get(a.getId());b?b.update(a)&&(F(this.a,"Updated sink "+b.getId()),this.Co.fd(b)):(F(this.a,"Adding new sink "+a.getId()),Pd(this.a,Hd,"...sink was "+a.nM()),this.qe.set(a.getId(),a),this.Co.Fi(a))}};d.bs=function(a){this.qe.B().forEach(function(b){a.contains(b.getId())||this.yQ(b).then(function(a){a||(this.Co.le([b]),this.qe.remove(b.getId()))},null,this)},this)};d.yQ=function(a){return a.sf?this.IC.lm(a.sf):G(!1)};
d.c4=function(a){return this.IC.vU(a).then(function(b){var c;b.Ro?(c=b.Ro,0==c.indexOf("uuid:")&&(c=c.substr(5)),c=c.replace(/-/g,"").toLowerCase()):c="";var e=b.Ro?Pf.M().Hm(c):a.deviceLabel,f=Jl.test(b.modelName);return(new Ji(b.friendlyName,c)).Es(e).t8(b.ipAddress).O7(b.qp).K7(a.deviceDescriptionUrl).V8(b.modelName).FL(!f)},null,this)};var Jl=/Eureka Dongle|Chromecast Audio/i;d=Hl.prototype;
d.x2=function(a){switch(a.code){case "no_valid_network_interfaces":case "network_disconnected":D(this.a,"DIAL error: "+a.code+". Clear device list now.");this.Co.le(this.qe.B());this.qe.clear();this.Lr=!0;break;case "no_listeners":case "socket_error":case "cellular_network":case "unknown":D(this.a,"DIAL error: "+a.code+". Keep device list.");break;default:D(this.a,"Unhandled DIAL error: "+a.code)}};d.W=function(a){return this.qe.get(a,null)};
d.HX=function(a){var b=[];this.zc().forEach(function(c){"available"==c.ae(a)&&b.push(c.Bg())});var c=Il[a];return new Ak(b,c?[c]:void 0)};d.zc=function(){return this.qe.B()};d.Oq=function(){return this.qe.P()};d.Y0=function(a,b){this.Co.fd(b)};
d.handleEvent=function(a,b){for(var c=[],e=1;e<arguments.length;++e)c[e-1]=arguments[e];if(a==chrome.dial.onDeviceList)this.q1.apply(this,[].concat(ia(c)));else if(a==chrome.dial.onError)this.x2.apply(this,[].concat(ia(c)));else throw Error("Unhandled event");};d.la=function(){return"dial.DialSinkDiscoveryService"};d.getData=function(){return[this.qe.b()]};d.eb=function(){var a=kf(this);if(a)for(var b in a)this.qe.set(b,Ki(a[b]))};var Kl=function(a,b,c){this.v=a;this.vc=b||new Hl(this);this.Xc=new rl(this);this.Zc=c||new wl(this.vc,this.Xc);this.c6=new rj("dial.RouteIdGenerator")};d=Kl.prototype;d.a=B("mr.DialProvider");d.getName=function(){return"dial"};d.Ed=function(){this.c6.WC();this.Xc.init();this.vc.init();this.Zc.init();this.Bn()};d.Km=function(a){F(this.a,"GetAvailableSinks for "+a);return(a=nl(a))?this.vc.HX(a.appName):Bk};d.jj=function(a){if(a=nl(a))this.Zc.Dy(a.appName),this.Bn()};
d.mj=function(a){if(a=nl(a))this.Zc.cA(a.appName),this.Hr()};d.ij=function(){this.Bn()};d.lj=function(){this.Hr()};d.Hr=function(){(0==this.vc.Oq()||0==this.Zc.sc.size&&0==this.Xc.hd.size)&&this.Zc.stop()};d.Bn=function(){this.vc.start();0<this.vc.Oq()&&(0<this.Zc.sc.size||0<this.Xc.hd.size)&&this.Zc.start()};d.W=function(a){return(a=this.vc.W(a))?a.Bg():null};d.Df=function(){return this.Xc.Df()};
d.Ce=function(a,b,c,e){var f=this.vc.W(b);if(!f)return ul(0),H(Error("Unkown sink: "+b));Pf.M().Pi=new Of(f.qc,f.qa);var g=nl(a);if(!g)return H(Error("No app name set."));var k=g.appName,n=new hl(f);return n.Cv(k).then(function(a){if(!a.af)throw Error("Failed to get app info");if("running"==a.af.state)return n.aM(k)}).then(function(){return n.launchApp(k,g.launchParameter)}).then(function(){return this.ye(b,a,!0,k,c,e)},null,this).va(function(a){ul(3);throw a;})};d.ni=function(){return H(Error("no supported"))};
d.Fh=function(){return H(Error("no supported"))};d.vg=function(){};d.ye=function(a,b,c,e,f,g){ul(1);a=Fk(f,this.getName(),a,b,c,e,null);a.offTheRecord=g;this.Xc.add(new ql(a,e));return a};d.Fi=function(a){this.v.onSinkAvailabilityUpdated(this,1);this.Bn();this.Zc.lo(a);this.v.Fc();Pf.M().Oi=new Of(a.qc,a.qa)};d.le=function(a){if(0==this.vc.Oq())this.v.onSinkAvailabilityUpdated(this,0);this.Hr();a.forEach(function(a){this.Xc.d5(a.getId())},this);this.v.Fc()};d.fd=function(){this.v.Fc()};
d.P0=function(a){this.Bn();this.v.dl(this,a.Za)};d.TH=function(a){a=a.Za;if(a.isLocal)this.v.onPresentationConnectionStateChanged(a.id,"terminated");this.Hr();this.v.Ei(this,a)};d.Wc=function(a){var b=this.Xc.LD(a);if(!b)return H(new zk(3,"Route in DIAL provider not found for routeId "+a));this.Xc.rJ(a);return(a=this.vc.W(b.Za.sinkId))?(new hl(a)).aM(b.appName):H(new zk(3,"Sink in DIAL provider not found for sinkId "+b.Za.sinkId))};d.Af=function(){return null};d.Tm=function(){return null};d.ih=function(){return H(Error("DIAL sending message is not supported"))};
d.km=function(a,b){b=this.vc.W(b);return!b||rh(a)?!1:(a=nl(a))?"available"==b.ae(a.appName):!1};d.Ej=function(){return!1};d.Uf=function(){return null};var Ll=function(a,b){this.rQ=a;this.bv=b;this.ng=this.rQ.Y;this.a=B("mr.cast.CastDialSinkDiscoveryCallbacks")};d=Ll.prototype;d.dS=function(a){return this.ng.lm(a)};d.jF=function(a){var b=this.ng.W(a.getId());return b?b:(a=a.qa)?this.ng.FX(a,Pf.M().Gj||8009):null};d.Fi=function(a){this.jF(a)?Ui(2):this.xM(a);this.bv.Fi(a)};d.xM=function(a){var b=Ni(a);b&&this.dS(b).then(function(c){c?this.jF(a)?Ui(2):(this.ng.dm(b),Ui(0)):hh("MediaRouter.Dial.Sink.Discovered.NonCast")},p,this)};
d.le=function(a){x(a,function(a){var c=this.ng.W(a.getId());c&&c.Am&&this.ng.ql(a.getId())},this);this.bv.le(a)};d.fd=function(a){var b=this.ng.W(a.getId());b?b.Am&&(b.update(a.Qm(),a.qa,b.Eb(),b.qd)&&E(this.a,"Updated Cast sink with DIAL sink: "+a.getId()),this.ng.fd(b)):this.xM(a);this.bv.fd(a)};var Ml=function(a,b){this.Y=new Hl(new Ll(b,this));this.gh=new z;this.v=a;this.qo=this.Yi=0;this.wn=new Oc;this.Wa=new Kl(this,this.Y)},Nl=function(a,b,c,e){this.d6=a;this.sequenceNumber=b;this.S6=c;this.K_=e};Ml.prototype.la=function(){return"cast.DialProviderWrapper"};Ml.prototype.getData=function(){return[new Nl(this.gh.b(),this.Yi,this.qo,this.wn.B())]};Ml.prototype.eb=function(){var a=kf(this);a&&(this.gh.addAll(a.d6),this.Yi=a.sequenceNumber,this.qo=a.S6,this.wn.addAll(a.K_))};var Ol=/__dialAppName__/;
d=Ml.prototype;d.getName=function(){return this.Wa.getName()};d.Ed=function(){this.Wa.Ed();nf(this)};d.Df=function(){return this.Wa.Df()};d.gI=function(){};d.Km=function(a){return this.Wa.Km(a)};d.jj=function(a){this.Wa.jj(a)};d.mj=function(a){this.Wa.mj(a)};d.ij=function(a){this.Wa.ij(a)};d.lj=function(a){this.Wa.lj(a)};d.W=function(a){return this.Wa.W(a)};d.vq=function(a){return new hl(a)};d.Pv=function(a){return this.Y.W(a)};
d.WR=function(a,b,c,e){var f=nl(a),g=this.Pv(b);if(!g)return H(Error("Attempting custom launch with closed route"));var k=f.appName;if(!k)return H(Error("No app name given"));var n=fk(a);if(!n)return H(Error("No client ID"));var v=null;return this.vq(g).Cv(k).then(function(a){if(!a.af)return H(Error("Failed to get app info"));v=a.af},null,this).then(function(){return this.Wa.ye(b,a,!0,k,e||"",c)},null,this).then(function(a){var b={routeId:a.id,FG:!1,sinkId:g.getId(),appName:k,af:v,launchParameter:f.launchParameter,
session:null,clientId:null};this.gh.set(a.id,b);this.lR(b,n);return a},null,this)};d.e_=function(a){return Ol.test(a)};d.Ce=function(a,b,c,e,f,g,k){return this.e_(a)?this.WR(a,b,e,c):this.Wa.Ce(a,b,c,e,f,g,k)};
d.Wc=function(a){var b=this.gh.get(a);return b&&b.session&&b.clientId?(a={receiver:this.Ru(b.sinkId),action:chrome.cast.cm.STOP},a=new Nj("receiver_action",a),a.clientId=b.clientId,this.v.ke(this,b.routeId,a),a=new Nj("remove_session",b.session.sessionId,void 0),a.clientId=b.clientId,this.v.ke(this,b.routeId,a),b.FG=!0,G()):this.Wa.Wc(a)};
d.ih=function(a,b,c){var e=JSON.parse(b);switch(e.type){case "client_connect":return this.z5(a,e.clientId);case "custom_dial_launch":if(this.wn.contains(e.sequenceNumber))return this.i1(a,e);break;case "v2_message":if("STOP"==e.message.type)return this.Wc(a),G()}return this.Wa.ih(a,b,c)};d.uW=function(){var a=String(this.qo);this.qo=(this.qo+1)%9007199254740992;return a};
d.lR=function(a,b){var c=this.Ru(a.sinkId),e=new Nj("receiver_action",{receiver:c,action:chrome.cast.cm.CAST});e.clientId=b;this.v.ke(this,a.routeId,e);c=new chrome.cast.w(this.uW(),"",a.appName,[],c);a.session=c;a.clientId=b;c=new Nj("new_session",c);c.clientId=b;this.v.ke(this,a.routeId,c)};
d.i1=function(a,b){this.wn.remove(b.sequenceNumber);b=b.message;a=this.gh.get(a);if(!a)return H(Error("Unknown route"));if(b&&!b.doLaunch)return G();var c=this.Pv(a.sinkId);if(!c)return H(Error("Custom launch response for sink that no longer exists"));var c=new hl(c),e=a.launchParameter,e=(b?b.launchParameter:null)||e;return c.launchApp(a.appName,e)};d.Ru=function(a){var b=this.Pv(a);a=new chrome.cast.Lt(a,b.Qm());a.ipAddress=b.qa;a.receiverType=chrome.cast.ap.DIAL;return a};
d.tW=function(){var a=this.Yi;this.Yi=(this.Yi+1)%9007199254740992;return a};d.z5=function(a,b){a=this.gh.get(a);if(!a)return H(Error("Unknown route"));var c=this.Ru(a.sinkId);c.receiverType=chrome.cast.ap.DIAL;c=new Nj("custom_dial_launch",new chrome.cast.EA(c,a.af.state,a.af.extraData));c.clientId=b;c.sequenceNumber=this.tW();this.wn.add(c.sequenceNumber);this.v.ke(this,a.routeId,c);return G()};d.Af=function(a){return this.Wa.Af(a)};d.Tm=function(a){return this.Wa.Tm(a)};
d.km=function(a,b){return this.Wa.km(a,b)};d.Ej=function(a,b){return this.Wa.Ej(a,b)};d.Fh=function(a,b,c,e,f){return this.Wa.Fh(a,b,c,e,f)};d.ni=function(a,b,c,e,f,g){return this.Wa.ni(a,b,c,e,f,g)};d.vg=function(a){var b=this.gh.get(a);this.gh.remove(a);b&&b.FG?this.Wa.Wc(a):this.Wa.vg(a)};d.Fc=function(){this.v.Fc()};d.onSinkAvailabilityUpdated=function(a,b){this.v.onSinkAvailabilityUpdated(a,b)};d.dl=function(a,b){this.v.dl(this,b)};d.Ei=function(a,b){this.v.Ei(this,b)};
d.Sg=function(a,b){this.v.Sg(this,b)};d.ke=function(a,b,c){this.v.ke(this,b,c)};d.onPresentationConnectionStateChanged=function(a,b){this.v.onPresentationConnectionStateChanged(a,b)};d.onPresentationConnectionClosed=function(a,b,c){this.v.onPresentationConnectionClosed(a,b,c)};d.lw=function(a){return this.v.lw(a)};d.qw=function(){return this.v.qw()};d.zf=function(){return this.v.zf()};d.Pr=function(a,b,c){this.v.Pr(this,b,c)};d.Ox=function(a){this.v.Ox(a)};d.Fi=function(a){this.Wa.Fi(a)};d.le=function(a){this.Wa.le(a)};
d.fd=function(a){this.Wa.fd(a)};d.Go=function(){};d.ot=function(){};d.Uf=function(a,b){return this.Wa.Uf(a,b)};d.Ey=function(a){this.v.Ey(a)};d.Vw=function(){return this.v.Vw()};d.eh=function(a,b){return this.v.eh(a,b)};var Pl=function(a,b){this.routeId=a;this.message=b},Ql=function(a){return"string"!=typeof a.message};var Rl=function(a){this.Uk=a;this.Of=new Uk};d=Rl.prototype;d.enqueue=function(a){this.Of.P()==this.Uk&&this.Of.rf();this.Of.enqueue(a)};d.rf=function(){return this.Of.rf()};d.JR=function(){var a=this.Of.B();this.Of.clear();return a};d.Gb=function(){return this.Of.Gb()};d.g_=function(){return this.Of.P()==this.Uk};d.B=function(){return this.Of.B()};var Sl=function(a){se.call(this);this.ge=a;this.Pa=this.ur=null};w(Sl,se);Sl.prototype.L=function(){this.Pa&&(bf(this.Pa),this.Pa=null)};Sl.prototype.SJ=function(){if(!this.Pa)if(null===this.ur||u()-this.ur>=this.ge)this.Wf();else{var a=Math.max(this.ur+this.ge-u(),5);this.Pa=af(this.Wf,a,this)}};Sl.prototype.Wf=function(){this.Pa=null;this.$R();this.ur=u()};var Tl=function(a,b){Sl.call(this,20);this.Oe=new Map;this.Ng=new Set;this.Zy=null;this.yp=this.dg=0;this.NL=!1;this.v=a;this.B0=b;this.a=B("mr.RouteMessageSender")};w(Tl,Sl);d=Tl.prototype;d.init=function(a){this.Zy=a;nf(this)};d.O_=function(a){this.Ng.has(a)||(this.Ng.add(a),this.uZ(a)&&this.SJ())};d.Rz=function(a){this.Ng.delete(a)};
d.send=function(a,b){var c=this.Oe.get(a);c||(c=new Rl(50),this.Oe.set(a,c));if(c.g_()){D(this.a,"Queue is full; dropping oldest message");F(this.a,"   for route "+a);var e=c.rf();this.dg-=Ql(e)?0:e.message.length;Ql(e)&&this.yp--}b=new Pl(a,b);c.enqueue(b);this.dg+=Ql(b)?0:b.message.length;Ql(b)&&this.yp++;this.jA();this.Ng.has(a)&&this.SJ()};d.Ei=function(a){this.Ng.delete(a);var b=this.Oe.get(a);b&&(this.Oe.delete(a),this.fI(b.B()),this.jA())};
d.fI=function(a){if(0!=a.length){a=ha(a);for(var b=a.next();!b.done;b=a.next())b=b.value,this.dg-=Ql(b)?0:b.message.length,Ql(b)&&this.yp--}};d.uZ=function(a){return this.Oe.has(a)&&!this.Oe.get(a).Gb()};d.jA=function(){var a=0<this.yp||this.dg>this.B0;a!=this.NL&&(this.NL=a,this.v.eh(this.la(),a))};d.$R=function(){if(this.Zy){for(var a=ha(this.Ng),b=a.next();!b.done;b=a.next()){var b=b.value,c=this.Oe.get(b);c&&!c.Gb()&&(c=c.JR(),this.Zy(b,c),this.fI(c))}this.jA()}else C(this.a,"sendMessagesCallback not set. Messages not delivered.")};
var Ul=function(a,b,c){this.E4=a;this.T_=b;this.eba=c};Tl.prototype.la=function(){return"mr.RouteMessageSender"};Tl.prototype.getData=function(){var a=Array.from(this.Oe,function(a){return[a[0],a[1].B()]}),b=Array.from(this.Ng);return[new Ul(a,b,this.dg)]};Tl.prototype.eb=function(){var a=kf(this);a&&(this.Oe=new Map,a.E4.forEach(function(a){var c=a[1],e=new Rl(50);this.Oe.set(a[0],e);c.forEach(function(a){e.enqueue(a)})},this),this.Ng=new Set(a.T_),this.dg=a.eba)};var Vl={OA:0,DA:1},Wl=function(a){ih("MediaRouter.CastStreaming.Start.Success",a,Vl)};var Xl=B("mr.mirror.cast.LogUploader"),Zl=function(a,b,c){Yl("raw_events.log.gz",a,b,c);return b?"https://crash.corp.google.com/samples?stbtiq="+b:""},Yl=function(a,b,c,e){if(0==b.size)E(Xl,"Trying to upload an empty file to Crash"),e&&e(null);else{var f=new FormData;f.append("prod","Cast");f.append("ver",chrome.runtime.getManifest().version);f.append(a,b);c&&f.append("comments",c);bg("https://clients2.google.com/cr/report",function(a){a=a.target;var b=null;a.Fd()?(b=a.vk(),E(Xl,"Upload to Crash succeeded: "+
b)):E(Xl,"Upload to Crash failed. HTTP status: "+a.cb());e&&e(b)},"POST",f,void 0,3E4)}};var $l=function(){this.qn=0};ra($l);var am=B("mr.mirror.cast.LogUtils");$l.prototype.S$=function(){var a={fraction:.01,autoSubmitTimeLimitMillis:6048E5},b=a.autoSubmitTimeLimitMillis,c=u();return this.qn&&b&&c-this.qn<b?!1:Math.random()<a.fraction};
var bm=function(){this.ext="MR";this.senderProductName="Google Chrome";this.senderVersion=vi;this.senderPlatform=Zc;this.senderUserAgent=ac||""},cm=function(a,b,c,e){var f=new bm;f.extVersion=chrome.runtime.getManifest().version;f.extChannel="public";f.minBitrate=c.minVideoBitrate;f.maxBitrate=c.maxVideoBitrate;f.resolution=c.LV();f.minResolution=c.gW();f.resolutionChangePolicy=c.iX();f.maxFrameRate=c.maxFrameRate;f.minLatency=c.minLatencyMillis;f.maxLatency=c.maxLatencyMillis;f.animatedLatency=c.animatedLatencyMillis;
f.useDscp=c.dscpEnabled;f.useTdls=c.useTdls;null!==b&&(f.receiverVersion=b);null!==a&&(f.receiverProductName=a);e.length&&(f.Hoa=e);return f},dm=function(a,b,c,e,f){E(am,"getRawEvents");var g=I(),k=function(b){E(am,"Got receiver version: "+b);b=JSON.stringify(cm(c,b,e,f));chrome.cast.streaming.rtpStream.getRawEvents(a,b,function(a){g.resolve(a)})};"Chromecast"==c?jg(b).then(k,g.reject):k(null);return g.promise},em=function(a,b,c,e){E(am,"getStats");var f=I(),g=function(b){E(am,"Got receiver version: "+
b);var g=cm(c,b,e,[]);chrome.cast.streaming.rtpStream.getStats(a,function(a){var b={tags:g};Tb(b,a);f.resolve(b)})};"Chromecast"==c?jg(b).then(g,f.reject):g(null);return f.promise};$l.prototype.la=function(){return"mirror.cast.LogUtils"};$l.prototype.getData=function(){return[null,{lastAutoSubmitMillis:this.qn}]};$l.prototype.eb=function(){var a=lf(this);this.qn=a&&a.lastAutoSubmitMillis||0};var fm=function(a,b){ji.call(this,a,b)};w(fm,ji);var gm=function(a){return a&&a.getAudioTracks()&&0<a.getAudioTracks().length?a.getAudioTracks()[0]:null},hm=function(a){return a&&a.getVideoTracks()&&0<a.getVideoTracks().length?a.getVideoTracks()[0]:null};var im=B("mr.NetworkUtils"),jm=function(a,b){if(!di)return H("TDLS feature not enabled.");var c=I();chrome.networkingPrivate.setWifiTDLSEnabledState(a,b,function(a){chrome.runtime.lastError?(im.ha("Unable to set TDLS state: state = "+b+", error = "+chrome.runtime.lastError.message),c.reject("Unable to set TDLS state to "+b+".")):(im.info("TDLS state changed: state = "+b+", status = "+a),c.resolve(a))});return c.promise};var km=function(a,b){this.sessionId=a;this.seqNum=b;this.type="PRESENTATION"};var lm=function(a,b,c){this.type="GET_STATUS";this.sessionId=a;this.seqNum=b;this.get_status=c};var mm=function(a,b){this.address=a;this.port=b},nm=function(a,b){xh.call(this,b);this.a=B("mr.mirror.cast.Session");this.fl=a;this.Ma=a.Af().clone();this.Nc=Yg.Cq(b.id);this.I=b.ie.sessionId;this.Ld=new mm(b.ie.PL,2344);this.hs=b.ie.QL;this.Hc=null;this.zh=!1;this.Zb=null;this.sj=!1;this.ph=0;this.ra=this.hp=this.jp=null;this.V3=["H264","VP8"];this.Ow=new z;this.uB=null;this.NJ=t(this.w2,this);this.MJ=t(this.v2,this);this.Ym=null;this.Yn=new mi(30);this.hJ=!1;this.Ql=null;this.bz=new rj("mirror.cast.SeqNumGenerator");
this.Sc=this.Le=null};w(nm,xh);d=nm.prototype;
d.start=function(a){var b=gm(a);a=hm(a);this.Le=new $g("MediaRouter.CastStreaming.Session.Launch");this.ra=I();this.PZ();this.Ma.useTdls&&jm(this.Ld.address,!0).then(function(a){"Connected"!=a&&(this.Ma.useTdls=!1)},function(){this.Ma.useTdls=!1},this);chrome.cast.streaming.session.create(b,a,t(function(a,b,f){this.Hc=a;this.Zb=b;this.ph=f;this.Nc.onMessage=t(this.Qr,this);this.az({type:"OFFER",sessionId:this.getId(),seqNum:this.bz.Hq(),offer:this.sm()})},this));return this.ra.promise};
d.stop=function(){this.Sc&&(this.Sc.end(),this.Sc=null);E(this.a,"Stopping "+this.getId());null!==this.Hc&&(chrome.cast.streaming.rtpStream.stop(this.Hc),chrome.cast.streaming.rtpStream.destroy(this.Hc),this.Hc=null,this.zh=!1);null!==this.Zb&&(chrome.cast.streaming.rtpStream.stop(this.Zb),chrome.cast.streaming.rtpStream.destroy(this.Zb),this.Zb=null,this.sj=!1);this.ph&&(chrome.cast.streaming.udpTransport.destroy(this.ph),this.ph=0);this.Ma.useTdls&&jm(this.Ld.address,!1);this.ra&&(this.ra.resolve(this),
this.ra=null);chrome.cast.streaming.rtpStream.onStarted.removeListener(this.NJ);chrome.cast.streaming.rtpStream.onError.removeListener(this.MJ);null!==this.Ym&&(window.clearTimeout(this.Ym),this.Ym=null);this.jp=this.hp=null;if(this.Ql&&this.Ql.onSessionStop)this.Ql.onSessionStop(this.Ld);return!0};d.G8=function(a){this.zh&&chrome.cast.streaming.rtpStream.toggleLogging(this.Hc,a);this.sj&&chrome.cast.streaming.rtpStream.toggleLogging(this.Zb,a)};
d.getLogs=function(){if(!this.zh&&!this.sj)return H(Error("No streams has been started yet."));var a=[];if(this.zh){var b=dm(this.Hc,this.Ld.address,this.hs,this.Ma,this.Yn.B());a.push(b)}this.sj&&(b=dm(this.Zb,this.Ld.address,this.hs,this.Ma,this.Yn.B()),a.push(b));return le(a).then(function(a){a=new Blob(a,{type:"application/gzip"});E(this.a,"Events blob size: "+a.size);return a},null,this)};
d.getStats=function(){var a=[];if(this.zh){var b=em(this.Hc,this.Ld.address,this.hs,this.Ma);a.push(b)}this.sj&&(b=em(this.Zb,this.Ld.address,this.hs,this.Ma),a.push(b));this.Yn.P()&&a.push(G({receiverStatusData:this.Yn.B()}));return le(a).then(function(a){var b={};x(a,function(a){Tb(b,a)});return b})};
d.eR=function(){var a=chrome.cast.streaming.rtpStream.getSupportedParams(this.Hc)[0];a.payload.maxLatency=this.Ma.maxLatencyMillis;a.payload.minLatency=this.Ma.minLatencyMillis;a.payload.animatedLatency=this.Ma.animatedLatencyMillis;a.payload.ssrc=Math.floor(499999*Math.random())+1;a.payload.feedbackSsrc=2;a.payload.payloadType=127;a.payload.aesKey=this.jp;a.payload.aesIvMask=this.hp;return a};
d.tR=function(){var a=[];if(null===this.Zb)return a;var b=chrome.cast.streaming.rtpStream.getSupportedParams(this.Zb);this.V3.forEach(function(c){var e=jb(b,function(a){return a.payload.codecName.toLowerCase()==c.toLowerCase()},this);e&&(e.payload.maxFrameRate=this.Ma.maxFrameRate,e.payload.minBitrate=this.Ma.minVideoBitrate,e.payload.maxBitrate=this.Ma.maxVideoBitrate,e.payload.maxLatency=this.Ma.maxLatencyMillis,e.payload.minLatency=this.Ma.minLatencyMillis,e.payload.animatedLatency=this.Ma.animatedLatencyMillis,
e.payload.aesKey=this.jp,e.payload.aesIvMask=this.hp,e.payload.ssrc=Math.floor(499999*Math.random())+500001,e.payload.feedbackSsrc=12,e.payload.payloadType=96,a.push(e))},this);return a};
d.sm=function(){var a=0,b=[];if(this.Hc){var c=this.eR();this.uB=c;c={index:a,type:"audio_source",codecName:c.payload.codecName.toLowerCase(),rtpProfile:"cast",rtpPayloadType:c.payload.payloadType,ssrc:c.payload.ssrc,targetDelay:this.Ma.animatedLatencyMillis,aesKey:c.payload.aesKey,aesIvMask:c.payload.aesIvMask,bitRate:128E3,sampleRate:c.payload.clockRate,timeBase:"1/"+c.payload.clockRate,channels:c.payload.channels,rtpExtensions:["adaptive_playout_delay"]};this.Ma.enableLogging&&Tb(c,{receiverRtcpEventLog:!0});
this.Ma.dscpEnabled&&Tb(c,{receiverRtcpDscp:46});b.push(c);a++}this.tR().forEach(function(c){var f={index:a,type:"video_source",codecName:c.payload.codecName.toLowerCase(),rtpProfile:"cast",rtpPayloadType:c.payload.payloadType,ssrc:c.payload.ssrc,targetDelay:this.Ma.animatedLatencyMillis,aesKey:c.payload.aesKey,aesIvMask:c.payload.aesIvMask,maxFrameRate:Math.round(1E3*c.payload.maxFrameRate)+"/1000",timeBase:"1/90000",maxBitRate:c.payload.maxBitrate,resolutions:[{width:this.Ma.maxWidth,height:this.Ma.maxHeight}],
rtpExtensions:["adaptive_playout_delay"]};this.Ma.enableLogging&&Tb(f,{receiverRtcpEventLog:!0});this.Ma.dscpEnabled&&Tb(f,{receiverRtcpDscp:46});b.push(f);this.Ow.set(a,c);a++},this);return{supportedStreams:b}};d.w2=function(a){a==this.Hc?this.zh=!0:a==this.Zb&&(this.sj=!0);this.zh&&(null===this.Zb||this.sj)&&(this.G8(this.Ma.enableLogging),this.ra&&(this.ra.resolve(this),this.ra=null));this.Sc=new eh("MediaRouter.CastStreaming.Session.Length")};
d.v2=function(a,b){if(a==this.Hc)D(this.a,"Audio stream error "+b);else if(a==this.Zb)D(this.a,"Video stream error "+b);else{D(this.a,"Error for stream "+a+": "+b);return}this.ra&&(this.ra.reject(Error("Error for stream "+a+": "+b)),this.ra=null);this.stop()};
d.waa=function(a,b){F(this.a,"Starting streaming ... "+JSON.stringify({udpTransportId:this.ph,receiverIpEndPoint:this.Ld,"audio ID":this.Hc,"video ID":this.Zb,"audio params":a,"video params":b}));if(wa(chrome.cast.streaming.udpTransport.n9)){var c={};this.Ma.dscpEnabled&&(E(this.a,"Enable DSCP in sender."),c.DSCP=!0);chrome.cast.streaming.udpTransport.n9(this.ph,c)}chrome.cast.streaming.udpTransport.setDestination(this.ph,{address:this.Ld.address,port:this.Ld.port});chrome.cast.streaming.rtpStream.onStarted.addListener(this.NJ);
chrome.cast.streaming.rtpStream.onError.addListener(this.MJ);a&&chrome.cast.streaming.rtpStream.start(this.Hc,a);b&&chrome.cast.streaming.rtpStream.start(this.Zb,b)};
d.Qr=function(a){if("urn:x-cast:com.google.cast.webrtc"==a.namespace_){a=a.data;F(this.a,a);var b=JSON.parse(a);if("ANSWER"==b.type&&"ok"==b.result){b.answer.udpPort&&(this.Ld.port=b.answer.udpPort);this.hJ=!!b.answer.receiverGetStatus;if(this.Ql&&this.Ql.onAnswer)this.Ql.onAnswer(this.Ld);this.Le&&(this.Le.end(),this.Le=null);E(this.a,"Starting streaming");var c=this.uB,e=null;b.answer.sendIndexes&&b.answer.sendIndexes.forEach(function(a){c&&0==a?b.answer.ssrcs&&b.answer.ssrcs[a]&&(c.payload.feedbackSsrc=
b.answer.ssrcs[a]):this.Ow.ab(a)&&(e?D(this.a,"Receiver selected multiple video stream"):(e=this.Ow.get(a),b.answer.ssrcs&&b.answer.ssrcs[a]&&(e.payload.feedbackSsrc=b.answer.ssrcs[a])))},this);null!==this.Zb&&null===e&&(D(this.a,"Receiver is capable of video, but did not specify a video stream index in the ANSWER message."),chrome.cast.streaming.rtpStream.destroy(this.Zb),this.Zb=null);if(c||e){this.ZE();this.waa(c,e);this.ra&&(this.ra.resolve(this),this.ra=null);return}}if("STATUS_RESPONSE"!=b.type||
null===b.status)this.ra&&(this.ra.reject(Error("Invalid answer: "+b)),this.ra=null),this.stop();else{a={};for(var f in b.status){var g=b.status[f];ua(g)&&g.length?a[f]=g.pop():a[f]=g}f={};f[(new Date).toISOString()]=a;this.Yn.add(f)}}};d.PZ=function(){this.hp=Cf(window.crypto.getRandomValues(new Uint8Array(16)));this.jp=Cf(window.crypto.getRandomValues(new Uint8Array(16)))};d.ZJ=function(){this.az(this.OW())};d.az=function(a){this.Nc.sendMessage(a,{namespace:"urn:x-cast:com.google.cast.webrtc"})};
d.ZE=function(){this.Ym=null;if(this.ph&&this.hJ){var a=new lm(this.getId(),this.bz.Hq(),["wifiSnr","wifiSpeed","wifiFcsError"]);this.az(a);this.Ym=window.setTimeout(t(this.ZE,this),12E4)}};d.OW=function(){var a=new km(this.I,this.bz.Hq());a.title=this.Jy||void 0;a.icons=this.iconUrl&&!this.ir?[new chrome.cast.Image(this.iconUrl)]:[];return a};d.getId=function(){return this.I};d.Wh=function(){return this.fl};d.L=function(){this.Nc.mb();this.stop()};var om=function(a){wh.call(this,"cast_streaming",a)};w(om,wh);d=om.prototype;d.getName=function(){return"cast_streaming"};d.Wh=function(a,b){return new fm(a,b)};d.Su=function(a,b){if(a instanceof fm)return new nm(a,b);throw Error("Invalid parameters");};d.Cy=function(){Wl(0)};d.yy=function(){Wl(1)};d.zy=function(){hh("MediaRouter.CastStreaming.Session.End")};d.Ay=function(a){ih("MediaRouter.CastStreaming.Start.Failure",a,jh)};d.By=function(){hh("MediaRouter.CastStreaming.Stream.End")};
d.AB=function(){var a=this.Ra,b=a.getLogs().then(function(a){return a},function(a){D(this.o,"Get cast streaming logs failed.",a)},this),a=a.getStats().then(function(a){return a},function(a){D(this.o,"Get cast streaming stats failed.",a)},this),c=I();chrome.metricsPrivate.getIsCrashReportingEnabled(function(a){c.resolve(a)});return le([b,a,c.promise]).then(function(a){var b=a[0],c=new FileReader;c.onloadend=function(){uf("mr.temp.mirror.cast.Service.mirrorLogs",c.result)};c.readAsBinaryString(b);var k=
a[1];a[2]&&(b&&$l.M().S$()?Zl(b,void 0,this.$0.bind(this)):k&&Yl("stats.json",new Blob([JSON.stringify(k)],{type:"application/json"}),void 0,void 0))},null,this)};d.$0=function(a){a&&($l.M().qn=u())};d.jW=function(a){E(this.o,"Received message to upload logs for "+a);return this.Ra?this.Ra.getLogs().then(function(b){return Zl(b,a)},function(b){D(this.o,"Get cast streaming logs failed.",b);return this.zH(a)},this):G(this.zH(a))};
d.zH=function(a){var b=window.localStorage["mr.temp.mirror.cast.Service.mirrorLogs"];if(!b)return"";window.localStorage.removeItem("mr.temp.mirror.cast.Service.mirrorLogs");E(this.o,"Uploading saved logs for feedback.");for(var c=new Uint8Array(b.length),e=0;e<c.length;e++)c[e]=b.charCodeAt(e);return Zl(new Blob([c],{type:"application/gzip"}),a)};var pm=function(a,b){xh.call(this,b);this.fl=a;this.On=I();this.m=this.On.promise;this.Nc=Yg.Cq(b.id);this.ra=I();this.Uw=this.Ab=!1;this.Sc=this.Le=null;this.Bo();this.Dz();this.xb(new yh("GET_TURN_CREDENTIALS"))};w(pm,xh);d=pm.prototype;d.start=function(a){var b=this;return this.m.then(function(c){if(c.lr())return H(Error("Mirroring already started"));b.Le=new $g("MediaRouter.WebRtc.Session.Launch");c.addStream(a);c.start();return b.ra.promise})};
d.stop=function(){this.Sc&&this.Sc.end();this.Uw=this.Ab=!1;this.Le=this.Sc=null;this.m.then(function(a){a.stop()});return!0};d.L=function(){this.Nc.mb();this.stop()};
d.Bo=function(){var a=this;this.Nc.onMessage=function(b){if(!b.type)throw Error("Message has no type.");switch(b.type){case "TURN_CREDENTIALS":a.On.resolve(new Eh(a.Za.id,b.data.credentials));break;case "ANSWER":a.m.then(function(a){a.setRemoteDescription(b.data)});break;case "KNOCK_ANSWER":a.Uw=!0;a.m.then(function(a){a.setRemoteDescription(b.data)});break;case "STOP":a.ra.reject("Stop signal received");a.stop();break;default:throw Error("Unknown message type: "+b.type);}}};
d.Dz=function(){var a=this;this.m.then(function(b){b.eL(function(b){b=new Ah(b,a.fl.Af(),Dh);a.xb(new yh("OFFER",b))});b.dL(function(b){a.xb(zh(b))});b.cL(function(){a.Ab=!0;a.xb(new yh("SESSION_START_SUCCESS"));!a.Uw&&a.Le&&a.Le.end();a.Le=null;a.Sc=new eh("MediaRouter.WebRtc.Session.Length");a.ra.resolve(a)});b.aL(function(){a.xb(new yh("SESSION_END"))});b.bL(function(b){a.Ab||a.ra.reject(b);a.xb(new yh("SESSION_FAILURE"))})})};var qm={channelType:"cloud"};
pm.prototype.xb=function(a){this.Nc.sendMessage(a,qm)};pm.prototype.Wh=function(){return this.fl};var rm=function(a){wh.call(this,"webrtc",a)};w(rm,wh);d=rm.prototype;d.Wh=function(a,b){return new ji(a,b)};d.Su=function(a,b){if(a instanceof ji)return new pm(a,b);throw Error("Invalid parameters");};d.Cy=function(){Ch(0)};d.yy=function(){Ch(1)};d.zy=function(){hh("MediaRouter.WebRtc.Session.End")};d.Ay=function(a){ih("MediaRouter.WebRtc.Start.Failure",a,jh)};d.By=function(){hh("MediaRouter.WebRtc.Stream.End")};var sm=function(a,b,c,e,f,g){this.JG=a;this.ld=b;this.ck=e||null;this.Wk=c||null;this.ue=f||null;this.Ti=g||null};d=sm.prototype;d.xf=function(){var a="";this.ue?a=this.ue:this.Wk&&(a=this.Wk);return a};d.getId=function(){return this.JG+"@"+this.ld};d.getService=function(){return this.ld};d.yf=function(){return this.ck};d.merge=function(a){!this.Ti&&a.Ti&&(this.Ti=a.Ti);!this.ue&&a.ue&&(this.ue=a.ue);this.ue&&a.ue&&this.Ti&&(this.ue=a.ue)};var tm=function(a,b){this.ig=a;this.kba=b},um=new tm("https://www.googleapis.com/clouddevices/v1","AIzaSyAOZM8ZYeov685QMjXT3sC7XNizfrTEKjA"),vm=new tm("https://www.googleapis.com/calendar/v3",""),wm=new tm("https://www.googleapis.com/hangouts/v1",""),xm=new tm("https://networktraversal.googleapis.com/v1alpha","AIzaSyAOZM8ZYeov685QMjXT3sC7XNizfrTEKjA");var ym=function(a,b){this.nb=a;this.Pb=b;this.a=B("mr.cloud.calendar.CalendarService")};d=ym.prototype;d.YS=function(){var a=this;return this.dU(this.Pb.ve,9E5).then(function(b){E(a.a,a.BD(b.length)+" events discovered before filtering.");return a.hV(b)},function(b){D(a.a,"Error getting Hangouts from calendar: "+b);return[]})};d.BD=function(a){return 20<a?"20+":a.toString()};d.dU=function(a,b){var c=u(),e=this;return this.FT(a,new Date(c),new Date(c+b)).then(function(a){return a.filter(e.m_)})};
d.m_=function(a){return!(!a.start||!a.end||a.start.date||a.end.date||!a.start.dateTime||!a.end.dateTime)};d.FT=function(a,b,c){a=this.nb.Qh(vm.ig,["calendars",a,"events"],{timeMin:b.toJSON(),timeMax:c.toJSON(),singleEvents:!0});F(this.a,"Retrieving Hangouts from Calendar: "+a);return this.nb.lg(a,"GET").then(function(a){return a.items?a.items:[]})};
d.hV=function(a){var b=this;a=a.reduce(function(a,e){if(e.hangoutLink){var f=new Qj(e.hangoutLink),g=b.k3(f.gd);if(2==g.length){var f=g[0],g=g[1],k,n;-1!=f.indexOf(".")&&(k=g,n=f);a.push(new sm(g,f,k,n,e.summary))}else D(b.a,"Invalid hangout link from calendar event: "+e.hangoutLink)}return a},[]);E(this.a,this.BD(a.length)+" events discovered with Hangout links.");return a};d.k3=function(a){return a.substring(12).split("/")};var zm=function(a,b){this.email=a;this.imageUrl=null!=b?b:null},Am=function(a){this.type=a},Bm=function(a,b,c){this.type="__cloud_webrtc_session_message__";this.sessionDescription=a;this.user=null!=b?b:null;this.flungUrl=null!=c?c:null};w(Bm,Am);
var Cm=function(a,b,c){this.name=a;this.parameters=b;this.minimalRole=null!=c?c:"user"},Dm={_settings:{type:"string"},_presentationRequest:{type:"string"},_optMediaConstraints:{type:"string"},_webrtcMessage:{type:"string"},_user:{type:"string"}},Em=new Cm("_stopSession",{},"viewer"),Fm=new Cm("_startWebrtcSession",Dm),Gm=new Cm("_knockingStartWebrtcSession",Dm,"viewer");var Hm=function(a){this.Bb=a;this.id=a.id;this.a=B("mr.cloud.devices.CloudDevice")};d=Hm.prototype;d.isAvailable=function(){if(this.getState().appStatus){var a=this.h_(),b=this.c_(),c=this.WB(864E5);F(this.a,"Device id: "+this.id+", availability: GCM connected "+a+", app Available: "+b+", checked in: "+c);return a&&b&&c}c=this.WB(9E5);E(this.a,"Availability for legacy receiver app: "+c);return c};d.WB=function(a){var b=this.uV();return!!(b&&b>u()-a)};d.c_=function(){return"available"==this.getState().appStatus};
d.h_=function(){return"online"==this.Bb.connectionStatus};d.uV=function(){return this.Bb.lastUpdateTimeMs?Number(this.Bb.lastUpdateTimeMs):null};d.xf=function(){return this.getState().settings.receiverName};d.getId=function(){return this.id};d.getState=function(){return this.Bb.state._cloudCast};d.p_=function(){return this.Bb.invitations?0!=this.Bb.invitations.length:!1};var Im=function(a){this.nb=a;this.ek=this.Nk=this.pi=null;this.nr=this.kr=!1;this.a=B("mr.cloud.devices.CloudDevicesService");nf(this)};Im.prototype.getDevice=function(a){a=this.nb.Qh(um.ig,["devices",a]);return this.nb.lg(a,"GET").then(function(a){return new Hm(a)})};Im.prototype.N_=function(){return this.bH({descriptionSubstring:"Chrome Streaming Receiver"})};
Im.prototype.bH=function(a){var b=this,c=this.nb.Qh(um.ig,["devices"],a);return this.nb.lg(c,"GET").then(function(c){var f=(c.devices||[]).filter(function(a){return null!=a.commandDefs&&null!=a.commandDefs._cloudCast}).map(function(a){return new Hm(a)});if(c=c.nextPageToken){var g=Ob(a);g.token=c;return b.bH(g).then(function(a){return f.concat(a)})}return f})};var Jm=function(a,b,c){this.J_=a;this.gcmRegistrationId=b;this.H_=c};d=Im.prototype;d.la=function(){return"CloudDevicesService"};
d.getData=function(){return[new Jm(this.pi,this.ek,this.Nk)]};d.eb=function(){var a=kf(this);a&&(this.pi=a.J_,this.ek=a.gcmRegistrationId,this.Nk=a.H_)};d.V4=function(){var a=this;return new fe(function(b,c){a.kr?c(Error("Registering...")):(a.kr=!0,a.ek&&a.Nk&&a.Nk+864E5>=u()?(a.kr=!1,b(a.ek)):chrome.gcm.register(["919648714761"],function(e){a.kr=!1;e?(F(a.a,"Got GCM ID: "+e),a.ek=e,a.Nk=u(),a.pi=null,b(e)):(D(a.a,"Error: "+chrome.runtime.lastError.message),a.ek=null,a.Nk=null,a.pi=null,c(Error(chrome.runtime.lastError.message)))}))})};
d.T$=function(){return!this.pi||this.pi+864E5<u()};d.subscribe=function(a){var b=this;if(this.nr)return G();this.nr=!0;if(!a||!this.T$())return G();a={filters:["myDevices"],gcmRegistrationId:a,gcmSenderId:"919648714761",expirationTimeMs:864E5};var c=this.nb.Qh(um.ig,["subscriptions","subscribe"],{});return this.nb.lg(c,"POST",a).then(function(){F(b.a,"Subscribed on: "+u());b.pi=u();b.nr=!1;return G()},function(a){b.nr=!1;throw a;})};var Km={jca:0,DENIED:1,TIMEOUT:2},Lm={SUCCESS:0,xda:1},Mm={HO:0,iO:1,qga:2,Oda:3,Nda:4,vea:5,TIMEOUT:6,lfa:7},Nm={Lda:0,Ofa:1},Om={Wea:0,pea:1,fga:2,Gda:3},Pm=function(a){ih("MediaRouter.Cloud.Knock.Result",a,Km)},Qm=function(a){ih("MediaRouter.Cloud.Session.Start",a,Lm)},Rm=function(a){ih("MediaRouter.Cloud.Session.Type",a,Nm)},Sm=function(a){ih("MediaRouter.Cloud.Device.UserRole",a,Om)};var Tm=function(a,b,c,e,f,g,k){var n=Pf.M().Hm(a);this.Ya=new Ii(n,b,g,k,f);this.deviceId=a;this.Naa=c;this.model=e};Tm.prototype.fM=function(a){return lb(this.Naa,a)};var Um=function(a,b,c,e,f){Tm.call(this,a,b,["cloud"],"Chrome Streaming Receiver",e);this.Qt=c;this.isAvailable=f};w(Um,Tm);var Vm=function(a){var b=a.getService();a.yf()&&(b=a.yf());var c;a.Wk&&a.xf()!=a.Wk&&(c=a.Wk);Tm.call(this,a.getId(),a.xf(),["mesi"],"Hangout",b,"hangout",c);this.Ty=a.Ti||""};w(Vm,Tm);var Wm=function(a,b,c){this.Gba=a;this.Uc=b;this.Xf=new z;this.Us=new z;this.Mk=null;this.D0=c},Xm=function(a,b,c){this.sinks=a;this.hC=b;this.MG=c};d=Wm.prototype;d.zc=function(){this.lQ()&&(this.Mk=u(),this.Em());return this.Xf.B()};d.dm=function(a){this.Xf.set(a.Ya.id,a)};d.ql=function(a){return this.Xf.remove(a)};d.W=function(a){return this.Xf.get(a,null)};d.lQ=function(){var a=this.Mk+this.D0;return null==this.Mk||a<u()};d.Em=function(){var a=this;return this.Gba().then(function(b){a.Fba(b)})};
d.Fba=function(a){var b=new z(this.Xf),c=new z,e=new z,f=[],g=[];a.forEach(function(a){var n=a.Ya.id;c.set(n,a);e.set(n,a.deviceId);b.ab(n)?b.ab(n)&&JSON.stringify(b.get(n))!=JSON.stringify(a)&&g.push(a.Ya):f.push(a.Ya);b.remove(n)},this);a=b.ob().map(function(a){return b.get(a).Ya});this.Us.clear();this.Us=e;this.Xf.clear();this.Xf=c;this.iQ(f,g,a)};d.iQ=function(a,b,c){0<a.length&&this.Uc.Ux(a);0<b.length&&this.Uc.Fc(b);0<c.length&&this.Uc.le(c)};
d.b=function(){return new Xm(this.Xf.b(),this.Us.b(),this.Mk)};d.hH=function(a){for(var b in a.sinks){var c=a.sinks[b],e=null;"Hangout"==c.model?(e=c.deviceId.split("@"),e=new Vm(new sm(e[0],e[1],c.Ya.description,c.Ya.domain,c.Ya.friendlyName,c.Ty))):"Chrome Streaming Receiver"==c.model&&(e=new Um(c.deviceId,c.Ya.friendlyName,c.Qt,c.Ya.domain,c.isAvailable));this.Xf.set(b,e)}for(b in a.hC)this.Us.set(b,a.hC[b]);a.MG&&(this.Mk=a.MG)};d.uz=function(a){this.Mk=a};var Ym=function(a,b,c){this.Mu=a;this.Uc=b;this.Td=new Wm(this.Em.bind(this),b,2E4);c.L7(this);c.m0();nf(this)};d=Ym.prototype;d.zc=function(){var a=this;this.Mu.V4().then(function(b){a.Mu.subscribe(b)},function(){});return this.Td.zc().filter(function(a){return a.isAvailable})};d.W=function(a){return this.Td.W(a)};
d.Em=function(){return this.Mu.N_().then(function(a){return a.map(function(a){hh("MediaRouter.Cloud.CloudReceiver.Sink.Discovered");var c=a.isAvailable()&&!a.p_();return new Um(a.getId(),a.xf(),a.Bb.personalizedInfo.maxRole,"default",c)})})};d.la=function(){return"CloudSinkDiscoveryService"};d.getData=function(){return[{cache:this.Td.b()}]};d.eb=function(){var a=kf(this);a&&this.Td.hH(a.cache)};d.m1=function(a){a=a.fia;this.Td.dm(a);this.Td.uz(u());this.Uc.Ux([a.Ya])};
d.r1=function(a){var b=this.Td.W(a.sinkId);b&&(b.isAvailable=a.isAvailable,this.Td.uz(u()),this.Uc.Fc([b.Ya]))};d.o1=function(a){if(a=this.Td.W(a.sinkId))this.Td.ql(a.Ya.id),this.Td.uz(u()),this.Uc.le([a.Ya])};var Zm=function(a,b){this.input=a;this.domain=b};var $m=function(a,b,c){this.dQ=a;this.y0=b;this.Ck=new Wm(this.Em.bind(this),c,2E4);this.An=new z;nf(this)};$m.prototype.a=B("mr.cloud.discovery.HangoutSinkDiscoveryService");$m.prototype.$A=function(a,b){a=new sm(a,b,a,b);this.An.set(a.getId(),a);return a};$m.prototype.addManualHangout=$m.prototype.$A;$m.prototype.l5=function(a,b){this.vx(new sm(a,b,a,b))};$m.prototype.removeManualHangout=$m.prototype.l5;d=$m.prototype;d.zc=function(){return this.Ck.zc()};d.W=function(a){return this.Ck.W(a)};
d.Em=function(){E(this.a,"Fetching hangouts");var a=this;return me([this.y0.VS(),this.dQ.YS()]).then(function(b){var c=ub(a.An.B());b.forEach(function(b){b.wD?c=c.concat(b.value):C(a.a,"Error discovering Hangouts",b.reason)});var e=c.reduce(function(a,b){var c=a[b.getId()];c?c.merge(b):c=b;a[c.getId()]=c;return a},{});return Object.keys(e).map(function(b){b=e[b];hh("MediaRouter.Cloud.Hangout.Sink.Discovered");return a.vx(b)})})};d.vx=function(a){return new Vm(a)};
d.XO=function(a){a=this.$A(a.input,a.domain);a=this.vx(a);this.Ck.dm(a);return a.Ya};d.j5=function(a){return this.An.remove(a.deviceId)?(this.Ck.ql(a.Ya.id),!0):!1};d.la=function(){return"HangoutSinkDiscoveryService"};d.getData=function(){return[{cache:this.Ck.b(),manualHangouts:this.An.b()}]};d.eb=function(){var a=kf(this);if(a){this.Ck.hH(a.cache);for(var b in a.manualHangouts){var c=a.manualHangouts[b];this.An.set(b,new sm(c.JG,c.ld,c.Wk,c.ck,c.ue,c.Ti))}}};var an=function(a){this.Pb=a};d=an.prototype;d.Qh=function(a,b,c){var e="";b.forEach(function(a){e+="/"+encodeURIComponent(a)});a=new Qj(a+e);c&&(c=ak(c),a.Is(c));return a};d.lg=function(a,b,c){var e=this;return e.Pb.getAuthToken().then(function(f){var g=e.tT(f);return e.eQ(g,a,b,c).va(function(g){if("INVALID_ACCESS_ERROR"==g)return e.FS(f,a,b,c);throw g;})})};d.FS=function(a,b,c,e){var f=this;return this.Pb.ES(a).then(function(){return f.lg(b,c,e)})};
d.eQ=function(a,b,c,e){var f=I(),g=this;a.sendRequest(this.cT(b,c,function(a){a&&!a.error?f.resolve(a):g.j_(a)?f.reject("INVALID_ACCESS_ERROR"):f.reject(g.h3(a))},e));return f.promise};d.j_=function(a){return!!a&&401==a.error.code};d.tT=function(a){a=new wi(void 0,void 0,void 0,!1,!1,a);a.init();return a};d.h3=function(a){return a&&a.error?a.error.errors?a.error.errors[0]:a:Error(a)};d.cT=function(a,b,c,e){a={callback:c,method:b,path:a.toString()};e&&(a.body=e);return a};var bn=function(){this.Se=!1;this.ve=null;this.Lk=!1;this.a=B("mr.cloud.identity.IdentityService");nf(this);this.Q_();this.yL()},cn="cloudview.test@gmail.com castouts.qa.nohangouts@gmail.com castouts.qa@gmail.com castouts-qa.com castouts-test.com google.com youtube.com nest.com waze.com netflix.com twitter.com yahoo.com salesforce.com whirlpool.com nytimes.com kohls.com squareup.com ivci.com".split(" ");d=bn.prototype;d.i_=function(){return"google.com"==this.AF()};
d.C_=function(){return this.Lk||this.Se&&!!this.ve&&(-1!=cn.indexOf(this.ve)||-1!=cn.indexOf(this.AF()))};d.AF=function(){return this.ve?this.ve.substr(this.ve.indexOf("@")+1):""};d.getAuthToken=function(){return this.JD(!0)};
d.JD=function(a){return chrome.identity?new fe(function(b,c){chrome.identity.getAuthToken({interactive:a},function(a){chrome.runtime.lastError?c(Error("Unable to get user auth token: "+chrome.runtime.lastError.message)):null==a?c(Error("User is not logged in (no token found)")):b(a)})}):H(Error("chrome.identity permission required for auth."))};d.ES=function(a){return new fe(function(b){chrome.identity.removeCachedAuthToken({token:a},function(){b()})})};
d.yL=function(){var a=this;this.JD(!1).then(function(b){chrome.identity.getProfileUserInfo(function(c){a.Se=!!c.email||!!c.id;a.ve=c.email||null;b&&!a.Se&&(a.Lk=!0)})},function(b){F(a.a,"Unable to set sign in and email.",b)})};d.Q_=function(){var a=this;chrome.identity.onSignInChanged.addListener(function(b,c){a.Se=c;E(a.a,"Signed in change: "+a.Se);a.Se?a.yL():(a.ve=null,a.Lk=!1)})};
d.R4=function(){var a=this;return this.getAuthToken().then(function(b){var c=window.gapi;if(!c)return C(a.a,"gapi not loaded."),!1;E(a.a,"Setting gapi auth token");c.auth.setToken({access_token:b});return!0})};d.la=function(){return"IdentityService"};d.getData=function(){return[null,{signedIn:this.Se,userEmail:this.ve,kioskAuth:this.Lk}]};d.eb=function(){var a=lf(this);a&&(a.signedIn&&(this.Se=a.signedIn),a.userEmail&&(this.ve=a.userEmail),a.kioskAuth&&(this.Lk=a.kioskAuth))};var dn={zA:{1E3:{other:"0K"},1E4:{other:"00K"},1E5:{other:"000K"},1E6:{other:"0M"},1E7:{other:"00M"},1E8:{other:"000M"},1E9:{other:"0B"},1E10:{other:"00B"},1E11:{other:"000B"},1E12:{other:"0T"},1E13:{other:"00T"},1E14:{other:"000T"}},sN:{1E3:{other:"0 thousand"},1E4:{other:"00 thousand"},1E5:{other:"000 thousand"},1E6:{other:"0 million"},1E7:{other:"00 million"},1E8:{other:"000 million"},1E9:{other:"0 billion"},1E10:{other:"00 billion"},1E11:{other:"000 billion"},1E12:{other:"0 trillion"},1E13:{other:"00 trillion"},
1E14:{other:"000 trillion"}}},en=dn,en=dn;var gn=function(a,b){var c=["0"];b=fn[b][0]&7;if(0<b){c.push(".");for(var e=0;e<b;e++)c.push("0")}return a.replace(/0.00/g,c.join(""))},fn={AED:[2,"dh","\u062f.\u0625.","DH"],ALL:[0,"Lek","Lek"],AUD:[2,"$","AU$"],BDT:[2,"\u09f3","Tk"],BGN:[2,"lev","lev"],BRL:[2,"R$","R$"],CAD:[2,"$","C$"],CDF:[2,"FrCD","CDF"],CHF:[2,"CHF","CHF"],CLP:[0,"$","CL$"],CNY:[2,"\u00a5","RMB\u00a5"],COP:[32,"$","COL$"],CRC:[0,"\u20a1","CR\u20a1"],CZK:[50,"K\u010d","K\u010d"],DKK:[50,"kr.","kr."],DOP:[2,"RD$","RD$"],EGP:[2,
"\u00a3","LE"],ETB:[2,"Birr","Birr"],EUR:[2,"\u20ac","\u20ac"],GBP:[2,"\u00a3","GB\u00a3"],HKD:[2,"$","HK$"],HRK:[2,"kn","kn"],HUF:[34,"Ft","Ft"],IDR:[0,"Rp","Rp"],ILS:[34,"\u20aa","IL\u20aa"],INR:[2,"\u20b9","Rs"],IRR:[0,"Rial","IRR"],ISK:[0,"kr","kr"],JMD:[2,"$","JA$"],JPY:[0,"\u00a5","JP\u00a5"],KRW:[0,"\u20a9","KR\u20a9"],LKR:[2,"Rs","SLRs"],LTL:[2,"Lt","Lt"],MNT:[0,"\u20ae","MN\u20ae"],MVR:[2,"Rf","MVR"],MXN:[2,"$","Mex$"],MYR:[2,"RM","RM"],NOK:[50,"kr","NOkr"],PAB:[2,"B/.","B/."],PEN:[2,"S/.",
"S/."],PHP:[2,"\u20b1","PHP"],PKR:[0,"Rs","PKRs."],PLN:[50,"z\u0142","z\u0142"],RON:[2,"RON","RON"],RSD:[0,"din","RSD"],RUB:[50,"\u20bd","RUB"],SAR:[2,"Rial","Rial"],SEK:[50,"kr","kr"],SGD:[2,"$","S$"],THB:[2,"\u0e3f","THB"],TRY:[2,"TL","YTL"],TWD:[2,"NT$","NT$"],TZS:[0,"TSh","TSh"],UAH:[2,"\u0433\u0440\u043d.","UAH"],USD:[2,"$","US$"],UYU:[2,"$","$U"],VND:[48,"\u20ab","VN\u20ab"],YER:[0,"Rial","Rial"],ZAR:[2,"R","ZAR"]};var hn={CA:".",Ht:",",HA:"%",Pt:"0",VN:"+",NN:"-",FA:"E",IA:"\u2030",It:"\u221e",SN:"NaN",BA:"#,##0.###",qO:"#E0",UN:"#,##0%",tN:"\u00a4#,##0.00",wN:"USD"},jn=hn,jn=hn;var kn=function(a,b,c){this.ln=b||jn.wN;this.yR=c||0;this.Fr=40;this.he=1;this.fj=0;this.wi=3;this.Kr=this.If=0;this.OL=this.TM=!1;this.Sn=this.Ji="";this.Qg="-";this.Zk="";this.Id=1;this.Ci=!1;this.ii=[];this.tt=this.CC=!1;this.pm=0;this.zB=null;"number"==typeof a?this.oP(a):this.xj(a)};d=kn.prototype;d.T8=function(a){if(0<this.fj&&0<a)throw Error("Can't combine significant digits and minimum fraction digits");this.If=a;return this};d.H8=function(a){this.wi=a;return this};
d.h$=function(a){if(0<this.If&&0<=a)throw Error("Can't combine significant digits and minimum fraction digits");this.fj=a;return this};d.xj=function(a){a.replace(/ /g,"\u00a0");var b=[0];this.Ji=this.Vr(a,b);var c=b[0];this.G3(a,b);c=b[0]-c;this.Sn=this.Vr(a,b);b[0]<a.length&&";"==a.charAt(b[0])?(b[0]++,1!=this.Id&&(this.Ci=!0),this.Qg=this.Vr(a,b),b[0]+=c,this.Zk=this.Vr(a,b)):(this.Qg=this.Ji+this.Qg,this.Zk+=this.Sn)};
d.oP=function(a){switch(a){case 1:this.xj(jn.BA);break;case 2:this.xj(jn.qO);break;case 3:this.xj(jn.UN);break;case 4:this.xj(gn(jn.tN,this.ln));break;case 5:this.oB(1);break;case 6:this.oB(2);break;default:throw Error("Unsupported pattern type.");}};d.oB=function(a){this.pm=a;this.xj(jn.BA);this.T8(0);this.H8(2);this.h$(2)};
d.parse=function(a,b){b=b||[0];if(0!=this.pm)throw Error("Parsing of compact numbers is unimplemented");var c;a=a.replace(/ /g,"\u00a0");var e=a.indexOf(this.Ji,b[0])==b[0],f=a.indexOf(this.Qg,b[0])==b[0];e&&f&&(this.Ji.length>this.Qg.length?f=!1:this.Ji.length<this.Qg.length&&(e=!1));e?b[0]+=this.Ji.length:f&&(b[0]+=this.Qg.length);a.indexOf(jn.It,b[0])==b[0]?(b[0]+=jn.It.length,c=Infinity):c=this.r3(a,b);if(e){if(a.indexOf(this.Sn,b[0])!=b[0])return NaN;b[0]+=this.Sn.length}else if(f){if(a.indexOf(this.Zk,
b[0])!=b[0])return NaN;b[0]+=this.Zk.length}return f?-c:c};
d.r3=function(a,b){var c=!1,e=!1,f=!1,g=1,k=jn.CA,n=jn.Ht,v=jn.FA;if(0!=this.pm)throw Error("Parsing of compact style numbers is not implemented");for(var A="";b[0]<a.length;b[0]++){var M=a.charAt(b[0]),V=this.gE(M);if(0<=V&&9>=V)A+=V,f=!0;else if(M==k.charAt(0)){if(c||e)break;A+=".";c=!0}else if(M==n.charAt(0)&&("\u00a0"!=n.charAt(0)||b[0]+1<a.length&&0<=this.gE(a.charAt(b[0]+1)))){if(c||e)break}else if(M==v.charAt(0)){if(e)break;A+="E";e=!0}else if("+"==M||"-"==M)A+=M;else if(1==this.Id&&M==jn.HA.charAt(0)){if(1!=
g)break;g=100;if(f){b[0]++;break}}else if(1==this.Id&&M==jn.IA.charAt(0)){if(1!=g)break;g=1E3;if(f){b[0]++;break}}else break}1!=this.Id&&(g=this.Id);return parseFloat(A)/g};d.format=function(a){if(isNaN(a))return jn.SN;var b=[],c=this.aY(null===this.zB?a:this.zB,a);a/=Math.pow(10,c.cv);b.push(c.prefix);var e=0>a||0==a&&0>1/a;b.push(e?this.Qg:this.Ji);isFinite(a)?(a=a*(e?-1:1)*this.Id,this.tt?this.Kaa(a,b):this.Uz(a,this.he,b)):b.push(jn.It);b.push(e?this.Zk:this.Sn);b.push(c.eM);return b.join("")};
d.HJ=function(a){var b=Math.pow(10,this.wi),c=0>=this.fj?Math.round(a*b):Math.round(this.b6(a*b,this.fj,this.wi));isFinite(c)?(a=Math.floor(c/b),b=Math.floor(c-a*b)):b=0;return{uG:a,fT:b}};
d.Uz=function(a,b,c){if(this.If>this.wi)throw Error("Min value must be less than max value");c||(c=[]);a=this.HJ(a);var e=Math.pow(10,this.wi),f=a.uG,g=a.fT,k=0==f?0:this.hr(f)+1,n=0<this.If||0<g||this.OL&&k<this.fj;a=this.If;n&&(a=this.OL&&0<this.fj?this.fj-k:this.If);for(var v="",k=f;1E20<k;)v="0"+v,k=Math.round(k/10);var v=k+v,A=jn.CA,k=jn.Pt.charCodeAt(0),M=v.length,V=0;if(0<f||0<b){for(f=M;f<b;f++)c.push(String.fromCharCode(k));if(2<=this.ii.length)for(b=1;b<this.ii.length;b++)V+=this.ii[b];
b=M-V;if(0<b)for(var f=this.ii,V=M=0,la,Pb=jn.Ht,Ab=v.length,Qb=0;Qb<Ab;Qb++){if(c.push(String.fromCharCode(k+1*Number(v.charAt(Qb)))),1<Ab-Qb)if(la=f[V],Qb<b){var Ej=b-Qb;(1===la||0<la&&1===Ej%la)&&c.push(Pb)}else V<f.length&&(Qb===b?V+=1:la===Qb-b-M+1&&(c.push(Pb),M+=la,V+=1))}else{b=v;v=this.ii;f=jn.Ht;la=b.length;Pb=[];for(M=v.length-1;0<=M&&0<la;M--){V=v[M];for(Ab=0;Ab<V&&0<=la-Ab-1;Ab++)Pb.push(String.fromCharCode(k+1*Number(b.charAt(la-Ab-1))));la-=V;0<la&&Pb.push(f)}c.push.apply(c,Pb.reverse())}}else n||
c.push(String.fromCharCode(k));(this.CC||n)&&c.push(A);e=""+(g+e);for(g=e.length;"0"==e.charAt(g-1)&&g>a+1;)g--;for(f=1;f<g;f++)c.push(String.fromCharCode(k+1*Number(e.charAt(f))))};d.WA=function(a,b){b.push(jn.FA);0>a?(a=-a,b.push(jn.NN)):this.TM&&b.push(jn.VN);a=""+a;for(var c=jn.Pt,e=a.length;e<this.Kr;e++)b.push(c);b.push(a)};
d.Kaa=function(a,b){if(0==a)this.Uz(a,this.he,b),this.WA(0,b);else{var c=Math.floor(Math.log(a)/Math.log(10)+2E-15);a/=Math.pow(10,c);var e=this.he;if(1<this.Fr&&this.Fr>this.he){for(;0!=c%this.Fr;)a*=10,c--;e=1}else 1>this.he?(c++,a/=10):(c-=this.he-1,a*=Math.pow(10,this.he-1));this.Uz(a,e,b);this.WA(c,b)}};d.gE=function(a){a=a.charCodeAt(0);if(48<=a&&58>a)return a-48;var b=jn.Pt.charCodeAt(0);return b<=a&&a<b+10?a-b:-1};
d.Vr=function(a,b){for(var c="",e=!1,f=a.length;b[0]<f;b[0]++){var g=a.charAt(b[0]);if("'"==g)b[0]+1<f&&"'"==a.charAt(b[0]+1)?(b[0]++,c+="'"):e=!e;else if(e)c+=g;else switch(g){case "#":case "0":case ",":case ".":case ";":return c;case "\u00a4":if(b[0]+1<f&&"\u00a4"==a.charAt(b[0]+1))b[0]++,c+=this.ln;else switch(this.yR){case 0:c+=fn[this.ln][1];break;case 2:var g=this.ln,k=fn[g],c=c+(g==k[1]?g:g+" "+k[1]);break;case 1:c+=fn[this.ln][2]}break;case "%":if(!this.Ci&&1!=this.Id)throw Error("Too many percent/permill");
if(this.Ci&&100!=this.Id)throw Error("Inconsistent use of percent/permill characters");this.Id=100;this.Ci=!1;c+=jn.HA;break;case "\u2030":if(!this.Ci&&1!=this.Id)throw Error("Too many percent/permill");if(this.Ci&&1E3!=this.Id)throw Error("Inconsistent use of percent/permill characters");this.Id=1E3;this.Ci=!1;c+=jn.IA;break;default:c+=g}}return c};
d.G3=function(a,b){for(var c=-1,e=0,f=0,g=0,k=-1,n=a.length,v=!0;b[0]<n&&v;b[0]++)switch(a.charAt(b[0])){case "#":0<f?g++:e++;0<=k&&0>c&&k++;break;case "0":if(0<g)throw Error('Unexpected "0" in pattern "'+a+'"');f++;0<=k&&0>c&&k++;break;case ",":0<k&&this.ii.push(k);k=0;break;case ".":if(0<=c)throw Error('Multiple decimal separators in pattern "'+a+'"');c=e+f+g;break;case "E":if(this.tt)throw Error('Multiple exponential symbols in pattern "'+a+'"');this.tt=!0;this.Kr=0;b[0]+1<n&&"+"==a.charAt(b[0]+
1)&&(b[0]++,this.TM=!0);for(;b[0]+1<n&&"0"==a.charAt(b[0]+1);)b[0]++,this.Kr++;if(1>e+f||1>this.Kr)throw Error('Malformed exponential pattern "'+a+'"');v=!1;break;default:b[0]--,v=!1}0==f&&0<e&&0<=c&&(f=c,0==f&&f++,g=e-f,e=f-1,f=1);if(0>c&&0<g||0<=c&&(c<e||c>e+f)||0==k)throw Error('Malformed pattern "'+a+'"');a=e+f+g;this.wi=0<=c?a-c:0;0<=c&&(this.If=e+f-c,0>this.If&&(this.If=0));this.he=(0<=c?c:a)-e;this.tt&&(this.Fr=e+this.he,0==this.wi&&0==this.he&&(this.he=1));this.ii.push(Math.max(0,k));this.CC=
0==c||c==a};var ln={prefix:"",eM:"",cv:0};kn.prototype.vF=function(a,b){var c=1==this.pm?en.zA:en.sN;null==c&&(c=en.zA);if(3>a)return ln;a=Math.min(14,a);var e=c[Math.pow(10,a)];for(--a;!e&&3<=a;)e=c[Math.pow(10,a)],a--;if(!e)return ln;b=e[b];return b&&"0"!=b?(b=/([^0]*)(0+)(.*)/.exec(b))?{prefix:b[1],eM:b[3],cv:a+1-(b[2].length-1)}:ln:ln};
kn.prototype.aY=function(a){if(0==this.pm)return ln;a=Math.abs(a);var b=this.vF(1>=a?0:this.hr(a),"other").cv;return this.vF(b+this.hr(this.HJ(a/Math.pow(10,b)).uG),"other")};kn.prototype.hr=function(a){for(var b=0;1<=(a/=10);)b++;return b};kn.prototype.b6=function(a,b,c){if(!a)return a;b=b-this.hr(a)-1;if(b<-c)return c=Math.pow(10,c),Math.round(a/c)*c;c=Math.pow(10,b);return Math.round(a*c)/c};var mn=function(a){return 1==a%10&&11!=a%100?"one":2==a%10&&12!=a%100?"two":3==a%10&&13!=a%100?"few":"other"},nn=mn,nn=mn;var on=function(a,b){if(void 0===b){b=a+"";var c=b.indexOf(".");b=Math.min(-1==c?0:b.length-c-1,3)}return 1==(a|0)&&0==b?"one":"other"},pn=on,pn=on;var qn=function(a){this.Qk=[];this.cy=[];this.Fx=new kn(1);this.t3(a)},rn=/'([{}#].*?)'/g,sn=/''/g;d=qn.prototype;d.format=function(a){return this.nq(a,!1)};d.nq=function(a,b){if(0==this.cy.length)return"";var c=[];this.yv(this.cy,a,b,c);for(a=c.join("");0<this.Qk.length;)a=a.replace(this.tu(this.Qk),this.Qk.pop());return a};
d.yv=function(a,b,c,e){for(var f=0;f<a.length;f++)switch(a[f].type){case 4:e.push(a[f].value);break;case 3:var g=a[f].value;this.eT(g,b,e);break;case 2:g=a[f].value;this.dT(g,b,c,e);break;case 0:g=a[f].value;this.uD(g,b,pn,c,e);break;case 1:g=a[f].value;this.uD(g,b,nn,c,e);break;default:$a("Unrecognized block type: "+a[f].type)}};d.eT=function(a,b,c){b=b[a];l(b)?(this.Qk.push(b),c.push(this.tu(this.Qk))):c.push("Undefined parameter - "+a)};
d.dT=function(a,b,c,e){var f=a.rp;l(b[f])?(f=a[b[f]],l(f)||(f=a.other),this.yv(f,b,c,e)):e.push("Undefined parameter - "+f)};d.uD=function(a,b,c,e,f){var g=a.rp,k=a.qB,n=+b[g];isNaN(n)?f.push("Undefined or invalid parameter - "+g):(k=n-k,g=a[b[g]],l(g)||(c=this.Fx.hW?c(k,this.Fx.hW()):c(k),g=a[c],l(g)||(g=a.other)),a=[],this.yv(g,b,e,a),b=a.join(""),e?f.push(b):(e=this.Fx.format(k),f.push(b.replace(/#/g,e))))};d.t3=function(a){a&&(a=this.WZ(a),this.cy=this.Wr(a))};
d.WZ=function(a){var b=this.Qk,c=t(this.tu,this);a=a.replace(sn,function(){b.push("'");return c(b)});return a=a.replace(rn,function(a,f){b.push(f);return c(b)})};d.hq=function(a){var b=0,c=[],e=[],f=/[{}]/g;f.lastIndex=0;for(var g;g=f.exec(a);){var k=g.index;"}"==g[0]?(c.pop(),0==c.length&&(g={type:1},g.value=a.substring(b,k),e.push(g),b=k+1)):(0==c.length&&(b=a.substring(b,k),""!=b&&e.push({type:0,value:b}),b=k+1),c.push("{"))}b=a.substring(b);""!=b&&e.push({type:0,value:b});return e};
var tn=/^\s*(\w+)\s*,\s*plural\s*,(?:\s*offset:(\d+))?/,un=/^\s*(\w+)\s*,\s*selectordinal\s*,/,vn=/^\s*(\w+)\s*,\s*select\s*,/;d=qn.prototype;d.R2=function(a){return tn.test(a)?0:un.test(a)?1:vn.test(a)?2:/^\s*\w+\s*/.test(a)?3:5};
d.Wr=function(a){var b=[];a=this.hq(a);for(var c=0;c<a.length;c++){var e={};if(0==a[c].type)e.type=4,e.value=a[c].value;else if(1==a[c].type)switch(this.R2(a[c].value)){case 2:e.type=2;e.value=this.y3(a[c].value);break;case 0:e.type=0;e.value=this.u3(a[c].value);break;case 1:e.type=1;e.value=this.s3(a[c].value);break;case 3:e.type=3;e.value=a[c].value;break;default:$a("Unknown block type for pattern: "+a[c].value)}else $a("Unknown part of the pattern.");b.push(e)}return b};
d.y3=function(a){var b="";a=a.replace(vn,function(a,c){b=c;return""});var c={};c.rp=b;a=this.hq(a);for(var e=0;e<a.length;){var f=a[e].value;e++;if(1==a[e].type)var g=this.Wr(a[e].value);else $a("Expected block type.");c[f.replace(/\s/g,"")]=g;e++}return c};
d.u3=function(a){var b="",c=0;a=a.replace(tn,function(a,e,f){b=e;f&&(c=parseInt(f,10));return""});var e={};e.rp=b;e.qB=c;a=this.hq(a);for(var f=0;f<a.length;){var g=a[f].value;f++;if(1==a[f].type)var k=this.Wr(a[f].value);else $a("Expected block type.");e[g.replace(/\s*(?:=)?(\w+)\s*/,"$1")]=k;f++}return e};
d.s3=function(a){var b="";a=a.replace(un,function(a,c){b=c;return""});var c={};c.rp=b;c.qB=0;a=this.hq(a);for(var e=0;e<a.length;){var f=a[e].value;e++;if(1==a[e].type)var g=this.Wr(a[e].value);else $a("Expected block type.");c[f.replace(/\s*(?:=)?(\w+)\s*/,"$1")]=g;e++}return c};d.tu=function(a){return"\ufddf_"+(a.length-1).toString(10)+"_"};var wn=chrome.i18n.getMessage("1522140683318860351"),xn=chrome.i18n.getMessage("4246483347873264186"),yn=chrome.i18n.getMessage("5991427458288444010"),zn=chrome.i18n.getMessage("6063910461797960050"),An=chrome.i18n.getMessage("7735695102441495789"),Bn=chrome.i18n.getMessage("4575332923598659024"),Cn=chrome.i18n.getMessage("2297080986956220930"),Dn=new qn(Cn),En=function(a,b){return Dn.format({ORGANIZER:a,PARTICIPANTS:b})};var Fn=function(a){this.nb=a;this.a=B("mr.cloud.mesi.MesiService")},Gn={request_header:{client_version:{client_id:"39"}},search_sources:["0"]};
Fn.prototype.VS=function(){var a=wm.ig;.1>Math.random()&&(a=a.replace("v1","v1_preprod"));a=this.nb.Qh(a,["hangouts","search"]);E(this.a,"Retrieving Hangouts from MESI: "+a);return this.nb.lg(a,"POST",Gn).then(function(a){var c=[];a.result&&(c=a.result.map(function(a){var b=a.hangout,c,k;b.external_key?(c=b.external_key.value.replace(/@.*/,""),k=b.external_key.service):b.sharing_url&&(k=b.sharing_url.split("/"),c=k[4],k=k[3]);var n=b.meeting_room_name,v;b.meeting_domain?(v=b.meeting_domain,n&&(c=
n,k=v)):"BUSINESS"==b.type&&b.company_title&&(v=b.company_title.toLowerCase());var A=En("",0);if((a=a.participant)&&0<a.length){var M=a[0].display_name;a=a.reduce(function(a,b){a.add(b.user_id);"ORGANIZER"==b.role&&(M=b.display_name);return a},new Oc);A=En(M,a.P())}return new sm(c,k,n,v,A,b.hangout_id)}));return c})};var Hn=function(a,b,c){this.state=a;this.type=null!=b?b:null;this.results=null!=c?c:null},In=function(a){this.nb=a};In.$inject=["gapiService"];d=In.prototype;d.A6=function(a,b,c){var e=this;return this.$J(Gm,a,b,c,35E3).then(function(a){return e.JF(a)})};d.D6=function(a,b,c){var e=this;return this.$J(Fm,a,b,c,23E3).then(function(a){var b=a.state;return"done"==b?(a=e.HI(a),new Hn(b,a.type,new Bm(a.sessionDescription))):new Hn(b)})};d.I6=function(a){return this.Qe(a,Em,{})};
d.$J=function(a,b,c,e,f){var g={_webrtcMessage:JSON.stringify(c.presentationUrl?new Bm(c.description,null,c.presentationUrl):new Bm(c.description))};c.settings&&(g._settings=c.settings.Yz());c.mediaConstraints&&(g._optMediaConstraints=JSON.stringify(c.mediaConstraints));e&&(g._user=JSON.stringify(e));return this.Qe(b,a,g,f)};d.JF=function(a){var b=a.state;switch(b){case "done":return G(this.d3(a));case "queued":case "inProgress":var c=this;return c.Wba(a).then(function(a){return c.JF(a)});default:return G(new Hn(b))}};
d.Wba=function(a){var b=this,c=I(),e=setInterval(function(){b.LS(a.id).then(function(a){"queued"!=a.state&&"inProgress"!=a.state&&(clearInterval(e),c.resolve(a))})},2E3);return c.promise};d.d3=function(a){a=this.HI(a);return"__cloud_webrtc_session_message__"==a.type?new Hn("done","knocking_cloud_webrtc_session_message",new Bm(a.sessionDescription)):new Hn("done",a.type)};
d.Qe=function(a,b,c,e){a={deviceId:a,name:"_cloudCast."+b.name,parameters:c,expirationTimeoutMs:e||1E4};b={};e&&(b.responseAwaitMs=Math.min(e+5E3,25E3));e=this.nb.Qh(um.ig,["commands"],b);return this.nb.lg(e,"POST",a)};d.HI=function(a){return a.results&&a.results.results?JSON.parse(a.results.results):null};d.LS=function(a){a=this.nb.Qh(um.ig,["commands",a]);return this.nb.lg(a,"GET")};var Jn=function(a,b,c,e){this.wf=a;this.Pb=b;this.Po=c;this.Kb=e};d=Jn.prototype;d.KY=function(a,b,c){var e=this;return this.v6(a,b,c).then(function(a){return e.wY(a,b.id)})};d.EY=function(a){var b=this;return this.Po.cU().then(function(c){b.Kb.jd(new yh("TURN_CREDENTIALS",{credentials:c}),a.id)})};
d.v6=function(a,b,c){b=c.deviceId;var e=this.Pb.ve,e=e?new zm(e):void 0;a=a.data;switch(c.Qt){case "owner":Sm(0);break;case "manager":Sm(1);break;case "user":Sm(2);break;case "viewer":Sm(3)}return"viewer"==c.Qt?this.wf.A6(b,a,e):this.wf.D6(b,a,e)};
d.wY=function(a,b){if("done"!=a.state)return H(Error("Offer not executed by receiver. State: "+a.state));switch(a.type){case "__cloud_webrtc_session_message__":a=new yh("ANSWER",a.results.sessionDescription);this.Kb.jd(a,b);break;case "knocking_cloud_webrtc_session_message":Pm(0);a=new yh("KNOCK_ANSWER",a.results.sessionDescription);this.Kb.jd(a,b);break;case "knock_denied":Pm(1);this.IF(xn,b);break;case "knock_timeout":Pm(2);this.IF(yn,b);break;default:return H(Error("Invalid message type: "+a.type))}return G()};
d.IF=function(a,b){a=new Zg(a,"warning","dismiss");a.u8(!0);this.Kb.zf().send(a);this.Kb.jd(new yh("STOP"),b)};var Kn=function(){this.Wj=null;this.a=B("mr.cloud.messaging.CloudMessageListener");this.iy=[]};d=Kn.prototype;d.L7=function(a){this.Wj=a};d.onMessage=function(a){this.Wj?this.WI(a):(F(this.a,"[pending] "+a.data.notification),this.iy.push(a))};d.m0=function(){var a=this;this.Wj&&(this.iy.forEach(function(b){a.WI(b)}),this.iy=[])};
d.WI=function(a){var b=this;if(a.data.notification&&(F(this.a,"[processing] "+a.data.notification),(a=JSON.parse(a.data.notification))&&a.events)){var c=Pf.M();a.events.forEach(function(a){var f=c.Hm(a.deviceId);switch(a.type){case "deviceCreated":b.n1(a,f);break;case "deviceUpdated":b.s1(a,f);break;case "deviceDeleted":b.p1(a,f);break;default:F(b.a,"[unhandled event] "+JSON.stringify(a))}})}};
d.n1=function(a,b){a=new Um(a.deviceId,a.statePatch._cloudCast.settings.receiverName,"owner","default",!0);this.Wj.m1({sinkId:b,cloudSink:a})};d.s1=function(a,b){a.statePatch._cloudCast&&a.statePatch._cloudCast.appStatus&&this.Wj.r1({sinkId:b,isAvailable:"available"==a.statePatch._cloudCast.appStatus})};d.p1=function(a,b){this.Wj.o1({sinkId:b})};var Ln=function(a,b){this.Pb=a;this.Kb=b};
Ln.prototype.HY=function(a,b,c){switch(a.type){case "REFRESH_AUTH":var e=c.deviceId,f=c.Ty,g=this;return this.Pb.R4().then(function(){g.Kb.jd(new yh("AUTH_READY",{hangoutId:e,resolvedId:f}),b.id)});case "LOCAL_PRESENT":return e=c.deviceId,f=c.Ty,this.Kb.jd(new yh("AUTH_READY",{hangoutId:e,resolvedId:f,conferenceMode:!a.data.local}),b.id),G();case "STATUS_REQUEST":return this.Kb.jd(a,b.id),G();case "STATUS_RESPONSE":return this.Kb.jd(a,b.id,!0),a.data.routeDescription||this.Kb.jd(a,b.id),G();case "HANGOUT_INACTIVE":return this.Kb.oj(b,
4,new Zg(An,"warning","dismiss"));case "HANGOUT_INVALID":return this.Kb.oj(b,3,new Zg(Bn,"warning","dismiss"));default:return H(Error("Unknown type: "+a.type))}};var Mn=function(a,b,c){this.Kj=a;this.jn=b;this.Kb=c};
Mn.prototype.d4=function(a,b,c,e){switch(a){case "cloud":break;case "mesi":break;default:return H(Error("Unrecognized channel type"))}if(!b.type)return H(Error("Message has no type"));switch(b.type){case "STOP":return this.Kb.oj(c,1,null);case "SESSION_START_SUCCESS":return Qm(0),G();case "SESSION_END":return G();case "SESSION_FAILURE":return Qm(1),this.Kb.oj(c,2,new Zg(wn,"warning","dismiss"));case "__webrtc_stats__":return G();case "PRESENTATION_CONNECTION_MESSAGE":return this.Kb.jd(b.data,c.id,
!0),G();case "OFFER":return this.Kj.KY(b,c,e);case "GET_TURN_CREDENTIALS":return this.Kj.EY(c);case "REFRESH_AUTH":case "LOCAL_PRESENT":case "MUTE":case "STATUS_REQUEST":case "STATUS_RESPONSE":case "HANGOUT_INACTIVE":case "HANGOUT_INVALID":return this.jn.HY(b,c,e);case "new_session":return this.Kb.jd(b,c.id,!0),G();case "remove_session":return this.Kb.jd(b,c.id,!0),this.Kb.Wc(c.id),G();default:return H(Error("Unknown type: "+b.type))}};var Nn=function(){var a=this;this.a=B("mr.cloud.settings.SettingsService");this.Jx=null;chrome.settingsPrivate.onPrefsChanged.addListener(function(b){if(a.Jx){b=ha(b);for(var c=b.next();!c.done;c=b.next())if(c=c.value,"media_router.cloudservices.enabled"==c.key){a.Jx.call(null,c.value);break}}})};d=Nn.prototype;d.k9=function(a){this.Jx=a};d.jba=function(){var a=this.a;chrome.storage.sync.set({"mr.cloud.cloudEnabled":!0},function(){chrome.runtime.lastError&&D(a,"Error setting cloud setting: "+JSON.stringify(chrome.runtime.lastError))})};
d.ZT=function(){var a=this;return this.VD().va(function(){return a.VD().va(function(b){D(a.a,"Error retrieving cloud on setting: "+JSON.stringify(b));return!1})})};d.VD=function(){return this.wE("mr.cloud.cloudEnabled").then(function(a){return!!a["mr.cloud.cloudEnabled"]})};d.wE=function(a){var b=I();chrome.storage.sync.get(a,function(a){chrome.runtime.lastError?b.reject(chrome.runtime.lastError):b.resolve(a)});return b.promise};
d.XT=function(){var a=this;return this.TD().va(function(){return a.TD().va(function(b){D(a.a,"Error retrieving cloud enabled setting: "+JSON.stringify(b));return!1})})};d.TD=function(){return this.MW("media_router.cloudservices.enabled").then(function(a){return!!a.value})};d.MW=function(a){var b=I();chrome.settingsPrivate.getPref(a,function(a){chrome.runtime.lastError?b.reject(chrome.runtime.lastError):b.resolve(a)});return b.promise};
d.j9=function(){var a=this.a;chrome.storage.sync.set({"mr.cloud.notifiedHangouts":!0},function(){chrome.runtime.lastError&&D(a,"Error setting notified Hangout privacy: "+JSON.stringify(chrome.runtime.lastError))})};d.xW=function(){var a=this;return this.OE().va(function(){return a.OE().va(function(b){D(a.a,"Error retrieving hangouts notified setting: "+JSON.stringify(b));return!1})})};d.OE=function(){return this.wE("mr.cloud.notifiedHangouts").then(function(a){return!!a["mr.cloud.notifiedHangouts"]})};var On=function(a){this.a=B("mr.cloud.CredentialService");this.nb=a};On.prototype.cU=function(){var a=this,b=I(),c=xm.ig+"/iceconfig?key="+xm.kba;E(this.a,"Requesting TURN credentials from "+c);var e=bg(c,function(){return a.J2(e,b)},"POST",void 0,{"Content-Type":"application/json"});return b.promise};On.prototype.J2=function(a,b){a.Fd()?(E(this.a,"Got TURN credentials: "+a.vk()),b.resolve(this.x1(a.kX()))):b.resolve(this.y1(null))};
On.prototype.x1=function(a){try{var b=[];a.iceServers.forEach(function(a){a.urls.forEach(function(e){0==e.indexOf("turn:")&&b.push({url:e,credential:a.credential,username:a.username})})});return b}catch(c){return C(this.a,"Error parsing TURN credentials.",c),[]}};On.prototype.y1=function(a){C(this.a,"XHR failed fetching TURN credentials.",a instanceof Error?a:void 0);return[]};var Pn=function(){this.Av=this.Po=this.pe=this.Xk=this.jn=this.Kj=this.wf=this.Ew=this.xu=this.zx=this.Nu=this.Lu=this.nb=this.ju=null};ra(Pn);d=Pn.prototype;d.mk=function(){null==this.ju&&(this.ju=new bn);return this.ju};d.Rm=function(){null==this.nb&&(this.nb=new an(this.mk()));return this.nb};d.WT=function(){null==this.Lu&&(this.Lu=new Im(this.Rm()));return this.Lu};d.UD=function(){this.Av||(this.Av=new Kn);return this.Av};
d.$T=function(a){null==this.Nu&&(this.Nu=new Ym(this.WT(),a,this.UD()));return this.Nu};d.cW=function(){null==this.zx&&(this.zx=new Fn(this.Rm()));return this.zx};d.GT=function(){null==this.xu&&(this.xu=new ym(this.Rm(),this.mk()));return this.xu};d.gV=function(a){null==this.Ew&&(this.Ew=new $m(this.GT(),this.cW(),a));return this.Ew};d.nE=function(){null==this.wf&&(this.wf=new In(this.Rm()));return this.wf};d.YT=function(a){null==this.Kj&&(this.Kj=new Jn(this.nE(),this.mk(),this.YX(),a));return this.Kj};
d.$U=function(a){null==this.jn&&(this.jn=new Ln(this.mk(),a));return this.jn};d.eW=function(a){null==this.Xk&&(this.Xk=new Mn(this.YT(a),this.$U(a),a));return this.Xk};d.CX=function(){null==this.pe&&(this.pe=new Nn);return this.pe};d.YX=function(){null==this.Po&&(this.Po=new On(this.Rm()));return this.Po};var Qn=function(a,b,c){se.call(this);this.Pk=null!=c?t(a,c):a;this.ge=b;this.jm=t(this.F2,this);this.fu=[]};w(Qn,se);d=Qn.prototype;d.Gl=!1;d.Nn=0;d.Pa=null;d.uv=function(a){this.fu=arguments;this.Pa||this.Nn?this.Gl=!0:this.dv()};d.stop=function(){this.Pa&&(bf(this.Pa),this.Pa=null,this.Gl=!1,this.fu=[])};d.pause=function(){this.Nn++};d.resume=function(){this.Nn--;this.Nn||!this.Gl||this.Pa||(this.Gl=!1,this.dv())};d.L=function(){Qn.R.L.call(this);this.stop()};
d.F2=function(){this.Pa=null;this.Gl&&!this.Nn&&(this.Gl=!1,this.dv())};d.dv=function(){this.Pa=af(this.jm,this.ge);this.Pk.apply(null,this.fu)};var Sn=function(a){this.Xa={};if(a)for(var b=0;b<a.length;b++)this.Xa[Rn(a[b])]=null;for(var c in Object.prototype)$a(c+" should not be enumerable in Object.prototype.")},Tn={},Rn=function(a){return a in Tn||32==String(a).charCodeAt(0)?" "+a:a},Un=function(a){return 32==a.charCodeAt(0)?a.substr(1):a};d=Sn.prototype;d.add=function(a){this.Xa[Rn(a)]=null};d.TA=function(a){for(var b=0;b<a.length;b++)this.Xa[Rn(a[b])]=null};d.gP=function(a){for(var b in a.Xa)this.Xa[b]=null};
d.clear=function(){this.Xa={}};d.clone=function(){var a=new Sn;a.gP(this);return a};d.contains=function(a){return Rn(a)in this.Xa};d.equals=function(a){return this.or(a)&&a.or(this)};d.forEach=function(a,b){for(var c in this.Xa)a.call(b,Un(c),void 0,this)};d.P=Object.keys?function(){return Object.keys(this.Xa).length}:function(){var a=0,b;for(b in this.Xa)a++;return a};d.B=Object.keys?function(){return Object.keys(this.Xa).map(Un,this)}:function(){var a=[],b;for(b in this.Xa)a.push(Un(b));return a};
d.Gb=function(){for(var a in this.Xa)return!1;return!0};d.or=function(a){for(var b in this.Xa)if(!(b in a.Xa))return!1;return!0};d.remove=function(a){a=Rn(a);return a in this.Xa?(delete this.Xa[a],!0):!1};d.Sd=function(){return Bc(this.B())};var Vn=function(){this.Ub=null;this.a=B("mr.IssueSenderImpl")};Vn.prototype.init=function(a){this.Ub=a};Vn.prototype.send=function(a){if(this.Ub)if(this.Ub.onIssue)this.Ub.onIssue(a);else C(this.a,"MediaRouterService.onIssue not defined.");else C(this.a,"MediaRouterService is not set.")};var Wn=new Oc;var Xn=function(a,b){J.call(this,"internal_message");this.routeId=a;this.message=b};w(Xn,J);var Yn=function(a,b,c){se.call(this);this.JJ=a;this.Qe=b;this.z0=c;this.onMessage=p;c.listen("internal_message",this.Qr,!1,this)};w(Yn,se);Yn.prototype.sendMessage=function(a,b){return this.Qe(this.JJ,a,b)};Yn.prototype.Qr=function(a){if(a.routeId==this.JJ)this.onMessage(a.message)};Yn.prototype.L=function(){this.z0.od("internal_message",this.Qr,!1,this)};var Zn=new Yn("",function(){return G()},new K),$n=function(a){this.v=a};
$n.prototype.Cq=function(a){var b=this.v.lw(a);return b?new Yn(a,t(b.ih,b),this.v.qw()):Zn};var ao=function(){this.a=B("mr.ProviderManager");this.Kd=[];this.Md=new z;this.sl=new z;this.Te=new Sn;this.Xi=new Sn;this.zi=new z;this.Ub=null;this.Hl=!1;this.KJ=new K;this.LJ=new Qn(this.G6,500,this);this.baa=new Qn(this.BS,500,this);this.Fn=new Tl(this,524288);this.jy=0;this.HG=new Vn;this.Il=new z;this.Jr=-1==window.navigator.userAgent.indexOf("Windows");this.Ir=[];this.rr=[];this.createRoute=this.Ce;this.joinRoute=this.ni;this.connectRouteByRouteId=this.Fh;this.terminateRoute=this.Wc;this.startObservingMediaSinks=
this.jj;this.stopObservingMediaSinks=this.mj;this.sendRouteMessage=this.ih;this.sendRouteBinaryMessage=this.F6;this.startListeningForRouteMessages=this.paa;this.stopListeningForRouteMessages=this.Rz;this.startObservingMediaRoutes=this.ij;this.stopObservingMediaRoutes=this.lj;this.onPresentationSessionDetached=this.detachRoute=this.vg;this.enableMdnsDiscovery=this.VC;this.searchSinksAndCreateRoute=this.q6;this.searchSinks=this.Uf;this.updateMediaSinks=this.yba};d=ao.prototype;d.iW=function(a){return this.zi.get(a).Rk().then(function(a){return a})};
d.S4=function(a){a.forEach(this.W4,this)};d.Ed=function(a,b){this.zi.set("webrtc",new Gh(new rm(this)));this.zi.set("cast_streaming",new Gh(new om(this)));var c=ci.M();c.U8(this);c.q8(Pn.M().mk());this.zi.set("hangouts",c);c=new $n(this);Yg||(Yg=c);this.Ub=a;this.HG.init(a);this.Fn.init(this.Ub.onRouteMessagesReceived.bind(this.Ub));this.S4(b);nf(this)};
d.W4=function(a){if(this.Jq(a.getName()))D(this.a,"Provider "+a.getName()+" already registered.");else try{a.Ed(),this.Kd.push(a),this.Il.set(a.getName(),0)}catch(b){D(this.a,"Provider "+a.getName()+" failed to initialize.",b)}};
d.No=function(a,b){var c=this,e=new Promise(function(e,g){var k=null;b&&(c.Z3(),k=window.setTimeout(function(){k=null;g(new zk(2,"timeout after "+b+" ms."));a.cancel()},b));a.then(function(a){null!=k&&window.clearTimeout(k);e(a)},function(a){null!=k&&window.clearTimeout(k);g(a instanceof zk?a:new zk(0,a.message,a.stack))})});b&&(e=e.then(function(a){c.lB();return a},function(a){c.lB();throw a;}));return e};d.Z3=function(){this.jy++;this.yx()};d.lB=function(){this.jy--;this.yx()};
d.Ce=function(a,b,c,e,f,g,k){var n=this,v=this.SW(a,b);if(!v)return Promise.reject(new zk(7,"No provider supports createRoute with source: "+a+" and sink: "+b));Wn.add(b);this.Fc();g=g&&0<g?g:6E4;a=v.Ce(a,b,c,k||!1,g,e,f);return this.No(a,g).then(function(a){Wn.remove(b);n.Fc();return a},function(a){C(n.a,"Error creating route.",a);Wn.remove(b);n.Fc();throw a;})};
d.Fh=function(a,b,c,e,f,g){var k=this.Md.get(b);if(!k)return Promise.reject(new zk(7,"No provider supports join "+b));a=k.Fh(a,b,c,e,f);return this.No(a,g&&0<g?g:3E4)};d.ni=function(a,b,c,e,f,g){var k=this.RW(a);if(!k)return Promise.reject(new zk(7,"No provider supports join "+b));f=f&&0<f?f:3E4;a=k.ni(a,b,g||!1,f,c,e);return this.No(a,f)};d.Wc=function(a){var b=this.Md.get(a);return b?this.No(this.yH(a).then(function(){b.Wc(a)})):Promise.reject(new zk(3,"Route not found for routeId "+a))};
d.jj=function(a){this.Te.contains(a)||(this.Te.add(a),this.Kd.forEach(function(b){b.jj(a)}));this.cs(a)};d.mj=function(a){this.Te.remove(a)?this.RC(a):E(this.a,"No existing query "+a)};d.RC=function(a){this.Kd.forEach(function(b){b.mj(a)})};
d.cs=function(a){if("urn:x-org.chromium.media:source:tab:-1"==a)D(this.a,"No sinks for sourceUrn: "+a);else{var b=new z,c=[];this.Kd.forEach(function(e){var f=e.Km(a);0<f.sinks.length&&(c=f.origins);f.sinks.forEach(function(a){b.ab(a.id)?D(this.a,"Detected duplicate sink "+a.id+" from provider: "+e.getName()):b.set(a.id,a)},this)},this);this.H6(a,b.B(),c||[])}};d.H6=function(a,b,c){E(this.a,"Sending "+b.length+" sinks to MR for "+a);bo(b);this.Ub.onSinksReceived(a,b,c)};
var bo=function(a){a.forEach(function(a){a.isLaunching_=Wn.contains(a.id)})};d=ao.prototype;d.ih=function(a,b,c){var e=this.Md.get(a);return e?this.No(e.ih(a,b,c),3E4):Promise.reject(Error("Invalid route ID "+a))};d.F6=function(a){return Promise.reject(Error("Route "+a+" does not support sending binary data"))};d.paa=function(a){this.Fn.O_(a)};d.Rz=function(a){this.Fn.Rz(a)};d.vg=function(a){var b=this.Md.get(a);b?b.vg(a):E(this.a,"Route "+a+" does not exist.")};
d.VC=function(){this.Jr=!0;this.Ir.forEach(function(a){a()});this.Ir.length=0;var a=this;this.Te.forEach(function(b){a.cs(b)})};d.SW=function(a,b){return this.Kd.find(function(c){return c.km(a,b)})||null};d.RW=function(a){return this.Kd.find(function(b){return b.Ej(a)})||null};d.BS=function(){this.Te.forEach(function(a){this.cs(a)},this)};d.yx=function(){this.Ub.setKeepAlive(0<this.jy||0<this.rr.length)};
d.ij=function(a){this.Xi.contains(a)||(this.Hl=!0,this.Xi.add(a),this.Kd.forEach(function(b){b.ij(a)}));this.LJ.uv()};d.lj=function(a){this.Xi.remove(a)?(0==this.Xi.length&&(this.Hl=!1),this.Kd.forEach(function(b){b.lj(a)})):E(this.a,"No existing route query "+a)};
d.G6=function(){if(this.Hl){var a=[];this.Kd.forEach(function(b){a=a.concat(b.Df())});this.Xi.forEach(function(b){var c=[];this.Kd.forEach(function(a){a.Df().forEach(function(f){!f.Rj&&a.Ej(b,f)&&c.push(f.id)})});this.Ub.onRoutesUpdated(a,b,c)},this)}};var co=function(a,b,c,e,f,g,k){this.aaa=b;this.e6=c;this.W$=e;this.IJ=f;this.$$=g;this.q0=k};d=ao.prototype;d.la=function(){return"ProviderManager"};
d.getData=function(){var a={};this.Md.forEach(function(b,c){a[c]=b.getName()});return[new co(this.Kd.map(function(a){return a.getName()}),this.Te.B(),this.Xi.B(),this.Hl,a,this.Il.b(),this.Jr)]};d.eb=function(){var a=kf(this);if(a){this.Te.TA(a.aaa);this.Xi.TA(a.e6);this.Hl=a.W$;for(var b in a.IJ){var c=this.Jq(a.IJ[b]);this.Md.set(b,c)}this.Il.addAll(a.$$);a.q0&&this.VC()}};d.lw=function(a){return this.Md.get(a)};d.dl=function(a,b){this.Md.set(b.id,a);this.Sg(a,b)};
d.Ei=function(a,b){this.yH(b.id);this.Md.remove(b.id);this.Fn.Ei(b.id);this.Sg(a,b)};d.Sg=function(){this.Hl&&this.LJ.uv()};d.gI=function(a){var b=this.Md.get(a.id);b&&this.Sg(b,a)};d.ke=function(a,b,c){this.Md.ab(b)?("string"!=typeof c&&(c=JSON.stringify(c)),this.Fn.send(b,c)):D(this.a,"Got route message for closed route "+b)};d.onPresentationConnectionStateChanged=function(a,b){this.Ub.onPresentationConnectionStateChanged(a,b)};
d.onPresentationConnectionClosed=function(a,b,c){if("function"!=typeof this.Ub.onPresentationConnectionClosed)this.onPresentationConnectionStateChanged(a,"closed");else this.Ub.onPresentationConnectionClosed(a,b,c)};d.Ox=function(a){this.sl.remove(a);var b=this.Md.get(a);b&&b.Wc(a)};d.Pr=function(a,b,c){this.KJ.dispatchEvent(new Xn(b,c))};d.Fc=function(){this.baa.uv()};
d.onSinkAvailabilityUpdated=function(a,b){if("function"==typeof this.Ub.onSinkAvailabilityUpdated&&this.Il.get(a.getName())!=b){var c=this.mC();this.Il.set(a.getName(),b);a=this.mC();c!=a&&(this.Ub.onSinkAvailabilityUpdated(a),0==a&&(this.Te.forEach(function(a){this.RC(a)},this),this.Te.clear()))}};d.mC=function(){return this.Il.B().reduce(function(a,b){return Math.max(a,b)},0)};d.qw=function(){return this.KJ};d.zf=function(){return this.HG};
d.yH=function(a){if(this.sl.ab(a)){var b=this;return this.zi.get(this.sl.get(a)).Rk().then(function(c){b.sl.remove(a);return c.bM()})}return G(!1)};d.Go=function(a,b,c){var e=a.Tm(b.sinkId);this.sl.set(b.id,e);return this.zi.get(e).Rk().then(function(e){return e.Go(b,b.mediaSource,a.Af(b.sinkId),c)})};d.ot=function(a,b,c,e,f){var g=this.sl.get(b.id);return g?this.zi.get(g).Rk().then(function(g){return g.ot(b,c,a.Af(b.sinkId),e,f)}):H(Error("Route "+b.id+" is not mirroring"))};
d.Ey=function(a){this.Jr?a():-1==this.Ir.indexOf(a)&&this.Ir.push(a)};d.Vw=function(){return this.Jr};d.eh=function(a,b){var c=this.rr.indexOf(a),e=0<=c;b&&!e?this.rr.push(a):!b&&e&&this.rr.splice(c,1);this.yx()};d.Jq=function(a){return this.Kd.find(function(b){return b.getName()==a})||null};d.VE=function(a){return a.startsWith("pseudo:")?a.substring(7):null};
d.q6=function(a,b,c,e,f,g,k,n){var v=this.VE(a),v=v?this.Jq(v):null,A=null;v&&(A=v.Uf(b,c));if(A)return this.Ub.onSearchSinkIdReceived(a,A.id),this.Ce(b,A.id,e,f,g,k,n);this.Ub.onSearchSinkIdReceived(a,"");return Promise.reject(new zk(0,"No sink found for search input: "+c.input+" and source: "+b))};d.Uf=function(a,b,c){a=(a=this.VE(a))?this.Jq(a):null;var e=null;a&&(e=a.Uf(b,c));return e?e.id:""};d.yba=function(a){this.Te.contains(a)||this.cs(a)};var eo=function(a,b){this.Za=a;this.iaa=b;this.On=I();this.m=this.On.promise;this.Nc=Yg.Cq(a.id);this.ra=I();this.Ab=!1;this.Bo();this.Dz();this.xb(new yh("GET_TURN_CREDENTIALS"))};eo.prototype.start=function(){var a=this;return this.m.then(function(b){if(b.lr())return H(Error("Presentation already started"));b.start();return a.ra.promise})};eo.prototype.stop=function(){var a=this;this.Ab=!1;return this.m.then(function(b){b.stop();a.m=H(Error("Peer connection has already been stopped"))})};
eo.prototype.Bo=function(){var a=this;this.Nc.onMessage=function(b){if(b.type)switch(b.type){case "TURN_CREDENTIALS":a.On.resolve(new Eh(a.Za.id,b.data.credentials));break;case "ANSWER":a.m.then(function(a){a.setRemoteDescription(b.data)});break;case "STOP":a.ra.reject("Stop signal received");a.stop();break;default:throw Error("Unknown message type: "+b.type);}else a.m.then(function(a){a.w6({type:"PRESENTATION_CONNECTION_MESSAGE",data:b})})}};
eo.prototype.Dz=function(){var a=this;this.m.then(function(b){b.eL(function(b){a.xb(new yh("OFFER",new Ah(b,null,null,a.iaa)))});b.dL(function(b){b=zh(b);"STOP"==b.type&&a.stop();a.xb(b)});b.cL(function(){a.Ab=!0;a.xb(new yh("SESSION_START_SUCCESS"));a.ra.resolve(a)});b.aL(function(){a.xb(new yh("SESSION_END"))});b.bL(function(b){a.Ab||a.ra.reject(b);a.xb(new yh("SESSION_FAILURE"))})})};var fo={channelType:"cloud"};eo.prototype.xb=function(a){this.Nc.sendMessage(a,fo)};var go=function(a){this.v=a;this.$a=new z;this.ss=new Map;this.Do=[];this.pe=this.Xk=this.Pb=this.wf=this.Bk=null;this.bl=this.Eh=this.qg=!1;this.Eo=new z;this.Sl=new z;nf(this)};go.prototype.a=B("mr.CloudProvider");var ho=new Ii("pseudo:cloud","","hangout","Add a hangout","default");d=go.prototype;d.getName=function(){return"cloud"};
d.Ed=function(){var a=this;E(this.a,"Initializing Cloud MRP");var b=Pn.M(),c=b.$T(this);this.Do.push(c);this.Bk=b.gV(this);this.Do.push(this.Bk);this.wf=b.nE();this.Pb=b.mk();this.Xk=b.eW(this);this.pe=b.CX();this.pe.XT().then(function(b){a.qg=b;E(a.a,"Cloud enabled setting: "+a.qg)});this.pe.ZT().then(function(b){a.Eh=b;E(a.a,"Cloud on setting: "+a.Eh)});this.pe.k9(function(b){a.qg=b;E(a.a,"Cloud enabled setting: "+a.qg);a.qg&&a.sG()});this.pe.xW().then(function(b){a.bl=b;E(a.a,"Privacy notified setting: "+
a.bl)})};d.Df=function(){return this.$a.B()};
d.Km=function(a){var b=this;if(!this.Rw(a))return Bk;F(this.a,"GetAvailableSinks for "+a);var c=[];if(this.Eh||this.U$())c=this.sG();this.Sl.clear();this.Eo.B().forEach(function(a){var e=!1;c.forEach(function(b){b.Ya.id==a.Ya.id&&(e=!0,b.Ya.friendlyName=a.Ya.friendlyName)});e||b.Sl.set(a.Ya.id,a)});c=c.concat(this.Sl.B());F(this.a,"Available sinks are..."+JSON.stringify(c));var e=c.map(function(a){return a.Ya});this.Bk&&(e=e.concat(ho));return new Ak(e,-1!=a.indexOf("0F5096E8")?th:null)};
d.sG=function(){var a=[];E(this.a,"Checking cloud discovery services");Pf.M().tr=u();this.Do.forEach(function(b){b=b.zc();a=a.concat(b)});return a};d.jj=function(){};d.mj=function(){};d.ij=function(){};d.lj=function(){};d.W=function(a){return(a=this.Mm(a))?a.Ya:null};
d.Ce=function(a,b,c,e,f,g,k){var n=this;E(this.a,"createRoute called");F(this.a,"urn: "+a+" sinkId:"+b);if(f=this.ss.get(b))return this.v.ot(this,f,a,k,function(b){b.mediaSource=a;b.ie.tabId=k;return G(b)}).then(function(a){n.v.Sg(n,a);return a});f=this.Mm(b);return this.Zp(a,f,b,c,e,g,k)};d.BC=function(a,b,c,e){a instanceof ee?this.oj(b,6,null):(C(this.a,"Error on start session",a),this.oj(b,e,new Zg(wn,"warning","dismiss")));this.Bk&&this.Bk.j5(c)&&this.le([c.Ya]);throw a;};
d.Zp=function(a,b,c,e,f,g,k){var n=this;if(f)return H(Error("not supported"));f=!1;switch(this.kw(b)){case "cloud":Rm(1);break;case "mesi":f=!0,this.bl||(this.bl=!0,this.pe.j9(),g=new Zg(zn,"notification","learn_more"),g.X9(["dismiss"]),g.o8(6320939),this.v.zf().send(g)),Rm(0)}Pf.M().Pi=new Of(b.model,null);var v=Fk(e,this.getName(),c,a,!0,"",null);f&&(v.customControllerPath="cloud_route_details/view.html?routeId="+v.id);this.$a.set(v.id,v);this.ss.set(c,v);this.Eo.set(v.id,b);this.v.dl(this,v);this.v.eh(this.la(),
!0);if(sh(a))return E(this.a,"starting presentation on route: "+v.id),this.saa(v,a).va(function(a){n.BC(a,v,b,7)});E(this.a,"starting mirroring on route: "+v.id);v.ie={tabId:k,sessionId:"",PL:"",QL:b.model};return this.v.Go(this,v).va(function(a){n.BC(a,v,b,5)})};d.Wc=function(a){var b=this.$a.get(a);return b?this.oj(b,0,null):H(new zk(3,"Route in cloud provider not found for routeId "+a))};
d.oj=function(a,b,c){E(this.a,"terminating route: "+a.id);this.$a.remove(a.id);this.ss.delete(a.sinkId);var e=this.Eo.get(a.id);this.Eo.remove(a.id);c&&this.zf().send(c);ih("MediaRouter.Cloud.Session.End",b,Mm);switch(b){case 1:break;default:this.PQ(e)}this.v.Ei(this,a);this.$a.Gb()&&this.v.eh(this.la(),!1);this.v.onPresentationConnectionStateChanged(a.id,"terminated");this.Sl.ab(a.sinkId)&&(b=this.Sl.get(a.sinkId),this.le([b.Ya]),this.Sl.remove(a.sinkId));return G()};
d.ih=function(a,b,c){if(c&&c.channelType){c=c.channelType;var e=(a=this.$a.get(a)||void 0)?this.Mm(a.sinkId):void 0;return this.Xk.d4(c,b,a,e)}return q(b)?(this.jd(b,a),G()):H(Error("Channel type missing"))};d.Af=function(){return hi(!0,!0)};d.Tm=function(a){var b=null;a=this.Mm(a);switch(this.kw(a)){case "cloud":b="webrtc";break;case "mesi":b="hangouts"}E(this.a,"mirror service: "+b);return b};d.km=function(a,b){F(this.a,"Checking canRoute: "+a+" for sinkId: "+b);return this.Rw(a)&&!!this.W(b)};
d.Ej=function(a){return"chrome://media-router/cloudmrp-mirroring"==a};d.ni=function(a,b){return(a=this.$a.get(b))?G(a):H(Error("not supported"))};d.Fh=function(){return H(Error("not supported"))};d.vg=function(){};d.Ux=function(a){E(this.a,a.length+" sinks added");0<a.length&&!this.Eh&&(this.pe.jba(),this.Eh=!0);a=this.Mm(a[0].id);Pf.M().Oi=new Of(a.model,null);this.v.Fc();this.v.onSinkAvailabilityUpdated(this,2);E(this.a,"sinkAvailability changed to AVAILABLE")};
d.le=function(a){E(this.a,a.length+" sinks removed");this.Do.some(function(a){return 0<a.zc().length})||(this.v.onSinkAvailabilityUpdated(this,0),E(this.a,"sinkAvailability changed to UNAVAILABLE"));this.v.Fc()};d.Fc=function(a){E(this.a,a.length+" sinks updated");this.v.Fc()};d.zf=function(){return this.v.zf()};d.jd=function(a,b,c){c?this.v.ke(this,b,a):this.v.Pr(this,b,a)};d.Mm=function(a){var b=this.zU(a);b||(b=this.uX(a));return b};
d.zU=function(a){var b=null;this.Do.some(function(c){b=c.W(a);return!!b});return b};d.uX=function(a){var b=null;(a=this.ss.get(a))&&(b=this.Eo.get(a.id));return b};d.PQ=function(a){switch(this.kw(a)){case "cloud":this.wf.I6(a.deviceId)}};d.kw=function(a){return a.fM("cloud")?"cloud":a.fM("mesi")?"mesi":null};d.U$=function(){var a=Pf.M().tr;return 3E5<=u()-a};
d.Rw=function(a){var b=rh(a);a=sh(a);if(this.Pb.Lk&&!this.Pb.Se&&b)return this.v.onSinkAvailabilityUpdated(this,2),!0;var c=!1;this.qg&&this.Pb.Se&&(c=!0);return chrome.declarativeWebRequest||this.Pb.C_()||!a?c&&(b||a):!1};d.Uf=function(a,b){if(!this.Rw(a))return null;(a=this.Bk.XO(b))&&this.Ux([a]);return a};d.la=function(){return"CloudProvider"};d.getData=function(){return[void 0,{cloudEnabled:this.qg,cloudOn:this.Eh,notifiedHangoutsPrivacy:this.bl}]};
d.eb=function(){var a=lf(this);a&&(a.cloudEnabled&&(this.qg=a.cloudEnabled),a.cloudOn&&(this.Eh=a.cloudOn),a.notifiedHangoutsPrivacy&&(this.bl=a.notifiedHangoutsPrivacy))};d.saa=function(a,b){return(new eo(a,b)).start().then(function(){return a})};var io=function(a){this.Un=a;this.a=B("mr.ExternalMessageHandler")},jo=["idmofbkcelhplfjnmmdolenpigiiiecc","ggedfkijiiammpnbdadhllnehapomdge","njjegkblellcjnakomndbaloifhcoccg"],ko=0;io.prototype.Fy=function(){chrome.runtime.onMessageExternal.addListener(this.Pk.bind(this))};
io.prototype.Pk=function(a,b,c){if(!b.id||-1==jo.indexOf(b.id))return!1;E(this.a,"Received a message from "+b.id+" type: "+a.type);var e=chrome.runtime.id;if("start"==a.type)a=a.message,a=this.Un.Uf("pseudo:cloud","urn:x-org.chromium.media:source:desktop",new Zm(a.meetingName,a.domain)),b="PresentationId"+b.id+ko++,this.Un.Ce("urn:x-org.chromium.media:source:desktop",a,b).then(function(a){c(new kg(e,"route",a.id))}).catch(function(a){c(new kg(e,"error",a))});else if("stop"==a.type)this.Un.Wc(a.message.routeId).then(function(){c(new kg(e,
"stopped"))});else return!1;return!0};var lo=function(){this.YI=t(this.WO,this);this.Zd=new ti;this.Zd.Kz=!1;this.Zd.Ts=!1;this.yG=this.Zd.nB=!1;this.kH="";this.SS={}};lo.prototype.o7=function(a){if(a!=this.yG){var b=Md();a?b.XA(this.YI):b.i5(this.YI);this.yG=a}};lo.prototype.WO=function(a){if(!this.SS[a.nH]){var b=this.Zd.vD(a),c=mo;if(c)switch(a.ri){case Bd:no(c,"info",b);break;case Cd:no(c,"error",b);break;case Dd:no(c,"warn",b);break;default:no(c,"debug",b)}else this.kH+=b}};var mo=h.console,no=function(a,b,c){if(a[b])a[b](c);else a.log(c)};var oo=function(){this.df=new mi(1E3);this.Zd=new ti};ra(oo);d=oo.prototype;d.init=function(){var a=this.jU();Nd("mr").Bl(a);Nd("goog").Bl(Ed);rd(Od(Nd("browser")));Md().XA(t(this.Q1,this));this.Zd.Lz=!0;this.Zd.Ts=!0;if(a=window.localStorage["debug.logs"]){var b={all:Id,fine:Gd,info:Ed,warning:Dd,severe:Cd,off:Ad};Nd("mr").Bl(b[a.toLowerCase()]||Gd)}window.localStorage["debug.console"]&&(a=new lo,a.Zd.Lz=!0,a.Zd.Ts=!0,a.Zd.Kz=!0,a.o7(!0))};
d.Q1=function(a){this.df.add(this.Zd.vD(a));(a=a.gq)&&a.stack&&this.df.add(a.stack)};d.getLogs=function(){return 0==this.df.P()?"NA":this.df.B().join("")};d.jU=function(){return Ed};d.T4=function(){nf(this)};d.la=function(){return"LogManager"};d.getData=function(){return[this.df.B()]};d.eb=function(){var a=this.df.B();this.df.clear();for(var b=ha(kf(this)||[]),c=b.next();!c.done;c=b.next())this.df.add(c.value);a=ha(a);for(c=a.next();!c.done;c=a.next())this.df.add(c.value)};var po=function(a){this.Un=a};po.prototype.Fy=function(){chrome.runtime.onMessage.addListener(this.P1.bind(this))};
po.prototype.P1=function(a,b,c){if(b.id!=chrome.runtime.id||b.url!="chrome-extension://"+b.id+"/feedback.html")return!1;if("retrieve_log_data"==a.type){var e={logs:oo.M().getLogs(),device:Pf.M().VW()};b=jg(e.device.ip).then(function(a){a&&(e.device.version=a)});var f=this.Un.iW("cast_streaming").then(function(b){return b.jW(a.source)}).then(function(a){e.castStreamingLogs=a});me([b,f]).then(function(){c(e)});return!0}return!1};var qo,ro=B("mr.Init"),so=function(a){var b=new Qk(a),c=new Ml(a,b),b=[b,c];b.push(new go(a));return b};oo.M().init();qo=new ch("MediaRouter.Provider.WakeDuration");
var to=new ao,uo=(new Promise(function(a,b){switch(window.location.host){case "enhhojjnijigcajfphajepfemndkmdlo":a();break;case "pkedcjkdefgpdelpbcmbmeomcjbeemfm":chrome.management.get("enhhojjnijigcajfphajepfemndkmdlo",function(c){chrome.runtime.lastError||!c.enabled?a():b(Error("Dev extension is enabled"))});break;default:b(Error("Unknown extension id"))}})).then(function(){if(!chrome.mojoPrivate||!chrome.mojoPrivate.requireAsync)return H(Error("No mojo service loaded"));var a=I();chrome.mojoPrivate.requireAsync("media_router_bindings").then(function(b){b.start().then(function(c){a.resolve({mrService:b,
mrInstanceId:c})})});return a.promise}).then(function(a){if(!a.mrService)throw Error("Failed to get MR service");var b=a.mrInstanceId;if(!b)throw Error("Failed to get MR instance ID.");E(ro,"MR instance ID: "+b);a=a.mrService;if(!to)throw Error("providerManager not initialized.");a.setHandlers(to);pf(b)&&qo.Cl("MediaRouter.Provider.FirstWakeDuration");chrome.runtime.onSuspend.addListener(qo.end.bind(qo));tf(b);oo.M().T4();b=so(to);re=function(a){var b=a;b.stack||(b=Error(a));C(ro,"Unhandled promise rejection.",
b)};to.Ed(a,b)}).then(void 0,function(a){D(ro,a.message);throw a;});(function(a){[].concat([new po(a),new io(a)],ia([].concat(ia(Gl()),ia([dj(),fj()])))).forEach(function(a){return a.Fy()});a=Pn.M().UD();chrome.gcm.onMessage.addListener(a.onMessage.bind(a))})(to);uo.then(void 0,function(){return window.close()});
